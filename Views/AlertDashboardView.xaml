<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             AutomationProperties.Name="Alert Dashboard">

  <Grid Background="{DynamicResource Theme.Surface.Primary}">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Header -->
    <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10" Margin="5">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Orientation="Horizontal">
          <TextBlock Text="&#xE7BA;" FontFamily="Segoe MDL2 Assets" FontSize="24" 
                     Foreground="{DynamicResource Theme.Text.Primary}" VerticalAlignment="Center" Margin="0,0,10,0"/>
          <TextBlock Text="Alert Dashboard" FontSize="18" FontWeight="Bold" 
                     Foreground="{DynamicResource Theme.Text.Primary}" VerticalAlignment="Center"/>
        </StackPanel>

        <StackPanel Grid.Column="1" Orientation="Horizontal">
          <Button Name="RefreshButton" Content="&#xE72C; Refresh" FontFamily="Segoe MDL2 Assets" 
                  Style="{DynamicResource PrimaryButtonStyle}" Margin="0,0,5,0" 
                  ToolTip="Refresh alerts (F5)" AutomationProperties.Name="Refresh alerts"/>
          <Button Name="ClearAllButton" Content="Clear All" 
                  Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,5,0"
                  ToolTip="Clear all resolved alerts" AutomationProperties.Name="Clear all resolved"/>
          <Button Name="ConfigureButton" Content="&#xE713; Settings" FontFamily="Segoe MDL2 Assets"
                  Style="{DynamicResource SecondaryButtonStyle}"
                  ToolTip="Configure alert settings" AutomationProperties.Name="Alert settings"/>
        </StackPanel>
      </Grid>
    </Border>

    <!-- Summary Cards -->
    <Border Grid.Row="1" Margin="5">
      <UniformGrid Rows="1" Columns="5">
        <!-- Critical -->
        <Border Name="CriticalCard" Background="#FF1744" CornerRadius="5" Margin="2" Padding="10" Cursor="Hand">
          <StackPanel>
            <TextBlock Text="CRITICAL" FontSize="10" FontWeight="Bold" Foreground="White" Opacity="0.8"/>
            <TextBlock Name="CriticalCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="White"/>
          </StackPanel>
        </Border>
        <!-- High -->
        <Border Name="HighCard" Background="#FF6D00" CornerRadius="5" Margin="2" Padding="10" Cursor="Hand">
          <StackPanel>
            <TextBlock Text="HIGH" FontSize="10" FontWeight="Bold" Foreground="White" Opacity="0.8"/>
            <TextBlock Name="HighCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="White"/>
          </StackPanel>
        </Border>
        <!-- Medium -->
        <Border Name="MediumCard" Background="#FFC400" CornerRadius="5" Margin="2" Padding="10" Cursor="Hand">
          <StackPanel>
            <TextBlock Text="MEDIUM" FontSize="10" FontWeight="Bold" Foreground="#333" Opacity="0.8"/>
            <TextBlock Name="MediumCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="#333"/>
          </StackPanel>
        </Border>
        <!-- Low -->
        <Border Name="LowCard" Background="#00C853" CornerRadius="5" Margin="2" Padding="10" Cursor="Hand">
          <StackPanel>
            <TextBlock Text="LOW" FontSize="10" FontWeight="Bold" Foreground="White" Opacity="0.8"/>
            <TextBlock Name="LowCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="White"/>
          </StackPanel>
        </Border>
        <!-- Total -->
        <Border Name="TotalCard" Background="{DynamicResource Theme.Accent.Primary}" CornerRadius="5" Margin="2" Padding="10" Cursor="Hand">
          <StackPanel>
            <TextBlock Text="TOTAL ACTIVE" FontSize="10" FontWeight="Bold" Foreground="White" Opacity="0.8"/>
            <TextBlock Name="TotalCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="White"/>
          </StackPanel>
        </Border>
      </UniformGrid>
    </Border>

    <!-- Main Content -->
    <TabControl Grid.Row="2" Margin="5" Style="{DynamicResource PrimaryTabControlStyle}">
      <!-- Active Alerts Tab -->
      <TabItem Header="Active Alerts" AutomationProperties.Name="Active alerts tab">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <!-- Filter Bar -->
          <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="5" Margin="0,0,0,5">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="Filter:" VerticalAlignment="Center" Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,5,0"/>
              <ComboBox Name="SeverityFilter" Width="100" Margin="0,0,10,0" SelectedIndex="0"
                        AutomationProperties.Name="Filter by severity">
                <ComboBoxItem Content="All Severities"/>
                <ComboBoxItem Content="Critical"/>
                <ComboBoxItem Content="High"/>
                <ComboBoxItem Content="Medium"/>
                <ComboBoxItem Content="Low"/>
              </ComboBox>
              <ComboBox Name="CategoryFilter" Width="120" Margin="0,0,10,0" SelectedIndex="0"
                        AutomationProperties.Name="Filter by category">
                <ComboBoxItem Content="All Categories"/>
                <ComboBoxItem Content="Connectivity"/>
                <ComboBoxItem Content="Performance"/>
                <ComboBoxItem Content="Security"/>
                <ComboBoxItem Content="Capacity"/>
              </ComboBox>
              <TextBox Name="SourceFilter" Width="150" Margin="0,0,10,0" 
                       Text="" ToolTip="Filter by source (hostname/IP)"
                       AutomationProperties.Name="Filter by source"/>
            </StackPanel>
          </Border>

          <!-- Active Alerts Grid -->
          <DataGrid Name="ActiveAlertsGrid" Grid.Row="1" AutoGenerateColumns="False" 
                    CanUserAddRows="False" IsReadOnly="True" SelectionMode="Extended"
                    Style="{DynamicResource PrimaryDataGridStyle}"
                    VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling">
            <DataGrid.ContextMenu>
              <ContextMenu>
                <MenuItem Name="AcknowledgeMenuItem" Header="Acknowledge" InputGestureText="Ctrl+A"/>
                <MenuItem Name="ResolveMenuItem" Header="Resolve/Clear" InputGestureText="Del"/>
                <Separator/>
                <MenuItem Name="CopyAlertMenuItem" Header="Copy Details"/>
                <MenuItem Name="ViewSourceMenuItem" Header="View Source"/>
              </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.Columns>
              <DataGridTemplateColumn Header="Severity" Width="80" SortMemberPath="SeverityLevel">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <Border CornerRadius="3" Padding="5,2" HorizontalAlignment="Center">
                      <Border.Style>
                        <Style TargetType="Border">
                          <Style.Triggers>
                            <DataTrigger Binding="{Binding Severity}" Value="Critical">
                              <Setter Property="Background" Value="#FF1744"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Severity}" Value="High">
                              <Setter Property="Background" Value="#FF6D00"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Severity}" Value="Medium">
                              <Setter Property="Background" Value="#FFC400"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Severity}" Value="Low">
                              <Setter Property="Background" Value="#00C853"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Severity}" Value="Info">
                              <Setter Property="Background" Value="#2196F3"/>
                            </DataTrigger>
                          </Style.Triggers>
                        </Style>
                      </Border.Style>
                      <TextBlock Text="{Binding Severity}" Foreground="White" FontWeight="Bold" FontSize="10"/>
                    </Border>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
              <DataGridTextColumn Header="Rule" Binding="{Binding RuleName}" Width="150"/>
              <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="120"/>
              <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="100"/>
              <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*"/>
              <DataGridTextColumn Header="Fired At" Binding="{Binding FiredAt, StringFormat='{}{0:HH:mm:ss}'}" Width="80"/>
              <DataGridTextColumn Header="State" Binding="{Binding State}" Width="80"/>
              <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="80"/>
            </DataGrid.Columns>
          </DataGrid>
        </Grid>
      </TabItem>

      <!-- Alert History Tab -->
      <TabItem Header="History" AutomationProperties.Name="Alert history tab">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="5" Margin="0,0,0,5">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="Show last:" VerticalAlignment="Center" Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,5,0"/>
              <ComboBox Name="HistoryLimit" Width="80" SelectedIndex="1">
                <ComboBoxItem Content="50"/>
                <ComboBoxItem Content="100"/>
                <ComboBoxItem Content="250"/>
                <ComboBoxItem Content="500"/>
              </ComboBox>
              <Button Name="ExportHistoryButton" Content="Export" Style="{DynamicResource SecondaryButtonStyle}" Margin="10,0,0,0"/>
            </StackPanel>
          </Border>

          <DataGrid Name="HistoryGrid" Grid.Row="1" AutoGenerateColumns="False" 
                    CanUserAddRows="False" IsReadOnly="True"
                    Style="{DynamicResource PrimaryDataGridStyle}"
                    VirtualizingPanel.IsVirtualizing="True">
            <DataGrid.Columns>
              <DataGridTextColumn Header="Time" Binding="{Binding FiredAt, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss}'}" Width="140"/>
              <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="80"/>
              <DataGridTextColumn Header="Rule" Binding="{Binding RuleName}" Width="150"/>
              <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="120"/>
              <DataGridTextColumn Header="State" Binding="{Binding State}" Width="80"/>
              <DataGridTextColumn Header="Resolved" Binding="{Binding ResolvedAt, StringFormat='{}{0:HH:mm:ss}'}" Width="80"/>
            </DataGrid.Columns>
          </DataGrid>
        </Grid>
      </TabItem>

      <!-- Rules Tab -->
      <TabItem Header="Rules" AutomationProperties.Name="Alert rules tab">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="5" Margin="0,0,0,5">
            <StackPanel Orientation="Horizontal">
              <Button Name="AddRuleButton" Content="+ Add Rule" Style="{DynamicResource PrimaryButtonStyle}" Margin="0,0,5,0"/>
              <Button Name="ImportRulesButton" Content="Import" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,5,0"/>
              <Button Name="ExportRulesButton" Content="Export" Style="{DynamicResource SecondaryButtonStyle}"/>
            </StackPanel>
          </Border>

          <DataGrid Name="RulesGrid" Grid.Row="1" AutoGenerateColumns="False" 
                    CanUserAddRows="False" IsReadOnly="True"
                    Style="{DynamicResource PrimaryDataGridStyle}">
            <DataGrid.Columns>
              <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="60"/>
              <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
              <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="80"/>
              <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="100"/>
              <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
              <DataGridTextColumn Header="Cooldown" Binding="{Binding Cooldown}" Width="80"/>
              <DataGridTextColumn Header="Fire Count" Binding="{Binding FireCount}" Width="80"/>
            </DataGrid.Columns>
          </DataGrid>
        </Grid>
      </TabItem>
    </TabControl>

    <!-- Status Bar -->
    <Border Grid.Row="3" Background="{DynamicResource Theme.Surface.Secondary}" Padding="5">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Orientation="Horizontal">
          <TextBlock Name="StatusText" Text="Ready" Foreground="{DynamicResource Theme.Text.Secondary}"/>
        </StackPanel>

        <StackPanel Grid.Column="1" Orientation="Horizontal">
          <TextBlock Text="Last Updated: " Foreground="{DynamicResource Theme.Text.Secondary}"/>
          <TextBlock Name="LastUpdatedText" Text="--:--:--" Foreground="{DynamicResource Theme.Text.Primary}"/>
        </StackPanel>
      </Grid>
    </Border>

  </Grid>
</UserControl>
