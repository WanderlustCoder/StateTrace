<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

  <Grid Background="{DynamicResource Theme.Surface.Primary}">
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <Grid Grid.Row="0" Grid.Column="0" Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,5">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <Grid Grid.Column="0" Margin="0,0,15,0">
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Button Name="CompareButton"
                    Content="Compare Configs"
                    Width="120"
                    Margin="0,0,10,5"
                    Style="{DynamicResource PrimaryButtonStyle}"
                    ToolTip="Open side-by-side configuration comparison"
                    Grid.Row="0" Grid.Column="0"/>
            <Button Name="CopyDetailsButton"
                    Content="Copy Details"
                    Width="120"
                    Margin="0,0,10,0"
                    Style="{DynamicResource PrimaryButtonStyle}"
                    ToolTip="Copy selected interfaces with all details"
                    Grid.Row="1" Grid.Column="0"/>
            <Button Name="ConfigureButton"
                    Content="Configure"
                    Width="120"
                    Margin="0,0,0,5"
                    Style="{DynamicResource PrimaryButtonStyle}"
                    ToolTip="Generate configuration commands for selected interfaces"
                    Grid.Row="0" Grid.Column="1"/>
            <ComboBox Name="ConfigOptionsDropdown"
                      Width="120"
                      Margin="0"
                      Grid.Row="1" Grid.Column="1" Style="{DynamicResource ToolbarComboBoxStyle}"/>
          </Grid>

          <Grid Grid.Column="1">
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal" Margin="{DynamicResource ControlSpacingRight}">
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Hostname:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="HostnameBox" IsReadOnly="True" MinWidth="130" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Make:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="MakeBox" IsReadOnly="True" MinWidth="90" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Model:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="ModelBox" IsReadOnly="True" MinWidth="100" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
            </StackPanel>
            <StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal">
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Uptime:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="UptimeBox" IsReadOnly="True" MinWidth="140" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Ports:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="PortCountBox" IsReadOnly="True" MinWidth="50" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="AuthDefaultVLAN:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="AuthDefaultVLANBox" IsReadOnly="True" MinWidth="130" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Building:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="BuildingBox" IsReadOnly="True" MinWidth="60" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="{DynamicResource StackItemMargin}">
                <TextBlock Text="Room:" FontSize="12" Foreground="{DynamicResource Theme.Text.Inverse}"/>
                <TextBox Name="RoomBox" IsReadOnly="True" MinWidth="40" Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}" BorderBrush="{DynamicResource Theme.Input.Border}" BorderThickness="1"/>
              </StackPanel>
            </StackPanel>

            <Button Name="ReorgButton"
                    Grid.Row="0" Grid.RowSpan="2" Grid.Column="1"
                    Content="Port Reorg"
                    Width="120"
                    Margin="10,0,0,0"
                    VerticalAlignment="Top"
                    Style="{DynamicResource PrimaryButtonStyle}"
                    ToolTip="Open port reorganization tool for label management"/>
          </Grid>
        </Grid>

        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,5">
            <TextBox Name="FilterBox"
                   Width="160"
                   Background="{DynamicResource Theme.Input.Background}" Foreground="{DynamicResource Theme.Input.Text}"
                   BorderBrush="{DynamicResource Theme.Input.Border}"
                   BorderThickness="1"
                   ToolTip="Type to filter interfaces..."
                   Margin="0,0,5,0"/>
            <Button Name="ClearFilterButton"
                  Content="X"
                  Width="30"
                  Height="23"
                  VerticalAlignment="Center"
                  ToolTip="Clear filter"/>
        </StackPanel>

        <Grid Grid.Row="2">
          <DataGrid Name="InterfacesGrid"
                    AutoGenerateColumns="False"
                    SelectionMode="Extended"
                    SelectionUnit="CellOrRowHeader"
                    Margin="5,0,5,5"
                    CanUserAddRows="False"
                    IsReadOnly="False"
                    Style="{DynamicResource PrimaryDataGridStyle}"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                    ScrollViewer.IsDeferredScrollingEnabled="True"
                    VirtualizingPanel.IsVirtualizing="True"
                    VirtualizingPanel.VirtualizationMode="Recycling"
                    EnableRowVirtualization="True"
                    EnableColumnVirtualization="True"
                    ScrollViewer.CanContentScroll="True"
                    VirtualizingPanel.ScrollUnit="Pixel">
            <DataGrid.RowStyle>
              <DynamicResource ResourceKey="PrimaryDataGridRowStyle"/>
            </DataGrid.RowStyle>
            <DataGrid.Columns>

              <DataGridCheckBoxColumn Width="30"
                                      Header=""
                                      IsThreeState="False">
                <DataGridCheckBoxColumn.Binding>
                  <Binding Path="IsSelected" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"/>
                </DataGridCheckBoxColumn.Binding>
                <DataGridCheckBoxColumn.ElementStyle>
                  <Style TargetType="CheckBox">
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="VerticalAlignment"   Value="Center"/>
                    <Setter Property="Focusable"           Value="False"/>
                  </Style>
                </DataGridCheckBoxColumn.ElementStyle>
                <DataGridCheckBoxColumn.EditingElementStyle>
                  <Style TargetType="CheckBox">
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="VerticalAlignment"   Value="Center"/>
                    <Setter Property="Focusable"           Value="False"/>
                  </Style>
                </DataGridCheckBoxColumn.EditingElementStyle>
              </DataGridCheckBoxColumn>

              <DataGridTemplateColumn Header="Port">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding Port}"
                               Style="{DynamicResource PortColorTextStyle}">
                      <TextBlock.ToolTip>
                        <ToolTip Content="{Binding ToolTip}"/>
                      </TextBlock.ToolTip>
                    </TextBlock>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>

              <DataGridTextColumn Header="Name"
                                   Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"/>

              <DataGridTemplateColumn Header="Status">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding Status}"
                               Style="{DynamicResource InterfaceStatusTextStyle}"/>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>

              <DataGridTextColumn Header="VLAN"
                                   Binding="{Binding VLAN, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"/>

              <DataGridTextColumn Header="Duplex" Binding="{Binding Duplex}">
                <DataGridTextColumn.ElementStyle>
                  <DynamicResource ResourceKey="DuplexTextStyle"/>
                </DataGridTextColumn.ElementStyle>
              </DataGridTextColumn>

              <DataGridTextColumn Header="Speed" Binding="{Binding Speed}"/>

              <DataGridTextColumn Header="Type" Binding="{Binding Type}"/>

              <DataGridTextColumn Header="LearnedMACs" Binding="{Binding LearnedMACs}" Width="160">
                <DataGridTextColumn.ElementStyle>
                  <Style TargetType="TextBlock">
                    <Setter Property="TextWrapping" Value="NoWrap"/>
                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                  </Style>
                </DataGridTextColumn.ElementStyle>
              </DataGridTextColumn>

              <DataGridTextColumn Header="AuthState" Binding="{Binding AuthState}">
                <DataGridTextColumn.ElementStyle>
                  <DynamicResource ResourceKey="AuthStateTextStyle"/>
                </DataGridTextColumn.ElementStyle>
              </DataGridTextColumn>

              <DataGridTextColumn Header="AuthMode" Binding="{Binding AuthMode}"/>

              <DataGridTextColumn Header="AuthClientMAC" Binding="{Binding AuthClientMAC}"/>
            </DataGrid.Columns>
          </DataGrid>

          <Border Name="InterfacesEmptyStatePanel" HorizontalAlignment="Center" VerticalAlignment="Center"
                  Background="{DynamicResource Theme.Surface.Secondary}" Padding="30,20" CornerRadius="8"
                  Visibility="Collapsed">
            <StackPanel>
              <TextBlock Text="No Interfaces" FontSize="18" FontWeight="Bold"
                         Foreground="{DynamicResource Theme.Text.Primary}" HorizontalAlignment="Center"/>
              <TextBlock Text="Select a device from the sidebar to view interfaces"
                         Foreground="{DynamicResource Theme.Text.Muted}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
            </StackPanel>
          </Border>

          <Border Name="InterfacesLoadingIndicator" Style="{DynamicResource LoadingIndicatorStyle}">
            <StackPanel>
              <TextBlock Text="Loading interfaces..." Style="{DynamicResource LoadingTextStyle}"/>
              <ProgressBar Style="{DynamicResource LoadingProgressStyle}"/>
            </StackPanel>
          </Border>
        </Grid>

        <Grid Grid.Row="3" Margin="5,4,5,0">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>
          <TextBlock Name="HostLoadingIndicator"
                     Text="Loading host..."
                     Foreground="{DynamicResource Theme.Text.Inverse}"
                     FontSize="12"
                     Visibility="Collapsed"
                     VerticalAlignment="Center"/>
          <TextBlock Name="PortLoadingIndicator"
                     Grid.Row="1"
                     Text="Loading ports..."
                     Foreground="{DynamicResource Theme.Text.Inverse}"
                     FontSize="12"
                     Visibility="Collapsed"
                     VerticalAlignment="Center"/>
          <ProgressBar Name="PortLoadingProgress"
                       Grid.RowSpan="2"
                       Grid.Column="1"
                       Width="140"
                       Height="8"
                       Margin="12,0,0,0"
                       Minimum="0"
                       Maximum="1"
                       Visibility="Collapsed"/>
        </Grid>
    </Grid>
  </Grid>
</UserControl>
