<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <UserControl.Resources>
    <!-- Status Style for interface status -->
    <Style x:Key="StatusTextStyle" TargetType="TextBlock">
      <Setter Property="Foreground" Value="Black"/>
      <Style.Triggers>
        <DataTrigger Binding="{Binding Status}" Value="connected">
          <Setter Property="Foreground" Value="Green"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding Status}" Value="notconnect">
          <Setter Property="Foreground" Value="Red"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding Status}" Value="Up">
          <Setter Property="Foreground" Value="Green"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding Status}" Value="Down">
          <Setter Property="Foreground" Value="Red"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>

    <!-- Auth State Style -->
    <Style x:Key="AuthStateTextStyle" TargetType="TextBlock">
      <Style.Triggers>
        <DataTrigger Binding="{Binding AuthState}" Value="Authorized">
          <Setter Property="Foreground" Value="Green"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding AuthState}" Value="Unauthorized">
          <Setter Property="Foreground" Value="Red"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>

    <!-- Duplex Style -->
    <Style x:Key="DuplexTextStyle" TargetType="TextBlock">
      <Style.Triggers>
        <DataTrigger Binding="{Binding Duplex}" Value="full">
          <Setter Property="Foreground" Value="Green"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding Duplex}" Value="half">
          <Setter Property="Foreground" Value="Goldenrod"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding Duplex}" Value="a-full">
          <Setter Property="Foreground" Value="Blue"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>

    <!-- Port Color Style -->
    <Style x:Key="PortTextStyle" TargetType="TextBlock">
      <Setter Property="Foreground" Value="Gray"/>
      <Style.Triggers>
        <DataTrigger Binding="{Binding PortColor}" Value="Green">
          <Setter Property="Foreground" Value="Green"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding PortColor}" Value="Blue">
          <Setter Property="Foreground" Value="Blue"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding PortColor}" Value="Purple">
          <Setter Property="Foreground" Value="Purple"/>
        </DataTrigger>
        <DataTrigger Binding="{Binding PortColor}" Value="Red">
          <Setter Property="Foreground" Value="Red"/>
        </DataTrigger>
      </Style.Triggers>
    </Style>
  </UserControl.Resources>

  <!-- Apply a navy blue background to the outer grid. -->
  <Grid Background="#001F3F">
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
	
    <Grid Grid.Row="0" Grid.Column="0" Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Device details and actions -->
        <Grid Grid.Row="0" Margin="0,0,0,5">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <Grid Grid.Column="0" Margin="0,0,15,0">
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Button Name="CompareButton"
                    Content="Compare Configs"
                    Width="120"
                    Margin="0,0,10,5"
                    Background="#FFD700" Foreground="Black"
                    Grid.Row="0" Grid.Column="0"/>
            <Button Name="CopyDetailsButton"
                    Content="Copy Details"
                    Width="120"
                    Margin="0,0,10,0"
                    Background="#FFD700" Foreground="Black"
                    ToolTip="Copy selected interfaces with all details"
                    Grid.Row="1" Grid.Column="0"/>
            <Button Name="ConfigureButton"
                    Content="Configure"
                    Width="120"
                    Margin="0,0,0,5"
                    Background="#FFD700" Foreground="Black"
                    Grid.Row="0" Grid.Column="1"/>
            <ComboBox Name="ConfigOptionsDropdown"
                      Width="120"
                      Margin="0"
                      Grid.Row="1" Grid.Column="1"/>
          </Grid>

          <StackPanel Grid.Column="1" Orientation="Vertical">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Hostname:" FontSize="12" Foreground="White"/>
                <TextBox Name="HostnameBox" IsReadOnly="True" Width="130" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Make:" FontSize="12" Foreground="White"/>
                <TextBox Name="MakeBox" IsReadOnly="True" Width="90" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Model:" FontSize="12" Foreground="White"/>
                <TextBox Name="ModelBox" IsReadOnly="True" Width="100" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
            </StackPanel>
            <StackPanel Orientation="Horizontal">
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Uptime:" FontSize="12" Foreground="White"/>
                <TextBox Name="UptimeBox" IsReadOnly="True" Width="140" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Ports:" FontSize="12" Foreground="White"/>
                <TextBox Name="PortCountBox" IsReadOnly="True" Width="50" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="AuthDefaultVLAN:" FontSize="12" Foreground="White"/>
                <TextBox Name="AuthDefaultVLANBox" IsReadOnly="True" Width="130" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Building:" FontSize="12" Foreground="White"/>
                <TextBox Name="BuildingBox" IsReadOnly="True" Width="60" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
              <StackPanel Margin="0,0,15,0">
                <TextBlock Text="Room:" FontSize="12" Foreground="White"/>
                <TextBox Name="RoomBox" IsReadOnly="True" Width="40" Background="#F7F9FC" BorderBrush="#C0C0C0" BorderThickness="1"/>
              </StackPanel>
            </StackPanel>
          </StackPanel>
        </Grid>

        <!-- Search Bar + Clear Button -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,5">
            <TextBox Name="FilterBox"
                   Width="160"
                   Background="#F7F9FC"
                   BorderBrush="#C0C0C0"
                   BorderThickness="1"
                   ToolTip="Type to filter interfaces..."
                   Margin="0,0,5,0"/>
            <Button Name="ClearFilterButton"
                  Content="X"
                  Width="30"
                  Height="23"
                  VerticalAlignment="Center"
                  ToolTip="Clear filter"/>
        </StackPanel>

        <!-- Interfaces DataGrid -->
        <DataGrid Name="InterfacesGrid"
                  Grid.Row="2"
                  AutoGenerateColumns="False"
                  SelectionMode="Extended"
                  SelectionUnit="CellOrRowHeader"
                  Margin="5,0,5,5"
                  CanUserAddRows="False"
                  IsReadOnly="False"
                  Background="#F7F9FC"
                  RowBackground="#E7ECF5"
                  AlternatingRowBackground="#F1F5FA"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  ScrollViewer.HorizontalScrollBarVisibility="Auto"
                  BorderBrush="#C0C0C0"
                  BorderThickness="1"
																		VirtualizingPanel.IsVirtualizing="True"
																		VirtualizingPanel.VirtualizationMode="Recycling"
																		EnableRowVirtualization="True"
																		EnableColumnVirtualization="True"
																		ScrollViewer.CanContentScroll="True"
																		VirtualizingPanel.ScrollUnit="Pixel">
          <!-- Override the default selection colour so coloured text remains readable -->
          <DataGrid.RowStyle>
            <Style TargetType="DataGridRow">
              <Setter Property="Foreground" Value="Black"/>
              <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                  <Setter Property="Background" Value="#FFF4BA"/>
                  <Setter Property="Foreground" Value="Black"/>
                </Trigger>
              </Style.Triggers>
            </Style>
          </DataGrid.RowStyle>
          <DataGrid.Columns>
            <!-- Selection checkbox -->
            <DataGridCheckBoxColumn Width="30"
                                    Header=""
                                    IsThreeState="False">
              <DataGridCheckBoxColumn.Binding>
                <Binding Path="IsSelected" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"/>
              </DataGridCheckBoxColumn.Binding>
              <DataGridCheckBoxColumn.ElementStyle>
                <Style TargetType="CheckBox">
                  <Setter Property="HorizontalAlignment" Value="Center"/>
                  <Setter Property="VerticalAlignment"   Value="Center"/>
                  <Setter Property="Focusable"           Value="False"/>
                </Style>
              </DataGridCheckBoxColumn.ElementStyle>
              <DataGridCheckBoxColumn.EditingElementStyle>
                <Style TargetType="CheckBox">
                  <Setter Property="HorizontalAlignment" Value="Center"/>
                  <Setter Property="VerticalAlignment"   Value="Center"/>
                  <Setter Property="Focusable"           Value="False"/>
                </Style>
              </DataGridCheckBoxColumn.EditingElementStyle>
            </DataGridCheckBoxColumn>

            <!-- Port Column -->
            <DataGridTemplateColumn Header="Port">
              <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding Port}"
                             Style="{StaticResource PortTextStyle}">
                    <TextBlock.ToolTip>
                      <ToolTip Content="{Binding ToolTip}"/>
                    </TextBlock.ToolTip>
                  </TextBlock>
                </DataTemplate>
              </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>

            <!-- Name (editable) -->
            <DataGridTextColumn Header="Name"
                                 Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- Status -->
            <DataGridTemplateColumn Header="Status">
              <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding Status}"
                             Style="{StaticResource StatusTextStyle}"/>
                </DataTemplate>
              </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>

            <!-- VLAN (editable) -->
            <DataGridTextColumn Header="VLAN"
                                 Binding="{Binding VLAN, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- Duplex -->
            <DataGridTextColumn Header="Duplex" Binding="{Binding Duplex}">
              <DataGridTextColumn.ElementStyle>
                <StaticResource ResourceKey="DuplexTextStyle"/>
              </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>

            <!-- Speed -->
            <DataGridTextColumn Header="Speed" Binding="{Binding Speed}"/>

            <!-- Type -->
            <DataGridTextColumn Header="Type" Binding="{Binding Type}"/>

            <!-- Learned MACs -->
            <!-- Fix column width and prevent long lists from stretching the grid.  Use a fixed
                 width and ellipsis trimming so that a long string of MAC addresses does not
                 expand the DataGrid column.  The full list of MACs remains available in
                 the LearnedMACsFull property, and the LearnedMACCount can be bound to
                 another column if needed. -->
            <DataGridTextColumn Header="LearnedMACs" Binding="{Binding LearnedMACs}" Width="160">
              <DataGridTextColumn.ElementStyle>
                <Style TargetType="TextBlock">
                  <Setter Property="TextWrapping" Value="NoWrap"/>
                  <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                </Style>
              </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>

            <!-- Auth State -->
            <DataGridTextColumn Header="AuthState" Binding="{Binding AuthState}">
              <DataGridTextColumn.ElementStyle>
                <StaticResource ResourceKey="AuthStateTextStyle"/>
              </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>

            <!-- Auth Mode -->
            <DataGridTextColumn Header="AuthMode" Binding="{Binding AuthMode}"/>

            <!-- Auth Client MAC -->
            <DataGridTextColumn Header="AuthClientMAC" Binding="{Binding AuthClientMAC}"/>
          </DataGrid.Columns>
        </DataGrid>
    </Grid>
  </Grid>
</UserControl>
