<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Toolbar -->
    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5" Background="{DynamicResource Theme.Toolbar.Background}">
      <Button Name="AddVlanButton" Content="Add VLAN" Margin="5,2" Style="{DynamicResource PrimaryButtonStyle}"/>
      <Button Name="AddSubnetButton" Content="Add Subnet" Margin="5,2" Style="{DynamicResource PrimaryButtonStyle}"/>
      <Button Name="AddIPButton" Content="Add IP" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Separator Margin="5,2"/>
      <Button Name="ImportButton" Content="Import" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Button Name="ExportButton" Content="Export" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Separator Margin="5,2"/>
      <Button Name="CheckConflictsButton" Content="Check Conflicts" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Button Name="PlanSiteButton" Content="Plan Site" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Separator Margin="5,2"/>
      <Label Content="Site:" VerticalAlignment="Center" Style="{DynamicResource ToolbarLabelStyle}"/>
      <ComboBox Name="SiteFilterCombo" Width="120" Margin="5,2" Style="{DynamicResource ToolbarComboBoxStyle}"/>
    </StackPanel>

    <!-- Main Content - Tab Control -->
    <TabControl Grid.Row="1" Margin="5" Name="MainTabControl">

      <!-- VLANs Tab -->
      <TabItem Header="VLANs">
        <Grid Background="{DynamicResource Theme.Surface.Secondary}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
          </Grid.ColumnDefinitions>

          <!-- VLAN List -->
          <Grid Grid.Column="0">
            <DataGrid Name="VlanGrid" Margin="5"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      SelectionMode="Single" SelectionUnit="FullRow"
                      Background="{DynamicResource Theme.Surface.Primary}"
                      Foreground="{DynamicResource Theme.Text.Primary}"
                      GridLinesVisibility="Horizontal"
                      RowBackground="{DynamicResource Theme.Surface.Primary}"
                      AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}"
                      ScrollViewer.IsDeferredScrollingEnabled="True"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      EnableRowVirtualization="True">
              <DataGrid.Columns>
                <DataGridTextColumn Header="VLAN" Binding="{Binding VlanNumber}" Width="60"/>
                <DataGridTextColumn Header="Name" Binding="{Binding VlanName}" Width="120"/>
                <DataGridTextColumn Header="Purpose" Binding="{Binding Purpose}" Width="90"/>
                <DataGridTextColumn Header="Site" Binding="{Binding Site}" Width="100"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
                <DataGridTextColumn Header="SVI" Binding="{Binding SVIAddress}" Width="120"/>
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
              </DataGrid.Columns>
            </DataGrid>

            <Border Name="VlanEmptyStatePanel" HorizontalAlignment="Center" VerticalAlignment="Center"
                    Background="{DynamicResource Theme.Surface.Primary}" Padding="30,20" CornerRadius="8"
                    Visibility="Collapsed">
              <StackPanel>
                <TextBlock Text="No VLANs" FontSize="18" FontWeight="Bold"
                           Foreground="{DynamicResource Theme.Text.Primary}" HorizontalAlignment="Center"/>
                <TextBlock Text="Click 'Add VLAN' to create your first VLAN"
                           Foreground="{DynamicResource Theme.Text.Muted}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
              </StackPanel>
            </Border>
          </Grid>

          <!-- VLAN Details Panel -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Name="VlanDetailsPanel">
                <TextBlock Text="VLAN Details" FontWeight="Bold" FontSize="14" Margin="0,0,0,10" Foreground="{DynamicResource Theme.Text.Primary}"/>

                <Label Content="VLAN Number:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanNumberBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Name:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanNameBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Purpose:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="VlanPurposeCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Data" IsSelected="True"/>
                  <ComboBoxItem Content="Voice"/>
                  <ComboBoxItem Content="Management"/>
                  <ComboBoxItem Content="Infrastructure"/>
                  <ComboBoxItem Content="Guest"/>
                  <ComboBoxItem Content="IoT"/>
                  <ComboBoxItem Content="Server"/>
                  <ComboBoxItem Content="Other"/>
                </ComboBox>

                <Label Content="Site:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanSiteBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Status:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="VlanStatusCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Active" IsSelected="True"/>
                  <ComboBoxItem Content="Reserved"/>
                  <ComboBoxItem Content="Deprecated"/>
                  <ComboBoxItem Content="Planned"/>
                </ComboBox>

                <Label Content="SVI Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanSVIBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}" ToolTip="e.g., 10.1.10.1"/>

                <Label Content="Description:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanDescriptionBox" Margin="0,2,0,10" Height="50" TextWrapping="Wrap" AcceptsReturn="True" Background="{DynamicResource Theme.Input.Background}"/>

                <StackPanel Orientation="Horizontal">
                  <Button Name="SaveVlanButton" Content="Save" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
                  <Button Name="DeleteVlanButton" Content="Delete" Style="{DynamicResource SecondaryButtonStyle}" ToolTip="Delete this VLAN permanently"/>
                </StackPanel>
              </StackPanel>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <!-- Subnets Tab -->
      <TabItem Header="Subnets">
        <Grid Background="{DynamicResource Theme.Surface.Secondary}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="320"/>
          </Grid.ColumnDefinitions>

          <!-- Subnet List -->
          <Grid Grid.Column="0">
            <DataGrid Name="SubnetGrid" Margin="5"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      SelectionMode="Single" SelectionUnit="FullRow"
                      Background="{DynamicResource Theme.Surface.Primary}"
                      Foreground="{DynamicResource Theme.Text.Primary}"
                      GridLinesVisibility="Horizontal"
                      RowBackground="{DynamicResource Theme.Surface.Primary}"
                      AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}"
                      ScrollViewer.IsDeferredScrollingEnabled="True"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      EnableRowVirtualization="True">
              <DataGrid.Columns>
                <DataGridTextColumn Header="Network" Binding="{Binding NetworkAddress}" Width="110"/>
                <DataGridTextColumn Header="/" Binding="{Binding PrefixLength}" Width="30"/>
                <DataGridTextColumn Header="VLAN" Binding="{Binding VlanNumber}" Width="50"/>
                <DataGridTextColumn Header="Site" Binding="{Binding Site}" Width="90"/>
                <DataGridTextColumn Header="Purpose" Binding="{Binding Purpose}" Width="90"/>
                <DataGridTextColumn Header="Gateway" Binding="{Binding GatewayAddress}" Width="110"/>
                <DataGridTextColumn Header="Hosts" Binding="{Binding TotalHosts}" Width="60"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
              </DataGrid.Columns>
            </DataGrid>

            <Border Name="SubnetEmptyStatePanel" HorizontalAlignment="Center" VerticalAlignment="Center"
                    Background="{DynamicResource Theme.Surface.Primary}" Padding="30,20" CornerRadius="8"
                    Visibility="Collapsed">
              <StackPanel>
                <TextBlock Text="No Subnets" FontSize="18" FontWeight="Bold"
                           Foreground="{DynamicResource Theme.Text.Primary}" HorizontalAlignment="Center"/>
                <TextBlock Text="Click 'Add Subnet' to create your first subnet"
                           Foreground="{DynamicResource Theme.Text.Muted}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
              </StackPanel>
            </Border>
          </Grid>

          <!-- Subnet Details Panel -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Name="SubnetDetailsPanel">
                <TextBlock Text="Subnet Details" FontWeight="Bold" FontSize="14" Margin="0,0,0,10" Foreground="{DynamicResource Theme.Text.Primary}"/>

                <Label Content="Network Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetAddressBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}" ToolTip="e.g., 10.1.10.0"/>

                <Label Content="Prefix Length:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetPrefixBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}" ToolTip="e.g., 24"/>

                <Label Content="VLAN Number:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetVlanBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Site:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetSiteBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Purpose:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="SubnetPurposeCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Data" IsSelected="True"/>
                  <ComboBoxItem Content="Voice"/>
                  <ComboBoxItem Content="Management"/>
                  <ComboBoxItem Content="Infrastructure"/>
                  <ComboBoxItem Content="Guest"/>
                  <ComboBoxItem Content="IoT"/>
                  <ComboBoxItem Content="Server"/>
                  <ComboBoxItem Content="Other"/>
                </ComboBox>

                <Label Content="Gateway:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetGatewayBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Status:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="SubnetStatusCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Active" IsSelected="True"/>
                  <ComboBoxItem Content="Reserved"/>
                  <ComboBoxItem Content="Available"/>
                  <ComboBoxItem Content="Deprecated"/>
                </ComboBox>

                <Border Background="{DynamicResource Theme.Surface.Primary}" Padding="5" Margin="0,5,0,10" CornerRadius="3">
                  <StackPanel Name="SubnetCalcPanel">
                    <TextBlock Text="Calculated Values" FontWeight="Bold" Foreground="{DynamicResource Theme.Text.Primary}"/>
                    <TextBlock Name="SubnetMaskText" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="SubnetRangeText" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="SubnetHostsText" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                  </StackPanel>
                </Border>

                <StackPanel Orientation="Horizontal">
                  <Button Name="SaveSubnetButton" Content="Save" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
                  <Button Name="DeleteSubnetButton" Content="Delete" Margin="0,0,10,0" Style="{DynamicResource SecondaryButtonStyle}" ToolTip="Delete this subnet permanently"/>
                  <Button Name="SplitSubnetButton" Content="Split" Style="{DynamicResource SecondaryButtonStyle}" ToolTip="Split into smaller subnets"/>
                </StackPanel>
              </StackPanel>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <!-- IP Addresses Tab -->
      <TabItem Header="IP Addresses">
        <Grid Background="{DynamicResource Theme.Surface.Secondary}">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280"/>
          </Grid.ColumnDefinitions>

          <!-- IP List -->
          <Grid Grid.Column="0">
            <DataGrid Name="IPGrid" Margin="5"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      SelectionMode="Single" SelectionUnit="FullRow"
                      Background="{DynamicResource Theme.Surface.Primary}"
                      Foreground="{DynamicResource Theme.Text.Primary}"
                      GridLinesVisibility="Horizontal"
                      RowBackground="{DynamicResource Theme.Surface.Primary}"
                      AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}"
                      ScrollViewer.IsDeferredScrollingEnabled="True"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      EnableRowVirtualization="True">
              <DataGrid.Columns>
                <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="120"/>
                <DataGridTextColumn Header="Device" Binding="{Binding DeviceName}" Width="100"/>
                <DataGridTextColumn Header="Interface" Binding="{Binding InterfaceName}" Width="90"/>
                <DataGridTextColumn Header="Type" Binding="{Binding AddressType}" Width="80"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="70"/>
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
              </DataGrid.Columns>
            </DataGrid>

            <Border Name="IPEmptyStatePanel" HorizontalAlignment="Center" VerticalAlignment="Center"
                    Background="{DynamicResource Theme.Surface.Primary}" Padding="30,20" CornerRadius="8"
                    Visibility="Collapsed">
              <StackPanel>
                <TextBlock Text="No IP Addresses" FontSize="18" FontWeight="Bold"
                           Foreground="{DynamicResource Theme.Text.Primary}" HorizontalAlignment="Center"/>
                <TextBlock Text="Click 'Add IP' to create your first IP record"
                           Foreground="{DynamicResource Theme.Text.Muted}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
              </StackPanel>
            </Border>
          </Grid>

          <!-- IP Details Panel -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Name="IPDetailsPanel">
                <TextBlock Text="IP Address Details" FontWeight="Bold" FontSize="14" Margin="0,0,0,10" Foreground="{DynamicResource Theme.Text.Primary}"/>

                <Label Content="IP Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPAddressBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Device:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPDeviceBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Interface:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPInterfaceBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Type:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="IPTypeCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Static" IsSelected="True"/>
                  <ComboBoxItem Content="DHCP"/>
                  <ComboBoxItem Content="HSRP"/>
                  <ComboBoxItem Content="VRRP"/>
                  <ComboBoxItem Content="Loopback"/>
                  <ComboBoxItem Content="Management"/>
                  <ComboBoxItem Content="Other"/>
                </ComboBox>

                <Label Content="Description:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPDescriptionBox" Margin="0,2,0,10" Background="{DynamicResource Theme.Input.Background}"/>

                <StackPanel Orientation="Horizontal">
                  <Button Name="SaveIPButton" Content="Save" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
                  <Button Name="DeleteIPButton" Content="Delete" Style="{DynamicResource SecondaryButtonStyle}" ToolTip="Delete this IP address record permanently"/>
                </StackPanel>
              </StackPanel>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <!-- Conflicts Tab -->
      <TabItem Header="Conflicts">
        <Grid Margin="5" Background="{DynamicResource Theme.Surface.Secondary}">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <Button Name="RefreshConflictsButton" Content="Refresh" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
            <TextBlock Name="ConflictSummaryText" VerticalAlignment="Center" Foreground="{DynamicResource Theme.Text.Primary}"/>
          </StackPanel>

          <Grid Grid.Row="1">
            <DataGrid Name="ConflictsGrid"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      Background="{DynamicResource Theme.Surface.Primary}"
                      Foreground="{DynamicResource Theme.Text.Primary}"
                      GridLinesVisibility="Horizontal"
                      RowBackground="{DynamicResource Theme.Surface.Primary}"
                      AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}"
                      ScrollViewer.IsDeferredScrollingEnabled="True"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      EnableRowVirtualization="True">
              <DataGrid.Columns>
                <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="80"/>
                <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
                <DataGridTextColumn Header="Details" Binding="{Binding Details}" Width="*"/>
              </DataGrid.Columns>
            </DataGrid>

            <Border Name="ConflictsEmptyStatePanel" HorizontalAlignment="Center" VerticalAlignment="Center"
                    Background="{DynamicResource Theme.Surface.Primary}" Padding="30,20" CornerRadius="8"
                    Visibility="Collapsed">
              <StackPanel>
                <TextBlock Text="No Conflicts" FontSize="18" FontWeight="Bold"
                           Foreground="{DynamicResource Theme.Text.Primary}" HorizontalAlignment="Center"/>
                <TextBlock Text="No IP address conflicts detected"
                           Foreground="{DynamicResource Theme.Text.Muted}" HorizontalAlignment="Center" Margin="0,5,0,0"/>
              </StackPanel>
            </Border>
          </Grid>
        </Grid>
      </TabItem>

      <!-- Statistics Tab -->
      <TabItem Header="Statistics">
        <ScrollViewer VerticalScrollBarVisibility="Auto" Background="{DynamicResource Theme.Surface.Secondary}">
          <Grid Margin="10">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- VLAN Stats -->
            <Border Grid.Row="0" Grid.Column="0" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="VLAN Statistics" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalVlansText" Text="Total VLANs: 0" Margin="0,10,0,0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Text="By Purpose:" FontWeight="SemiBold" Margin="0,10,0,5" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <ItemsControl Name="VlansByPurposeList"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling"
                              VirtualizingPanel.ScrollUnit="Pixel"
                              ScrollViewer.CanContentScroll="True">
                  <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                      <VirtualizingStackPanel/>
                    </ItemsPanelTemplate>
                  </ItemsControl.ItemsPanel>
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Foreground="{DynamicResource Theme.Text.Secondary}">
                        <Run Text="  "/>
                        <Run Text="{Binding Key}"/>: <Run Text="{Binding Value}"/>
                      </TextBlock>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </Border>

            <!-- Subnet Stats -->
            <Border Grid.Row="0" Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="Subnet Statistics" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalSubnetsText" Text="Total Subnets: 0" Margin="0,10,0,0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalHostsText" Text="Total Allocated Hosts: 0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Text="By Purpose:" FontWeight="SemiBold" Margin="0,10,0,5" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <ItemsControl Name="SubnetsByPurposeList"
                              VirtualizingPanel.IsVirtualizing="True"
                              VirtualizingPanel.VirtualizationMode="Recycling"
                              VirtualizingPanel.ScrollUnit="Pixel"
                              ScrollViewer.CanContentScroll="True">
                  <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                      <VirtualizingStackPanel/>
                    </ItemsPanelTemplate>
                  </ItemsControl.ItemsPanel>
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Foreground="{DynamicResource Theme.Text.Secondary}">
                        <Run Text="  "/>
                        <Run Text="{Binding Key}"/>: <Run Text="{Binding Value}"/>
                      </TextBlock>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </Border>

            <!-- Sites -->
            <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="Sites" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalIPsText" Text="Total IP Records: 0" Margin="0,10,0,0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="SitesListText" Text="Sites: (none)" Margin="0,5,0,0" Foreground="{DynamicResource Theme.Text.Secondary}" TextWrapping="Wrap"/>
              </StackPanel>
            </Border>
          </Grid>
        </ScrollViewer>
      </TabItem>
    </TabControl>

    <!-- Site Planning Wizard Panel (overlay) -->
    <Border Grid.Row="1" Name="WizardPanel" Visibility="Collapsed"
            Background="{DynamicResource Theme.Surface.Primary}"
            BorderBrush="{DynamicResource Theme.Border.Primary}"
            BorderThickness="1" Margin="10" Padding="15">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Wizard Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
          <TextBlock Text="New Site Address Planning Wizard" FontSize="18" FontWeight="Bold"
                     Foreground="{DynamicResource Theme.Text.Primary}"/>
          <TextBlock Text="Configure addressing requirements for a new site" FontSize="12"
                     Foreground="{DynamicResource Theme.Text.Secondary}" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Wizard Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Column: Site Info and Supernet -->
            <StackPanel Grid.Column="0" Margin="0,0,15,0">
              <Border Background="{DynamicResource Theme.Surface.Secondary}" Padding="15" CornerRadius="5" Margin="0,0,0,15">
                <StackPanel>
                  <TextBlock Text="Site Information" FontWeight="Bold" FontSize="14"
                             Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>

                  <Label Content="Site Name:" Style="{DynamicResource ToolbarLabelStyle}"/>
                  <TextBox Name="WizardSiteNameBox" Margin="0,2,0,10"
                           Background="{DynamicResource Theme.Input.Background}"
                           ToolTip="e.g., Building-C, Campus-North"/>

                  <Label Content="Supernet Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                  <TextBox Name="WizardSupernetBox" Margin="0,2,0,5"
                           Background="{DynamicResource Theme.Input.Background}"
                           ToolTip="e.g., 10.3.0.0"/>

                  <Label Content="Supernet Prefix (/):" Style="{DynamicResource ToolbarLabelStyle}"/>
                  <ComboBox Name="WizardPrefixCombo" Margin="0,2,0,10" Style="{DynamicResource ToolbarComboBoxStyle}">
                    <ComboBoxItem Content="16" IsSelected="True"/>
                    <ComboBoxItem Content="17"/>
                    <ComboBoxItem Content="18"/>
                    <ComboBoxItem Content="19"/>
                    <ComboBoxItem Content="20"/>
                    <ComboBoxItem Content="21"/>
                    <ComboBoxItem Content="22"/>
                  </ComboBox>

                  <Label Content="Growth Factor:" Style="{DynamicResource ToolbarLabelStyle}"/>
                  <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                    <Slider Name="WizardGrowthSlider" Minimum="0" Maximum="100" Value="25"
                            Width="150" VerticalAlignment="Center"/>
                    <TextBlock Name="WizardGrowthText" Text="25%" Margin="10,0,0,0"
                               VerticalAlignment="Center" Foreground="{DynamicResource Theme.Text.Primary}"/>
                  </StackPanel>
                </StackPanel>
              </Border>

              <!-- Preview Panel -->
              <Border Background="{DynamicResource Theme.Surface.Secondary}" Padding="15" CornerRadius="5"
                      Name="WizardPreviewPanel" Visibility="Collapsed">
                <StackPanel>
                  <TextBlock Text="Generated Address Plan" FontWeight="Bold" FontSize="14"
                             Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>
                  <TextBox Name="WizardPreviewBox" IsReadOnly="True" TextWrapping="Wrap"
                           Height="180" VerticalScrollBarVisibility="Auto"
                           Background="{DynamicResource Theme.Input.Background}"
                           FontFamily="Consolas" FontSize="11"/>
                </StackPanel>
              </Border>
            </StackPanel>

            <!-- Right Column: VLAN Requirements -->
            <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="Required VLANs" FontWeight="Bold" FontSize="14"
                           Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>
                <TextBlock Text="Select which VLANs to allocate and specify expected host counts:"
                           Foreground="{DynamicResource Theme.Text.Secondary}" TextWrapping="Wrap" Margin="0,0,0,15"/>

                <!-- Data VLAN -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="60"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Grid.Column="0" Name="WizardDataCheck" IsChecked="True" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="User Data" VerticalAlignment="Center" Margin="5,0,0,0"
                             Foreground="{DynamicResource Theme.Text.Primary}"/>
                  <TextBox Grid.Column="2" Name="WizardDataHostsBox" Text="100" Margin="5,0"
                           Background="{DynamicResource Theme.Input.Background}" ToolTip="Expected hosts"/>
                  <TextBlock Grid.Column="3" Name="WizardDataSubnetText" Text="/24" VerticalAlignment="Center"
                             Foreground="{DynamicResource Theme.Text.Secondary}"/>
                </Grid>

                <!-- Voice VLAN -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="60"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Grid.Column="0" Name="WizardVoiceCheck" IsChecked="True" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="Voice" VerticalAlignment="Center" Margin="5,0,0,0"
                             Foreground="{DynamicResource Theme.Text.Primary}"/>
                  <TextBox Grid.Column="2" Name="WizardVoiceHostsBox" Text="50" Margin="5,0"
                           Background="{DynamicResource Theme.Input.Background}" ToolTip="Expected hosts"/>
                  <TextBlock Grid.Column="3" Name="WizardVoiceSubnetText" Text="/25" VerticalAlignment="Center"
                             Foreground="{DynamicResource Theme.Text.Secondary}"/>
                </Grid>

                <!-- Management VLAN -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="60"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Grid.Column="0" Name="WizardMgmtCheck" IsChecked="True" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="Management" VerticalAlignment="Center" Margin="5,0,0,0"
                             Foreground="{DynamicResource Theme.Text.Primary}"/>
                  <TextBox Grid.Column="2" Name="WizardMgmtHostsBox" Text="20" Margin="5,0"
                           Background="{DynamicResource Theme.Input.Background}" ToolTip="Expected hosts"/>
                  <TextBlock Grid.Column="3" Name="WizardMgmtSubnetText" Text="/27" VerticalAlignment="Center"
                             Foreground="{DynamicResource Theme.Text.Secondary}"/>
                </Grid>

                <!-- Guest VLAN -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="60"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Grid.Column="0" Name="WizardGuestCheck" IsChecked="False" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="Guest" VerticalAlignment="Center" Margin="5,0,0,0"
                             Foreground="{DynamicResource Theme.Text.Primary}"/>
                  <TextBox Grid.Column="2" Name="WizardGuestHostsBox" Text="50" Margin="5,0"
                           Background="{DynamicResource Theme.Input.Background}" ToolTip="Expected hosts"/>
                  <TextBlock Grid.Column="3" Name="WizardGuestSubnetText" Text="/25" VerticalAlignment="Center"
                             Foreground="{DynamicResource Theme.Text.Secondary}"/>
                </Grid>

                <!-- IoT VLAN -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="60"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Grid.Column="0" Name="WizardIoTCheck" IsChecked="False" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="IoT / Sensors" VerticalAlignment="Center" Margin="5,0,0,0"
                             Foreground="{DynamicResource Theme.Text.Primary}"/>
                  <TextBox Grid.Column="2" Name="WizardIoTHostsBox" Text="30" Margin="5,0"
                           Background="{DynamicResource Theme.Input.Background}" ToolTip="Expected hosts"/>
                  <TextBlock Grid.Column="3" Name="WizardIoTSubnetText" Text="/26" VerticalAlignment="Center"
                             Foreground="{DynamicResource Theme.Text.Secondary}"/>
                </Grid>

                <!-- Server VLAN -->
                <Grid Margin="0,0,0,10">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="60"/>
                  </Grid.ColumnDefinitions>
                  <CheckBox Grid.Column="0" Name="WizardServerCheck" IsChecked="False" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="Server / Infrastructure" VerticalAlignment="Center" Margin="5,0,0,0"
                             Foreground="{DynamicResource Theme.Text.Primary}"/>
                  <TextBox Grid.Column="2" Name="WizardServerHostsBox" Text="20" Margin="5,0"
                           Background="{DynamicResource Theme.Input.Background}" ToolTip="Expected hosts"/>
                  <TextBlock Grid.Column="3" Name="WizardServerSubnetText" Text="/27" VerticalAlignment="Center"
                             Foreground="{DynamicResource Theme.Text.Secondary}"/>
                </Grid>

                <Border Background="{DynamicResource Theme.Surface.Primary}" Padding="10" CornerRadius="3" Margin="0,15,0,0">
                  <StackPanel>
                    <TextBlock Text="VLAN Number Assignments" FontWeight="SemiBold"
                               Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,5"/>
                    <TextBlock Foreground="{DynamicResource Theme.Text.Secondary}" TextWrapping="Wrap" FontSize="11">
                      Data: 10 | Voice: 20 | Management: 100 | Guest: 40 | IoT: 50 | Server: 30
                    </TextBlock>
                  </StackPanel>
                </Border>
              </StackPanel>
            </Border>
          </Grid>
        </ScrollViewer>

        <!-- Wizard Footer -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
          <Button Name="WizardGenerateButton" Content="Generate Plan" Margin="0,0,10,0"
                  Style="{DynamicResource PrimaryButtonStyle}" Padding="20,8"/>
          <Button Name="WizardApplyButton" Content="Apply Plan" Margin="0,0,10,0"
                  Style="{DynamicResource PrimaryButtonStyle}" Padding="20,8" Visibility="Collapsed"/>
          <Button Name="WizardCancelButton" Content="Cancel"
                  Style="{DynamicResource SecondaryButtonStyle}" Padding="20,8"/>
        </StackPanel>
      </Grid>
    </Border>

    <!-- Status Bar -->
    <Border Grid.Row="2" Background="{DynamicResource Theme.Toolbar.Background}" Padding="5">
      <TextBlock Name="StatusText" Text="Ready" Foreground="{DynamicResource Theme.Toolbar.Text}"/>
    </Border>
  </Grid>
</UserControl>
