<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Toolbar -->
    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5" Background="{DynamicResource Theme.Toolbar.Background}">
      <Button Name="AddVlanButton" Content="Add VLAN" Margin="5,2" Style="{DynamicResource PrimaryButtonStyle}"/>
      <Button Name="AddSubnetButton" Content="Add Subnet" Margin="5,2" Style="{DynamicResource PrimaryButtonStyle}"/>
      <Button Name="AddIPButton" Content="Add IP" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Separator Margin="5,2"/>
      <Button Name="ImportButton" Content="Import" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Button Name="ExportButton" Content="Export" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Separator Margin="5,2"/>
      <Button Name="CheckConflictsButton" Content="Check Conflicts" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Button Name="PlanSiteButton" Content="Plan Site" Margin="5,2" Style="{DynamicResource SecondaryButtonStyle}"/>
      <Separator Margin="5,2"/>
      <Label Content="Site:" VerticalAlignment="Center" Style="{DynamicResource ToolbarLabelStyle}"/>
      <ComboBox Name="SiteFilterCombo" Width="120" Margin="5,2" Style="{DynamicResource ToolbarComboBoxStyle}"/>
    </StackPanel>

    <!-- Main Content - Tab Control -->
    <TabControl Grid.Row="1" Margin="5" Name="MainTabControl" Background="{DynamicResource Theme.Surface.Primary}">

      <!-- VLANs Tab -->
      <TabItem Header="VLANs">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
          </Grid.ColumnDefinitions>

          <!-- VLAN List -->
          <DataGrid Grid.Column="0" Name="VlanGrid" Margin="5"
                    AutoGenerateColumns="False" IsReadOnly="True"
                    SelectionMode="Single" SelectionUnit="FullRow"
                    Background="{DynamicResource Theme.Surface.Primary}"
                    Foreground="{DynamicResource Theme.Text.Primary}"
                    GridLinesVisibility="Horizontal"
                    RowBackground="{DynamicResource Theme.Surface.Primary}"
                    AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}">
            <DataGrid.Columns>
              <DataGridTextColumn Header="VLAN" Binding="{Binding VlanNumber}" Width="60"/>
              <DataGridTextColumn Header="Name" Binding="{Binding VlanName}" Width="120"/>
              <DataGridTextColumn Header="Purpose" Binding="{Binding Purpose}" Width="90"/>
              <DataGridTextColumn Header="Site" Binding="{Binding Site}" Width="100"/>
              <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
              <DataGridTextColumn Header="SVI" Binding="{Binding SVIAddress}" Width="120"/>
              <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
            </DataGrid.Columns>
          </DataGrid>

          <!-- VLAN Details Panel -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Name="VlanDetailsPanel">
                <TextBlock Text="VLAN Details" FontWeight="Bold" FontSize="14" Margin="0,0,0,10" Foreground="{DynamicResource Theme.Text.Primary}"/>

                <Label Content="VLAN Number:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanNumberBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Name:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanNameBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Purpose:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="VlanPurposeCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Data" IsSelected="True"/>
                  <ComboBoxItem Content="Voice"/>
                  <ComboBoxItem Content="Management"/>
                  <ComboBoxItem Content="Infrastructure"/>
                  <ComboBoxItem Content="Guest"/>
                  <ComboBoxItem Content="IoT"/>
                  <ComboBoxItem Content="Server"/>
                  <ComboBoxItem Content="Other"/>
                </ComboBox>

                <Label Content="Site:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanSiteBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Status:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="VlanStatusCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Active" IsSelected="True"/>
                  <ComboBoxItem Content="Reserved"/>
                  <ComboBoxItem Content="Deprecated"/>
                  <ComboBoxItem Content="Planned"/>
                </ComboBox>

                <Label Content="SVI Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanSVIBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}" ToolTip="e.g., 10.1.10.1"/>

                <Label Content="Description:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="VlanDescriptionBox" Margin="0,2,0,10" Height="50" TextWrapping="Wrap" AcceptsReturn="True" Background="{DynamicResource Theme.Input.Background}"/>

                <StackPanel Orientation="Horizontal">
                  <Button Name="SaveVlanButton" Content="Save" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
                  <Button Name="DeleteVlanButton" Content="Delete" Style="{DynamicResource SecondaryButtonStyle}"/>
                </StackPanel>
              </StackPanel>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <!-- Subnets Tab -->
      <TabItem Header="Subnets">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="320"/>
          </Grid.ColumnDefinitions>

          <!-- Subnet List -->
          <DataGrid Grid.Column="0" Name="SubnetGrid" Margin="5"
                    AutoGenerateColumns="False" IsReadOnly="True"
                    SelectionMode="Single" SelectionUnit="FullRow"
                    Background="{DynamicResource Theme.Surface.Primary}"
                    Foreground="{DynamicResource Theme.Text.Primary}"
                    GridLinesVisibility="Horizontal"
                    RowBackground="{DynamicResource Theme.Surface.Primary}"
                    AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}">
            <DataGrid.Columns>
              <DataGridTextColumn Header="Network" Binding="{Binding NetworkAddress}" Width="110"/>
              <DataGridTextColumn Header="/" Binding="{Binding PrefixLength}" Width="30"/>
              <DataGridTextColumn Header="VLAN" Binding="{Binding VlanNumber}" Width="50"/>
              <DataGridTextColumn Header="Site" Binding="{Binding Site}" Width="90"/>
              <DataGridTextColumn Header="Purpose" Binding="{Binding Purpose}" Width="90"/>
              <DataGridTextColumn Header="Gateway" Binding="{Binding GatewayAddress}" Width="110"/>
              <DataGridTextColumn Header="Hosts" Binding="{Binding TotalHosts}" Width="60"/>
              <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
            </DataGrid.Columns>
          </DataGrid>

          <!-- Subnet Details Panel -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Name="SubnetDetailsPanel">
                <TextBlock Text="Subnet Details" FontWeight="Bold" FontSize="14" Margin="0,0,0,10" Foreground="{DynamicResource Theme.Text.Primary}"/>

                <Label Content="Network Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetAddressBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}" ToolTip="e.g., 10.1.10.0"/>

                <Label Content="Prefix Length:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetPrefixBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}" ToolTip="e.g., 24"/>

                <Label Content="VLAN Number:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetVlanBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Site:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetSiteBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Purpose:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="SubnetPurposeCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Data" IsSelected="True"/>
                  <ComboBoxItem Content="Voice"/>
                  <ComboBoxItem Content="Management"/>
                  <ComboBoxItem Content="Infrastructure"/>
                  <ComboBoxItem Content="Guest"/>
                  <ComboBoxItem Content="IoT"/>
                  <ComboBoxItem Content="Server"/>
                  <ComboBoxItem Content="Other"/>
                </ComboBox>

                <Label Content="Gateway:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="SubnetGatewayBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Status:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="SubnetStatusCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Active" IsSelected="True"/>
                  <ComboBoxItem Content="Reserved"/>
                  <ComboBoxItem Content="Available"/>
                  <ComboBoxItem Content="Deprecated"/>
                </ComboBox>

                <Border Background="{DynamicResource Theme.Surface.Primary}" Padding="5" Margin="0,5,0,10" CornerRadius="3">
                  <StackPanel Name="SubnetCalcPanel">
                    <TextBlock Text="Calculated Values" FontWeight="Bold" Foreground="{DynamicResource Theme.Text.Primary}"/>
                    <TextBlock Name="SubnetMaskText" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="SubnetRangeText" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="SubnetHostsText" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                  </StackPanel>
                </Border>

                <StackPanel Orientation="Horizontal">
                  <Button Name="SaveSubnetButton" Content="Save" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
                  <Button Name="DeleteSubnetButton" Content="Delete" Margin="0,0,10,0" Style="{DynamicResource SecondaryButtonStyle}"/>
                  <Button Name="SplitSubnetButton" Content="Split" Style="{DynamicResource SecondaryButtonStyle}" ToolTip="Split into smaller subnets"/>
                </StackPanel>
              </StackPanel>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <!-- IP Addresses Tab -->
      <TabItem Header="IP Addresses">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280"/>
          </Grid.ColumnDefinitions>

          <!-- IP List -->
          <DataGrid Grid.Column="0" Name="IPGrid" Margin="5"
                    AutoGenerateColumns="False" IsReadOnly="True"
                    SelectionMode="Single" SelectionUnit="FullRow"
                    Background="{DynamicResource Theme.Surface.Primary}"
                    Foreground="{DynamicResource Theme.Text.Primary}"
                    GridLinesVisibility="Horizontal"
                    RowBackground="{DynamicResource Theme.Surface.Primary}"
                    AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}">
            <DataGrid.Columns>
              <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="120"/>
              <DataGridTextColumn Header="Device" Binding="{Binding DeviceName}" Width="100"/>
              <DataGridTextColumn Header="Interface" Binding="{Binding InterfaceName}" Width="90"/>
              <DataGridTextColumn Header="Type" Binding="{Binding AddressType}" Width="80"/>
              <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="70"/>
              <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
            </DataGrid.Columns>
          </DataGrid>

          <!-- IP Details Panel -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <StackPanel Name="IPDetailsPanel">
                <TextBlock Text="IP Address Details" FontWeight="Bold" FontSize="14" Margin="0,0,0,10" Foreground="{DynamicResource Theme.Text.Primary}"/>

                <Label Content="IP Address:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPAddressBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Device:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPDeviceBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Interface:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPInterfaceBox" Margin="0,2,0,5" Background="{DynamicResource Theme.Input.Background}"/>

                <Label Content="Type:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <ComboBox Name="IPTypeCombo" Margin="0,2,0,5" Style="{DynamicResource ToolbarComboBoxStyle}">
                  <ComboBoxItem Content="Static" IsSelected="True"/>
                  <ComboBoxItem Content="DHCP"/>
                  <ComboBoxItem Content="HSRP"/>
                  <ComboBoxItem Content="VRRP"/>
                  <ComboBoxItem Content="Loopback"/>
                  <ComboBoxItem Content="Management"/>
                  <ComboBoxItem Content="Other"/>
                </ComboBox>

                <Label Content="Description:" Style="{DynamicResource ToolbarLabelStyle}"/>
                <TextBox Name="IPDescriptionBox" Margin="0,2,0,10" Background="{DynamicResource Theme.Input.Background}"/>

                <StackPanel Orientation="Horizontal">
                  <Button Name="SaveIPButton" Content="Save" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
                  <Button Name="DeleteIPButton" Content="Delete" Style="{DynamicResource SecondaryButtonStyle}"/>
                </StackPanel>
              </StackPanel>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <!-- Conflicts Tab -->
      <TabItem Header="Conflicts">
        <Grid Margin="5">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <Button Name="RefreshConflictsButton" Content="Refresh" Margin="0,0,10,0" Style="{DynamicResource PrimaryButtonStyle}"/>
            <TextBlock Name="ConflictSummaryText" VerticalAlignment="Center" Foreground="{DynamicResource Theme.Text.Primary}"/>
          </StackPanel>

          <DataGrid Grid.Row="1" Name="ConflictsGrid"
                    AutoGenerateColumns="False" IsReadOnly="True"
                    Background="{DynamicResource Theme.Surface.Primary}"
                    Foreground="{DynamicResource Theme.Text.Primary}"
                    GridLinesVisibility="Horizontal"
                    RowBackground="{DynamicResource Theme.Surface.Primary}"
                    AlternatingRowBackground="{DynamicResource Theme.Surface.Secondary}">
            <DataGrid.Columns>
              <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="80"/>
              <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
              <DataGridTextColumn Header="Details" Binding="{Binding Details}" Width="*"/>
            </DataGrid.Columns>
          </DataGrid>
        </Grid>
      </TabItem>

      <!-- Statistics Tab -->
      <TabItem Header="Statistics">
        <ScrollViewer VerticalScrollBarVisibility="Auto">
          <Grid Margin="10">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- VLAN Stats -->
            <Border Grid.Row="0" Grid.Column="0" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="VLAN Statistics" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalVlansText" Text="Total VLANs: 0" Margin="0,10,0,0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Text="By Purpose:" FontWeight="SemiBold" Margin="0,10,0,5" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <ItemsControl Name="VlansByPurposeList">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Foreground="{DynamicResource Theme.Text.Secondary}">
                        <Run Text="  "/>
                        <Run Text="{Binding Key}"/>: <Run Text="{Binding Value}"/>
                      </TextBlock>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </Border>

            <!-- Subnet Stats -->
            <Border Grid.Row="0" Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="Subnet Statistics" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalSubnetsText" Text="Total Subnets: 0" Margin="0,10,0,0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalHostsText" Text="Total Allocated Hosts: 0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Text="By Purpose:" FontWeight="SemiBold" Margin="0,10,0,5" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <ItemsControl Name="SubnetsByPurposeList">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Foreground="{DynamicResource Theme.Text.Secondary}">
                        <Run Text="  "/>
                        <Run Text="{Binding Key}"/>: <Run Text="{Binding Value}"/>
                      </TextBlock>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </Border>

            <!-- Sites -->
            <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Background="{DynamicResource Theme.Surface.Secondary}" Margin="5" Padding="15" CornerRadius="5">
              <StackPanel>
                <TextBlock Text="Sites" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="TotalIPsText" Text="Total IP Records: 0" Margin="0,10,0,0" Foreground="{DynamicResource Theme.Text.Primary}"/>
                <TextBlock Name="SitesListText" Text="Sites: (none)" Margin="0,5,0,0" Foreground="{DynamicResource Theme.Text.Secondary}" TextWrapping="Wrap"/>
              </StackPanel>
            </Border>
          </Grid>
        </ScrollViewer>
      </TabItem>
    </TabControl>

    <!-- Status Bar -->
    <Border Grid.Row="2" Background="{DynamicResource Theme.Toolbar.Background}" Padding="5">
      <TextBlock Name="StatusText" Text="Ready" Foreground="{DynamicResource Theme.Text.Primary}"/>
    </Border>
  </Grid>
</UserControl>
