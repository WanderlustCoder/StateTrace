<UserControl xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             AutomationProperties.Name="Impact Analysis">

  <Grid Background="{DynamicResource Theme.Surface.Primary}">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Header -->
    <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10" Margin="5">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Orientation="Horizontal">
          <TextBlock Text="&#xE946;" FontFamily="Segoe MDL2 Assets" FontSize="24" 
                     Foreground="{DynamicResource Theme.Text.Primary}" VerticalAlignment="Center" Margin="0,0,10,0"/>
          <TextBlock Text="Impact Analysis" FontSize="18" FontWeight="Bold" 
                     Foreground="{DynamicResource Theme.Text.Primary}" VerticalAlignment="Center"/>
        </StackPanel>

        <StackPanel Grid.Column="1" Orientation="Horizontal">
          <Button Name="RefreshGraphButton" Content="&#xE72C; Refresh Graph" FontFamily="Segoe MDL2 Assets" 
                  Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,5,0" 
                  ToolTip="Rebuild dependency graph" AutomationProperties.Name="Refresh graph"/>
          <Button Name="NewChangeRequestButton" Content="&#xE710; New Change Request" FontFamily="Segoe MDL2 Assets" 
                  Style="{DynamicResource PrimaryButtonStyle}"
                  ToolTip="Create new change request" AutomationProperties.Name="New change request"/>
        </StackPanel>
      </Grid>
    </Border>

    <!-- Analysis Input Panel -->
    <Border Grid.Row="1" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10" Margin="5">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <TextBlock Grid.Column="0" Text="Change Type:" VerticalAlignment="Center" 
                   Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,10,0"/>
        <ComboBox Name="ChangeTypeCombo" Grid.Column="1" SelectedIndex="0" Margin="0,0,15,0"
                  AutomationProperties.Name="Change type">
          <ComboBoxItem Content="DeviceDown"/>
          <ComboBoxItem Content="InterfaceDown"/>
          <ComboBoxItem Content="VLANChange"/>
          <ComboBoxItem Content="MaintenanceWindow"/>
          <ComboBoxItem Content="ConfigChange"/>
        </ComboBox>

        <TextBlock Grid.Column="2" Text="Target:" VerticalAlignment="Center" 
                   Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,10,0"/>
        <ComboBox Name="TargetCombo" Grid.Column="3" IsEditable="True" Margin="0,0,15,0"
                  AutomationProperties.Name="Target device or VLAN"/>

        <TextBlock Grid.Column="4" Text="Interface:" VerticalAlignment="Center" 
                   Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,10,0"/>
        <ComboBox Name="InterfaceCombo" Grid.Column="5" Width="150" IsEditable="True"
                  AutomationProperties.Name="Target interface"/>
      </Grid>
    </Border>

    <!-- Main Content -->
    <TabControl Grid.Row="2" Margin="5" Style="{DynamicResource PrimaryTabControlStyle}">
      <!-- Impact Analysis Tab -->
      <TabItem Header="Impact Analysis" AutomationProperties.Name="Impact analysis tab">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <!-- Left Panel - Analysis Controls -->
          <Border Grid.Column="0" Background="{DynamicResource Theme.Surface.Secondary}" Margin="0,0,5,0" Padding="10">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <!-- Analyze Button -->
              <Button Name="AnalyzeButton" Grid.Row="0" Content="&#xE9D9; Analyze Impact" 
                      FontFamily="Segoe MDL2 Assets" Style="{DynamicResource PrimaryButtonStyle}" 
                      Height="40" Margin="0,0,0,15"
                      AutomationProperties.Name="Analyze impact"/>

              <!-- Risk Score Card -->
              <Border Name="RiskScoreCard" Grid.Row="1" CornerRadius="8" Padding="15" Margin="0,0,0,15">
                <Border.Background>
                  <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#607D8B" Offset="0"/>
                    <GradientStop Color="#455A64" Offset="1"/>
                  </LinearGradientBrush>
                </Border.Background>
                <StackPanel HorizontalAlignment="Center">
                  <TextBlock Text="RISK SCORE" FontSize="10" FontWeight="Bold" Foreground="White" 
                             Opacity="0.8" HorizontalAlignment="Center"/>
                  <TextBlock Name="RiskScoreValue" Text="--" FontSize="48" FontWeight="Bold" 
                             Foreground="White" HorizontalAlignment="Center"/>
                  <TextBlock Name="RiskLevelText" Text="Not Analyzed" FontSize="14" Foreground="White" 
                             HorizontalAlignment="Center"/>
                </StackPanel>
              </Border>

              <!-- Impact Summary -->
              <Border Grid.Row="2" Background="{DynamicResource Theme.Surface.Primary}" 
                      CornerRadius="5" Padding="10" Margin="0,0,0,15">
                <StackPanel>
                  <TextBlock Text="Impact Summary" FontWeight="Bold" 
                             Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>
                  
                  <Grid Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Directly Affected:" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="DirectAffectedCount" Grid.Column="1" Text="0" FontWeight="Bold"
                               Foreground="{DynamicResource Theme.Text.Primary}"/>
                  </Grid>

                  <Grid Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Indirectly Affected:" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="IndirectAffectedCount" Grid.Column="1" Text="0" FontWeight="Bold"
                               Foreground="{DynamicResource Theme.Text.Primary}"/>
                  </Grid>

                  <Grid Margin="0,0,0,5">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Affected VLANs:" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="AffectedVLANCount" Grid.Column="1" Text="0" FontWeight="Bold"
                               Foreground="{DynamicResource Theme.Text.Primary}"/>
                  </Grid>

                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Affected Services:" Foreground="{DynamicResource Theme.Text.Secondary}"/>
                    <TextBlock Name="AffectedServiceCount" Grid.Column="1" Text="0" FontWeight="Bold"
                               Foreground="{DynamicResource Theme.Text.Primary}"/>
                  </Grid>
                </StackPanel>
              </Border>

              <!-- Recommendations -->
              <Border Grid.Row="3" Background="{DynamicResource Theme.Surface.Primary}" 
                      CornerRadius="5" Padding="10">
                <Grid>
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                  </Grid.RowDefinitions>
                  
                  <TextBlock Grid.Row="0" Text="Recommendations" FontWeight="Bold" 
                             Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>
                  
                  <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsControl Name="RecommendationsList">
                      <ItemsControl.ItemTemplate>
                        <DataTemplate>
                          <Border Background="#FFF3E0" CornerRadius="3" Padding="8" Margin="0,0,0,5">
                            <TextBlock Text="{Binding}" TextWrapping="Wrap" Foreground="#E65100" FontSize="11"/>
                          </Border>
                        </DataTemplate>
                      </ItemsControl.ItemTemplate>
                    </ItemsControl>
                  </ScrollViewer>
                </Grid>
              </Border>
            </Grid>
          </Border>

          <!-- Right Panel - Affected Components -->
          <Grid Grid.Column="1">
            <Grid.RowDefinitions>
              <RowDefinition Height="*"/>
              <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Directly Affected -->
            <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Margin="0,0,0,5" Padding="10">
              <Grid>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Directly Affected Components" FontWeight="Bold" 
                           Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>

                <DataGrid Name="DirectAffectedGrid" Grid.Row="1" AutoGenerateColumns="False" 
                          CanUserAddRows="False" IsReadOnly="True"
                          Style="{DynamicResource PrimaryDataGridStyle}">
                  <DataGrid.Columns>
                    <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80"/>
                    <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                    <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="100"/>
                    <DataGridTextColumn Header="Criticality" Binding="{Binding Criticality}" Width="80"/>
                    <DataGridTextColumn Header="Interfaces" Binding="{Binding InterfaceCount}" Width="70"/>
                  </DataGrid.Columns>
                </DataGrid>
              </Grid>
            </Border>

            <!-- Indirectly Affected -->
            <Border Grid.Row="1" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10">
              <Grid>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Indirectly Affected (Downstream)" FontWeight="Bold" 
                           Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>

                <DataGrid Name="IndirectAffectedGrid" Grid.Row="1" AutoGenerateColumns="False" 
                          CanUserAddRows="False" IsReadOnly="True"
                          Style="{DynamicResource PrimaryDataGridStyle}">
                  <DataGrid.Columns>
                    <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80"/>
                    <DataGridTextColumn Header="Device" Binding="{Binding Name}" Width="150"/>
                    <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="100"/>
                    <DataGridTextColumn Header="Connection" Binding="{Binding ConnectionType}" Width="100"/>
                    <DataGridTextColumn Header="Interface" Binding="{Binding Interface}" Width="100"/>
                  </DataGrid.Columns>
                </DataGrid>
              </Grid>
            </Border>
          </Grid>
        </Grid>
      </TabItem>

      <!-- Route Trace Tab -->
      <TabItem Header="Route Trace" AutomationProperties.Name="Route trace tab">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <!-- Trace Input -->
          <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10" Margin="0,0,0,5">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="Source:" VerticalAlignment="Center" 
                         Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,10,0"/>
              <TextBox Name="TraceSourceInput" Width="200" Margin="0,0,20,0"
                       AutomationProperties.Name="Source IP or hostname"/>

              <TextBlock Text="Destination:" VerticalAlignment="Center" 
                         Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,10,0"/>
              <TextBox Name="TraceDestInput" Width="200" Margin="0,0,20,0"
                       AutomationProperties.Name="Destination IP or hostname"/>

              <Button Name="TraceRouteButton" Content="&#xE8B0; Trace Path" FontFamily="Segoe MDL2 Assets"
                      Style="{DynamicResource PrimaryButtonStyle}"
                      AutomationProperties.Name="Trace route path"/>
            </StackPanel>
          </Border>

          <!-- Trace Results -->
          <Border Grid.Row="1" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                <TextBlock Name="TraceStatusText" Text="Enter source and destination to trace path" 
                           Foreground="{DynamicResource Theme.Text.Secondary}"/>
              </StackPanel>

              <DataGrid Name="TraceHopsGrid" Grid.Row="1" AutoGenerateColumns="False" 
                        CanUserAddRows="False" IsReadOnly="True"
                        Style="{DynamicResource PrimaryDataGridStyle}">
                <DataGrid.Columns>
                  <DataGridTextColumn Header="Hop" Binding="{Binding Hop}" Width="50"/>
                  <DataGridTextColumn Header="Device" Binding="{Binding Device}" Width="150"/>
                  <DataGridTextColumn Header="Site" Binding="{Binding Site}" Width="80"/>
                  <DataGridTextColumn Header="Role" Binding="{Binding Role}" Width="100"/>
                  <DataGridTextColumn Header="Egress Interface" Binding="{Binding EgressInterface}" Width="120"/>
                  <DataGridTextColumn Header="Next Hop" Binding="{Binding NextHop}" Width="120"/>
                  <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                </DataGrid.Columns>
              </DataGrid>
            </Grid>
          </Border>
        </Grid>
      </TabItem>

      <!-- Services Tab -->
      <TabItem Header="Services" AutomationProperties.Name="Services tab">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <!-- Service List -->
          <Border Grid.Column="0" Background="{DynamicResource Theme.Surface.Secondary}" Margin="0,0,5,0" Padding="10">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
              </Grid.RowDefinitions>

              <TextBlock Grid.Row="0" Text="Defined Services" FontWeight="Bold" 
                         Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>

              <ListBox Name="ServicesList" Grid.Row="1" Background="Transparent" BorderThickness="0"
                       Style="{DynamicResource PrimaryListBoxStyle}"/>

              <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                <Button Name="AddServiceButton" Content="&#xE710; Add" FontFamily="Segoe MDL2 Assets"
                        Style="{DynamicResource PrimaryButtonStyle}" Margin="0,0,5,0"/>
                <Button Name="EditServiceButton" Content="Edit" Style="{DynamicResource SecondaryButtonStyle}" Margin="0,0,5,0"/>
                <Button Name="RemoveServiceButton" Content="Remove" Style="{DynamicResource SecondaryButtonStyle}"/>
              </StackPanel>
            </Grid>
          </Border>

          <!-- Service Details -->
          <Border Grid.Column="1" Background="{DynamicResource Theme.Surface.Secondary}" Padding="10">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>

              <TextBlock Grid.Row="0" Text="Service Details" FontWeight="Bold" 
                         Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>

              <Grid Grid.Row="1" Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="100"/>
                  <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:" 
                           Foreground="{DynamicResource Theme.Text.Secondary}" Margin="0,0,0,5"/>
                <TextBlock Name="ServiceNameText" Grid.Row="0" Grid.Column="1" Text="-" 
                           Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,5"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Criticality:" 
                           Foreground="{DynamicResource Theme.Text.Secondary}" Margin="0,0,0,5"/>
                <TextBlock Name="ServiceCriticalityText" Grid.Row="1" Grid.Column="1" Text="-" 
                           Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,5"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Owner:" 
                           Foreground="{DynamicResource Theme.Text.Secondary}"/>
                <TextBlock Name="ServiceOwnerText" Grid.Row="2" Grid.Column="1" Text="-" 
                           Foreground="{DynamicResource Theme.Text.Primary}"/>
              </Grid>

              <Border Grid.Row="2" Background="{DynamicResource Theme.Surface.Primary}" CornerRadius="5" Padding="10">
                <Grid>
                  <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                  </Grid.RowDefinitions>

                  <TextBlock Grid.Row="0" Text="Dependencies" FontWeight="Bold" 
                             Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,0,10"/>

                  <DataGrid Name="ServiceDependenciesGrid" Grid.Row="1" AutoGenerateColumns="False" 
                            CanUserAddRows="False" IsReadOnly="True"
                            Style="{DynamicResource PrimaryDataGridStyle}">
                    <DataGrid.Columns>
                      <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="100"/>
                      <DataGridTextColumn Header="Target" Binding="{Binding Target}" Width="*"/>
                    </DataGrid.Columns>
                  </DataGrid>
                </Grid>
              </Border>
            </Grid>
          </Border>
        </Grid>
      </TabItem>

      <!-- Change Requests Tab -->
      <TabItem Header="Change Requests" AutomationProperties.Name="Change requests tab">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <!-- Filter Bar -->
          <Border Grid.Row="0" Background="{DynamicResource Theme.Surface.Secondary}" Padding="5" Margin="0,0,0,5">
            <StackPanel Orientation="Horizontal">
              <TextBlock Text="Status:" VerticalAlignment="Center" 
                         Foreground="{DynamicResource Theme.Text.Primary}" Margin="0,0,5,0"/>
              <ComboBox Name="CRStatusFilter" Width="150" SelectedIndex="0">
                <ComboBoxItem Content="All"/>
                <ComboBoxItem Content="PendingApproval"/>
                <ComboBoxItem Content="Approved"/>
                <ComboBoxItem Content="Completed"/>
              </ComboBox>
              <Button Name="RefreshCRButton" Content="Refresh" Style="{DynamicResource SecondaryButtonStyle}" Margin="15,0,0,0"/>
            </StackPanel>
          </Border>

          <!-- Change Requests Grid -->
          <DataGrid Name="ChangeRequestsGrid" Grid.Row="1" AutoGenerateColumns="False" 
                    CanUserAddRows="False" IsReadOnly="True"
                    Style="{DynamicResource PrimaryDataGridStyle}">
            <DataGrid.ContextMenu>
              <ContextMenu>
                <MenuItem Name="ApproveCRMenuItem" Header="Approve"/>
                <MenuItem Name="CompleteCRMenuItem" Header="Mark Complete"/>
                <Separator/>
                <MenuItem Name="ViewCRDetailsMenuItem" Header="View Details"/>
              </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.Columns>
              <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="130"/>
              <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="200"/>
              <DataGridTextColumn Header="Type" Binding="{Binding ChangeType}" Width="100"/>
              <DataGridTextColumn Header="Target" Binding="{Binding Target}" Width="120"/>
              <DataGridTemplateColumn Header="Risk" Width="80" SortMemberPath="Impact.RiskLevel">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <Border CornerRadius="3" Padding="5,2" HorizontalAlignment="Center">
                      <Border.Style>
                        <Style TargetType="Border">
                          <Style.Triggers>
                            <DataTrigger Binding="{Binding Impact.RiskLevel}" Value="Critical">
                              <Setter Property="Background" Value="#F44336"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Impact.RiskLevel}" Value="High">
                              <Setter Property="Background" Value="#FF9800"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Impact.RiskLevel}" Value="Medium">
                              <Setter Property="Background" Value="#FFC107"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Impact.RiskLevel}" Value="Low">
                              <Setter Property="Background" Value="#4CAF50"/>
                            </DataTrigger>
                          </Style.Triggers>
                        </Style>
                      </Border.Style>
                      <TextBlock Text="{Binding Impact.RiskLevel}" Foreground="White" FontWeight="Bold" FontSize="10"/>
                    </Border>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
              <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
              <DataGridTextColumn Header="Requestor" Binding="{Binding Requestor}" Width="100"/>
              <DataGridTextColumn Header="Scheduled" Binding="{Binding ScheduledStart}" Width="140"/>
            </DataGrid.Columns>
          </DataGrid>
        </Grid>
      </TabItem>
    </TabControl>

    <!-- Status Bar -->
    <Border Grid.Row="3" Background="{DynamicResource Theme.Surface.Secondary}" Padding="5">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <TextBlock Name="StatusText" Grid.Column="0" Text="Ready" 
                   Foreground="{DynamicResource Theme.Text.Secondary}"/>

        <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,20,0">
          <TextBlock Text="Graph Nodes: " Foreground="{DynamicResource Theme.Text.Secondary}"/>
          <TextBlock Name="GraphNodesCount" Text="0" Foreground="{DynamicResource Theme.Text.Primary}"/>
        </StackPanel>

        <StackPanel Grid.Column="2" Orientation="Horizontal">
          <TextBlock Text="Graph Edges: " Foreground="{DynamicResource Theme.Text.Secondary}"/>
          <TextBlock Name="GraphEdgesCount" Text="0" Foreground="{DynamicResource Theme.Text.Primary}"/>
        </StackPanel>
      </Grid>
    </Border>

  </Grid>
</UserControl>
