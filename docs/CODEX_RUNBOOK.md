# Codex Runbook – Install, Run, Test

This runbook maps common automation tasks to the exact commands, required inputs, telemetry captures, and follow-up docs. Use it alongside `docs/CODEX_AUTONOMY_PLAN.md` and the per-plan files.

## Command matrix
| Task | Commands | Notes | Telemetry / evidence |
|------|----------|-------|----------------------|
| Full test suite | `Invoke-Pester Modules/Tests` | Run before every commit; capture summary. | Paste final Pester line into session log. |
| Cold ingestion pass | `Tools\Invoke-StateTracePipeline.ps1 -SkipTests -VerboseParsing -ResetExtractedLogs [-DisableSkipSiteCacheUpdate] [-RunSharedCacheDiagnostics] [-RunQueueDelayHarness] [-QueueDelayHarnessMaxHosts <n>] [-QueueDelayHarnessSiteFilter <sites>] [-ForcePortBatchReadySynthesis]` | Run from repo root; restores shared cache snapshots. When you supply `-SharedCacheSnapshotPath` the harness sets `STATETRACE_SHARED_CACHE_SNAPSHOT` so every parser runspace imports that snapshot before touching Access (set the env var manually if you seed the cache outside the helper). Add `-DisableSkipSiteCacheUpdate` to temporarily flip `SkipSiteCacheUpdate` off (the new guard module restores the original setting afterward) when collecting Plan B telemetry; warm-run helpers already wrap the flag automatically. Add `-RunSharedCacheDiagnostics` to automatically call the shared-cache analyzers against the latest `Logs/IngestionMetrics/*.json`. Add `-RunQueueDelayHarness` (default max hosts = 12; override with `-QueueDelayHarnessMaxHosts`/site filters) to run the dispatcher sweep and emit `InterfacePortQueueMetrics` so queue-delay summaries populate. If InterfacePortQueueMetrics/InterfacePortStreamMetrics are still missing, the pipeline runs the headless Interfaces checklist (STA) with `-SynthesizePortBatchReady:$false` to seed telemetry before queue summary + PortBatchReady synthesis. Add `-ForcePortBatchReadySynthesis` to append synthesized PortBatchReady events (uses dispatch/queue metrics) so the diversity guard evaluates the dispatcher stream; this writes a `.bak` copy beside the metrics file. The parser scheduler fairness guard now runs automatically; only pass `-FailOnSchedulerFairness:$false` or `-SkipPortDiversityGuard` (and log why) when replaying partial/sanitized telemetry that would otherwise trip the streak limits. The harness resets concurrency override settings in `Data/StateTraceSettings.json` back to baseline after the run and logs `ConcurrencyOverrideSummary` when overrides are requested or reset. | Attach `Logs/IngestionMetrics/<date>.json` snippet (ParseDuration, DatabaseWriteLatency, InterfaceSiteCacheMetrics). |
| Cold + warm regression | `Tools\Invoke-StateTracePipeline.ps1 -SkipTests -VerboseParsing -RunWarmRunRegression` *or* `Tools\Invoke-WarmRunRegression.ps1 -VerboseParsing` | Harness preserves parser runspaces, exports the shared snapshot after the cold pass, and wires up `STATETRACE_SHARED_CACHE_SNAPSHOT` so the warm pass reuses the exact cache contents. Override requests are logged in `ConcurrencyOverrideSummary`; any settings overrides are reset to baseline after the pipeline run. Scheduler fairness enforcement is built in—only disable it with `-FailOnSchedulerFairness:$false` when inspecting legacy telemetry and capture the rationale in the plan/task entry. | WarmRunTelemetry JSON + improvement summary recorded in plan/task board. |
| Warm-run telemetry capture | `Tools\Invoke-WarmRunTelemetry.ps1 [-IncludeTests] [-SkipSchedulerFairnessGuard] [-HostFilter <hosts>] [-HostFilterPath <file>] [-RestrictWarmComparisonToColdHosts] [-GenerateDiffHotspotReport [-DiffHotspotTop <n>] [-DiffHotspotOutputPath <file>]] [-GenerateSharedCacheDiagnostics [-SharedCacheDiagnosticsTopHosts <n>]]` | Runs the warm-run pipeline, exports `Logs\IngestionMetrics\WarmRunTelemetry-<timestamp>.json`, writes shared cache snapshots to `Logs\SharedCacheSnapshot\SharedCacheSnapshot-<timestamp>.clixml` and refreshes `Logs\SharedCacheSnapshot\SharedCacheSnapshot-latest.clixml`, temporarily disables `SkipSiteCacheUpdate` (restored automatically unless you pass `-PreserveSkipSiteCacheSetting`), and (with `-GenerateDiffHotspotReport`) automatically calls `Tools\Analyze-WarmRunDiffHotspots.ps1` so a `DiffHotspots-<timestamp>.csv` lands alongside the telemetry. When `-WarmHistorySeed WarmBackup` is used, the log records the selected `.warmrun.*.bak` paths; duplicate-only warm passes (SkippedDuplicate + no ParseDuration) emit `TelemetryMetricStatus` entries with `MetricStatus=NotApplicable` for `DatabaseWriteBreakdown`/`InterfaceSyncTiming` (see the “Pass 'WarmPass' telemetry status” banner) instead of warning. Add `-GenerateSharedCacheDiagnostics` to run the shared-cache analyzers against the latest ingestion metrics file for the captured ColdPass/WarmPass windows; use `-SharedCacheDiagnosticsTopHosts` to size the AccessRefresh host table. When `-GenerateSharedCacheDiagnostics` is set and `-ColdHistorySeed` is not explicitly provided, the helper forces `ColdHistorySeed=Empty` so the cold pass re-parses (avoids SkippedDuplicate-only runs); pass `-ColdHistorySeed Snapshot` if you need to preserve existing history. Leave the parser fairness guard enabled unless you explicitly pass `-SkipSchedulerFairnessGuard` for a targeted investigation (log the reason when you do). Use `-HostFilter`/`-HostFilterPath` (optionally with `-RestrictWarmComparisonToColdHosts`) to lock cold/warm comparisons to the same host set when telemetry directories include extra hosts, and `-DiffHotspotOutputPath` to point the CSV somewhere specific. | Reference the telemetry JSON + diff hotspot CSV paths (and shared-cache diagnostics output when generated) in plan/task updates and stash the artifacts inside the telemetry bundle. |
| Verification harness + queue gate | Tools\Invoke-StateTraceVerification.ps1 [-SkipSchedulerFairnessGuard] [-ForcePortBatchReadySynthesis] [-RawPortDiversityAutoConcurrency] [-QueueMetricsPath <path>] [-QueueDelayMinimumSampleCount <n> -QueueDelayP95Maximum <ms> -QueueDelayP99Maximum <ms>] [-SkipQueueDelayEvaluation] [-QueueDelaySummaryPath <path>] [-GenerateDiffHotspotReport [-DiffHotspotTop <n>] [-DiffHotspotOutputPath <file>]] [-GenerateSharedCacheDiagnostics [-SharedCacheDiagnosticsDirectory <dir>]] [[-TelemetryBundlePath Logs\TelemetryBundles\<bundle> -VerifyTelemetryBundleReadiness [-TelemetryBundleAreas Telemetry,Routing]] | Runs the verification harness (pipeline, warm regression, shared-cache checks) and enforces InterfacePortQueueMetrics.QueueBuildDelayMs limits (p95 <=120 ms, p99 <=200 ms) with a minimum sample floor (default QueueDelayMinimumSampleCount=10; InsufficientData fails unless skipped). Scheduler fairness now gates the pipeline automatically; only add -SkipSchedulerFairnessGuard (and note it in the plan) when replaying incomplete telemetry. Add -ForcePortBatchReadySynthesis to pass through to the pipeline/warm-run passes so the diversity guard uses synthesized PortBatchReady events (dispatch/queue metrics). Add -RawPortDiversityAutoConcurrency to run a dedicated raw PortBatchReady diversity evaluation with auto concurrency; this temporarily resets Data/IngestionHistory, suppresses manual override parameters for the run, skips warm-run regression, and writes Logs/Reports/PortBatchSiteDiversity-<date>-raw-auto-<timestamp>.json with concurrency metadata before restoring history. -GenerateDiffHotspotReport automatically calls Tools\Analyze-WarmRunDiffHotspots.ps1; -GenerateSharedCacheDiagnostics runs the shared-cache analyzers and saves JSON summaries for release evidence. Use the telemetry bundle parameters to call the readiness script automatically after the harness finishes (same coverage as Tools\Test-TelemetryBundleReadiness.ps1). Only skip the queue delay evaluation when telemetry is unavailable and document the reason. | Record warm-run summary path, queue-gate console output (avg/p95/p99/max), the generated Logs\IngestionMetrics\QueueDelaySummary-<timestamp>.json, the Logs\IngestionMetrics\<date>.json source, diff hotspot CSV path, shared-cache diagnostics paths, and the readiness output (bundle path + areas) in the plan/task update.
| Release baseline capture (AllChecks + UI harness + verification) | `pwsh -NoProfile -File Tools/Invoke-AllChecks.ps1` then `pwsh -NoProfile -STA -File Tools/Invoke-DesktopUIHarness.ps1` then `pwsh -NoProfile -File Tools/Invoke-StateTraceVerification.ps1 -SkipTests -VerboseParsing -ResetExtractedLogs -GenerateSharedCacheDiagnostics -GenerateDiffHotspotReport -ForcePortBatchReadySynthesis` and `pwsh -NoProfile -File Tools/Invoke-StateTraceVerification.ps1 -SkipTests -VerboseParsing -ResetExtractedLogs -GenerateSharedCacheDiagnostics -GenerateDiffHotspotReport -RawPortDiversityAutoConcurrency` | Use for release evidence capture. RAW auto-concurrency is opt-in only and resets Data/IngestionHistory for the pass; verify the safety audit hash summary before publishing a bundle. | Record AllChecks log, UIHarnessSummary JSON + harness logs, synth verification log + WarmRunTelemetry/diff hotspots, raw-auto verification log + raw PortBatchSiteDiversity report, and the safety audit JSON in the plan/task update.
| Autoscale profile inspection | `Import-Module .\Modules\ParserRunspaceModule.psm1; Get-AutoScaleConcurrencyProfile -DeviceFiles <paths>` | Use when tuning overrides; log resolved ceilings. | Screenshot or text snippet of resolved profile + overrides. |
| Parser scheduler rotation audit | `pwsh Tools\Analyze-ParserSchedulerLaunch.ps1 -Path Logs\IngestionMetrics\<date>.json -MaxAllowedStreak 8 -OutputPath Logs\Reports\ParserSchedulerLaunch-<date>.json` | Consumes `ParserSchedulerLaunch` telemetry to show launch counts by site, longest streaks, and scheduler resource stats. `Tools\Invoke-StateTracePipeline.ps1` now runs this analyzer automatically (writes `Logs/Reports/ParserSchedulerLaunch-<metrics>.json`), but rerun it whenever you need to inspect historical telemetry or custom streak thresholds. | Attach the JSON report path and note any streak violations in the plan/task update + telemetry bundle. |
| Incremental telemetry completeness | `pwsh Tools\Test-IncrementalTelemetryCompleteness.ps1 -MetricsPath Logs\IngestionMetrics\<date>.json -RequirePortBatchReady -RequireInterfaceSync -RequireSchedulerLaunch [-ThrowOnMissing] [-AllowNoParse]` | Verifies that a telemetry file contains the required incremental-loading signals; use `-ThrowOnMissing` (or pass `-VerifyTelemetryCompleteness -FailOnTelemetryMissing -SynthesizeSchedulerTelemetryOnMissing` to `Tools\\Invoke-StateTracePipeline.ps1`) so pipeline runs fail fast when scheduler/UI data is absent and synthesize scheduler launches when a rerun is not possible.  Use `-AllowNoParse` when the telemetry file only contains `SkippedDuplicate` entries and no parse activity to skip PortBatchReady/InterfaceSync gating. | Record the command output (counts + missing signals) in the plan/task update. Block ST-D-003/ST-A-001 closures until the script passes. |
| Harness smoke summary (Plan I) | `pwsh -NoProfile -File Tools\Test-HarnessSmoke.ps1 -MetricsPath Logs\IngestionMetrics\<date>.json -SummaryPath Logs\Reports\HarnessSmokeSummary-<timestamp>.json` | Generates a queue summary (QueueDelaySummary-smoke-*), PortBatchSiteDiversity-smoke-*, analyzer reports (PortBatchReady/InterfaceSyncTiming/ParserSchedulerLaunch), appends history CSVs, and emits SharedCacheDiagnostics JSON. Default PortDiversityMode is Synth and the summary records the mode + artifact paths. | Record the summary JSON and generated report paths in Plan I + the TaskBoard smoke entry. |
| Compare telemetry smoke (Plan C) | `pwsh -NoProfile -File Tools\Test-CompareTelemetrySmoke.ps1 -OutputPath Logs\Reports\CompareTelemetrySmoke\CompareTelemetrySmoke-<timestamp>.json -UpdateLatest -PassThru` | Runs a deterministic Compare view execution (no WPF/STA) and captures `DiffUsageRate`, `DiffCompareDurationMs`, and `DiffCompareResultCounts` via the CompareViewModule telemetry override. | Record the summary JSON + `Logs\Reports\CompareTelemetrySmoke\CompareTelemetrySmoke-latest.json` pointer in Plan C + TaskBoard. |
| Scheduled harness smoke (Plan I) | `pwsh -NoProfile -File Tools\Invoke-ScheduledHarnessSmoke.ps1` | Runs the harness smoke with default Synth diversity mode, writes timestamped outputs plus `Logs\Reports\HarnessSmokeSummary-latest.json` pointer for TaskBoard surfacing. | Record the summary JSON, latest pointer, and referenced artifacts in Plan I + the TaskBoard smoke entry. |
| Scheduled synthetic harness smoke (Plan I) | `pwsh -NoProfile -File Tools\Invoke-ScheduledHarnessSmoke.ps1 -DatasetVersion 5.1` | Runs harness smoke against the synthetic dataset (5.1), writing outputs under `Logs\Reports\SyntheticSmoke\Synthetic-5.1\` plus a dataset-scoped `HarnessSmokeSummary-latest.json` pointer. Summary records DatasetId, PortDiversityMode, UsedSynthesizedEvents, and artifact paths. | Record the summary JSON, dataset latest pointer, and referenced artifacts in Plan I + the TaskBoard smoke entry. |
| Incremental-loading automation | `pwsh Tools\Invoke-IncrementalLoadingChecklist.ps1 -MaxHosts 20 -SiteFilter WLLS,BOYO [-SkipPipeline] [-SkipHarness] [-ForceTelemetrySynthesis]` | Orchestrates the cold parser pipeline, dispatcher harness sweep, telemetry synthesis, completeness test, and the diversity/scheduler analyzers so we can refresh Plan A/D evidence without touching the WPF UI. Use the flags to reuse an existing metrics file or to skip the harness when replicating historical data. | Capture the console summary + returned JSON (metrics path, sweep summary, PortBatchSiteDiversity JSON, scheduler-vs-port markdown) in the plan/task update and stash the artifacts in the telemetry bundle. |
| Routing online capture validation (Plan A) | `pwsh -NoProfile -File Tools\Test-RoutingOnlineCaptureReadiness.ps1 -SessionPath Tests\Fixtures\Routing\CliCaptureSession\CiscoIOSXE\Session.json -OutputPath Logs\Reports\RoutingOnlineCaptureReadiness-<timestamp>.json [-RequireSsh] [-SshUser <user> -SshIdentityFile <path> -SshPort 22 -SshExePath ssh]` | Offline preflight only; no network operations. Online capture is operator-run: set `STATETRACE_ALLOW_NETWORK_CAPTURE=1` and pass `-AllowNetworkCapture` to `Tools\Invoke-RoutingCliCaptureSession.ps1 -Mode Online -SessionPath <Session.json> -SshUser <user> -SshIdentityFile <path> -UpdateLatest`. | Record readiness JSON + log path in Plan A + TaskBoard; capture the operator-run online logs separately. |
| Routing validation run (Plan A) | `pwsh -NoProfile -File Tools\Invoke-RoutingValidationRun.ps1 -SessionPath Tests\Fixtures\Routing\CliCaptureSession\CiscoIOSXE\Session.json -Mode Offline -OutputRoot Logs\Reports\RoutingValidationRun -UpdateLatest -PassThru` | Orchestrates preflight + capture + ingest + pipeline into a single run folder under `Logs\Reports\RoutingValidationRun\Run-<timestamp>\`. Current phase is offline-only; online capture is deferred/out-of-scope. Online capture is operator-run only: set `STATETRACE_ALLOW_NETWORK_CAPTURE=1` and pass `-AllowNetworkCapture -Mode Online -SshUser <user> -SshIdentityFile <path>` (no passwords). QuickStart: `docs/runbooks/Routing_QuickStart.md`; operator checklist: `docs/runbooks/Routing_RealDeviceValidation.md`; evidence template: `docs/templates/Routing_RealDeviceEvidence.md`; validator: `Tools/Test-RoutingRealDeviceEvidence.ps1`; architecture: `docs/StateTrace_Routing_DataArchitecture.md`. | Record the run summary JSON, latest pointer, per-host pipeline summaries, and the validator output JSON in Plan A + TaskBoard. |
| Headless Interfaces view session | `pwsh -NoLogo -STA -File Tools\Invoke-InterfacesViewChecklist.ps1 -SiteFilter WLLS,BOYO -MaxHosts 10 [-Hostnames <array>] [-HostTimeoutSeconds <n> -NoProgressTimeoutSeconds <n>] [-OutputPath <file>] [-SynthesizePortBatchReady:$false] [-PassThru]` | Hosts the Interfaces view inside a hidden window, cycles through each host, streams incremental batches via the dispatcher, and records per-host success metrics while the normal UI telemetry (`PortBatchReady`, `InterfaceSyncTiming`, `DeviceDetailsLoadMetrics`) is emitted. PortBatchReady synthesis is enabled by default; disable with `-SynthesizePortBatchReady:$false` when you only need the raw stream/dispatch/queue telemetry. Use when a "real UI" incremental-loading run is required but an interactive desktop is unavailable. | Attach the output JSON (or PassThru summary) plus the associated telemetry paths (Logs/IngestionMetrics/*.json, PortBatchSiteDiversity JSON, scheduler-vs-port markdown) to Plan D ST-D-010/Task Board updates and copy everything into the telemetry bundle. |
| Headless Search/Alerts smoke test | `pwsh -NoLogo -STA -File Tools\Invoke-SearchAlertsSmokeTest.ps1 [-SiteFilter <sites>] [-Hostnames <array>] [-TimeoutSeconds <n> -NoProgressTimeoutSeconds <n>] [-EnableDiagnostics] [-PassThru]` | Loads Search + Alerts views inside a hidden window, binds interface data, and asserts the grids populate. Required for any new Search/Alerts work and as the default headless smoke check for new UI features/functions that rely on interface insights; `Tools\Invoke-AllChecks.ps1` now runs this unless `-SkipSearchAlertsHarness` is set. | Record the PassThru summary (SearchCount, AlertsCount, bound flags) in the session log. |
| Scheduler vs. Port streak correlation | `pwsh Tools\Compare-SchedulerAndPortDiversity.ps1 -SchedulerReportPath Logs\Reports\ParserSchedulerLaunch-<date>.json -PortDiversityReportPath Logs\Reports\PortBatchSiteDiversity-<date>.json -OutputPath Logs\Reports\SchedulerVsPortDiversity-<date>.json -MarkdownPath docs\performance\SchedulerVsPortDiversity-<date>.md` | Compares parser scheduler launch streaks with PortBatchReady site streaks so ST-D-010 can prove whether the UI still replays hosts despite the guard. | Attach the generated markdown/JSON to Plan D updates and drop it into the telemetry bundle beside the analyzer outputs. |
| Metrics rollup | `Tools\Rollup-IngestionMetrics.ps1 ...` or `Tools\Invoke-DailyMetricRollup.ps1 -Days 1 -IncludePerSite -IncludeSiteCache` | Run when telemetry changes; the daily wrapper filters the latest files and emits `IngestionMetricsSummary-<timestamp>.csv`. | Mention output path + date in plan/task update (and check summary into docs/Logs when requested). |
| Telemetry bundle export | `& .\Tools\Publish-TelemetryBundle.ps1 -BundleName Release-2025-12-24 -AreaName Telemetry -PlanReferences @('PlanB','PlanI') -TaskBoardIds @('ST-B-001','ST-I-002') -DocSyncPath @('docs\agents\sessions\2025-12-24_session-0003.md','Logs\Reports\DocSyncChecklist-20251224-ST-I-002.json') -AdditionalPath @('Logs\Reports\PortBatchReady-2025-12-24.json','Logs\Reports\PortBatchSiteDiversity-2025-12-24.json','Logs\Reports\InterfaceSyncTiming-2025-12-24.json','Logs\Reports\ParserSchedulerLaunch-2025-12-24.json','Logs\Reports\SchedulerVsPortDiversity-2025-12-24.json','Logs\DispatchHarness\RoutingQueueSweep-pipeline-2025-12-24.json','docs\performance\SchedulerVsPortDiversity-2025-12-24.md') -Notes 'ST-I-002 guarded run (synthesis + queue harness) evidence' -Force` | Auto-discovers the latest cold telemetry, warm telemetry, shared-cache analyzers, diff-hotspot CSV, rollup summary, queue/scheduler history CSVs, and session log, then calls `Tools\New-TelemetryBundle.ps1` to copy them (plus hashes) into `Logs/TelemetryBundles/<BundleName>/[Area]`. Use `-AreaName Routing` when capturing Plan A dispatcher evidence. Bundles must stay under `Logs/TelemetryBundles/`; pass `-AllowCustomOutputRoot` only when explicitly redirecting output (clean any stray `PlanH/<bundle>` paths). When publishing a release candidate, pass `-RiskRegisterEntries @('RR-001', 'RR-002')` so the README lists the relevant risk register items. | Record the bundle path inside the relevant plan/timeline entry and TaskBoard row so release approvals can reference it. |
<!-- LANDMARK: ST-G-007 sample telemetry bundle verification command -->
| Telemetry bundle verification | `& .\Tools\Test-TelemetryBundleReadiness.ps1 -BundlePath Logs\TelemetryBundles\Release-2025-12-24 -Area Telemetry -IncludeReadmeHash -SummaryPath Logs\TelemetryBundles\Release-2025-12-24\VerificationSummary.json` (see `docs/runbooks/Telemetry_Bundle_Verification.md`) or `Tools\Invoke-AllChecks.ps1 -TelemetryBundlePath Logs\TelemetryBundles\<bundle> -RequireTelemetryBundleReady -SkipPester -SkipSpanHarness` during CI wrap-up. Offline sample: `& .\Tools\Test-TelemetryBundleReadiness.ps1 -BundlePath Data/Samples/TelemetryBundles/Sample-ReleaseBundle -Area Telemetry,Routing -IncludeReadmeHash -SummaryPath Logs/Reports/TelemetryBundleReadiness-Sample.json`. | Run immediately after exporting Telemetry + Routing bundles so Plan E/G can cite verified contents/hashes. Script throws when required artifacts (rollup CSV, analyzers, warm run JSON, queue summaries, dispatcher logs, doc-sync evidence) are missing and emits README hash tables + a JSON summary for provenance. Always reference `Logs/TelemetryBundles/<bundle>/` (do not point to stray `PlanH/<bundle>` copies). | Paste README hashes, manifest path, verification timestamp, and summary file path into Plan E ST-E-007/009, Plan G ST-G-007, and TaskBoard rows. |
| Telemetry integrity lint | `pwsh -File Tools\Test-TelemetryIntegrity.ps1 -Path Logs\IngestionMetrics\<file>.json -RequireQueueSummary -RequireInterfaceSync` (or via `Tools\Invoke-StateTracePipeline.ps1 -RequireTelemetryIntegrity` / `Tools\Invoke-AllChecks.ps1 -RequireTelemetryIntegrity`) | Fails fast on malformed JSON lines and missing queue/InterfaceSync events to prevent polluted telemetry from blocking analyzers/bundles. | Run after pipeline/warm-run output is produced; attach paths/results to Plan M updates. |
| Unused export lint | `pwsh -File Tools\Report-UnusedExports.ps1 -OutputPath Logs\Reports\UnusedExports.json -FailOnUnused` or via `Tools\Invoke-AllChecks.ps1` (default) | Flags zero-reference function exports across Modules/Tools/Main; fails harness/CI when unused candidates are present and writes JSON report. | Attach report path and decisions to Plan S updates; allowlist intentional entrypoints when needed. |
| Display bundle summary | `pwsh Tools\Show-TelemetryBundleSummary.ps1 -BundlePath Logs\TelemetryBundles\<bundle> [-SummaryPath <path>] [-PassThru]` | Renders the hashes + requirement status stored in `VerificationSummary.json` so operators can reference prior readiness runs without reprocessing the bundle. | Useful when filling in release notes, plan timelines, or reviewing historical bundles. |
| Incremental-loading telemetry analysis | `pwsh Tools\Analyze-PortBatchReadyTelemetry.ps1 -Path Logs\IngestionMetrics\<file>.json -IncludeHostBreakdown -OutputPath Logs\Reports\PortBatchReady-<date>.json` | Summarises `PortBatchReady` + `InterfaceSyncTiming` events (throughput, host coverage, UiClone/Stream/Diff durations) so Plan D can document UI performance baselines. | Attach the console summary + JSON report to Plan D ST-D-003 and Task Board updates whenever UI performance is questioned. |
| InterfaceSyncTiming sweep | `pwsh Tools\Analyze-InterfaceSyncTiming.ps1 -Path Logs\IngestionMetrics\<file>.json -OutputPath Logs\Reports\InterfaceSyncTiming-<date>.json -TopHosts 15` | Highlights per-site/host UiClone + StreamDispatch hot spots so UI perf regressions surface quickly (pairs with incremental-loading analysis). | Log the JSON path + top offenders in Plan D notes/task board when diagnosing UI latency. |
| Port batch gap detection | `pwsh Tools\Analyze-PortBatchIntervals.ps1 -Path Logs\IngestionMetrics\<file>.json -TopIntervals 10 -ThresholdSeconds 60` | Lists the longest idle windows between PortBatchReady events so throttling/idled queues are obvious. | Record any gaps ≥60 s in Plan D and open follow-up actions if they persist. |
| Schedule verification task | `Tools\Schedule-VerificationTask.ps1 -TaskName StateTraceVerification -StartTime 03:00 [-IncludeTests] [-SharedCacheSnapshotDirectory <path> -DryRun]` | Registers (or previews) a Windows Task Scheduler job that runs `Tools\Invoke-StateTraceScheduledVerification.ps1`; add `-IncludeTests` for new features/functions and use `-AdditionalArguments` to forward harness overrides (see `docs/runbooks/Schedule_Verification.md`). | Record the task name/time and latest `Logs/Verification/VerificationSummary-*.json` path in Plan G + Task Board row ST-G-010. |
| Schedule rollup task | `Tools\Schedule-DailyRollupTask.ps1 -TaskName StateTraceDailyRollup -StartTime 02:00 [-MetricsDirectory <path> -OutputDirectory <path> -DryRun]` | Registers (or previews) a Windows Task Scheduler job that runs the wrapper `Tools\Invoke-DailyRollupScheduled.ps1` (which calls `Tools\Invoke-DailyMetricRollup.ps1`) daily so ST-E-003 stays compliant. | Record the task name/time and resulting CSV path in Plan E + Task Board row ST-E-003. |
| Routing queue sweep | `Tools\Invoke-RoutingQueueSweep.ps1 -HostListPath Data\RoutingHosts.txt [-Hosts <array>] [-QueueDelayWarningMs 120 -QueueDelayCriticalMs 200]` | Automates dispatcher harness runs for multiple hosts by calling `powershell.exe -STA -File Tools\Invoke-InterfaceDispatchHarness.ps1` per host; logs land in `Logs\DispatchHarness\` with queue-delay summaries printed to the console. | Attach the generated log paths and resulting queue-delay summary (`QueueDelaySummary-<timestamp>.json`) to Plan A + telemetry bundles (ST-A-005/006). |
| Shared cache warmup | `Tools\Invoke-SharedCacheWarmup.ps1 -ShowSharedCacheSummary -RequiredSites BOYO,WLLS` | Prepares snapshots before verification and temporarily disables `SkipSiteCacheUpdate` (restored automatically unless you pass `-PreserveSkipSiteCacheSetting`). | Attach `SharedCacheSnapshot-*-summary.json` stats. |
| Shared cache diagnostics | `Tools\Analyze-SharedCacheStoreState.ps1 -Path Logs\IngestionMetrics\<file>.json [-IncludeSiteBreakdown]` | Summarizes `InterfaceSiteCacheSharedStore*` telemetry (SnapshotImported hits, GetMiss/GetHit ratios, top sites). Run after any cold/warm harness to confirm snapshots were imported and to spot remaining Access hydrations. See `docs/CODEX_SHARED_CACHE_DIAGNOSTICS.md` for the full workflow. | Paste summary table (or note SnapshotImported=0) in plan/task update; link the analyzed log. |
| Shared cache snapshot guard | `pwsh -File Tools\Test-SharedCacheSnapshot.ps1 -Path Logs\SharedCacheSnapshot\SharedCacheSnapshot-latest.clixml -MinimumSiteCount <n> -MinimumHostCount <n> -MinimumTotalRowCount <n> -RequiredSites BOYO,WLLS` | Fails fast when snapshots lack coverage before warm/verification runs. Accepts summary JSON. | Run after warmup or before verification; record pass/fail and report path in Plan Q updates. |
| Provider reason diagnostics | `Tools\Analyze-SiteCacheProviderReasons.ps1 -Path Logs\IngestionMetrics\<file>.json [-IncludeHostBreakdown]` | Aggregates `InterfaceSyncTiming.SiteCacheProvider*` fields so you can see AccessRefresh vs. SharedCacheMatch per site; optional host breakdown surfaces worst offenders + fetch durations (details in `docs/CODEX_SHARED_CACHE_DIAGNOSTICS.md`). | Reference counts (per site) in plan/task updates; attach host table when AccessRefresh persists. |
| Reset online-mode flags | `Tools\Reset-OnlineModeFlags.ps1 -Reason "PlanF ST-F-009 wrap-up" [-EnvVarNames …] [-OutputDirectory Logs\NetOps]` | Clears `STATETRACE_AGENT_ALLOW_*`, writes `Logs/NetOps/Resets/OnlineModeReset-<timestamp>.json` (now with the supplied reason), and prints the evidence path so session/task updates can cite it. Run immediately after any online-mode work. | Mention the reset log path + reason in your session log, plan update, and Task Board entry. |
| Analyze diff hotspots | `Tools\Analyze-WarmRunDiffHotspots.ps1 -TelemetryPath Logs\IngestionMetrics\<warm run>.json -Top 20` | Useful for Plan B + C investigations. | Link exported table or paste top offenders. |
| Incremental loading verification | `Tools\Invoke-StateTracePipeline.ps1 -SkipTests -VerboseParsing -ResetExtractedLogs` (fairness guard on by default) then follow `docs/StateTrace_Operators_Runbook.md` (Interfaces view + telemetry capture). | Confirms streaming UI stays responsive and that `PortBatchReady`/`InterfaceSyncTiming` metrics hit the documented targets. The parser scheduler fairness guard fails the run whenever `ParserSchedulerLaunch` shows streaks above the configured limit—only disable it (`-FailOnSchedulerFairness:$false`) when replaying historical telemetry and note the exception. | Record `Logs/IngestionMetrics/<date>.json` path, PortBatchReady count, InterfaceSyncTiming durations, and UI observations in session log/plan update. |
| UI smoke test | Follow `docs/UI_Smoke_Checklist.md` (launch `Main/MainWindow.ps1`, exercise each tab, optional span harness). | Note any view regressions plus span snapshot output. | Checklist completion logged in session notes + plan/task entry. |
| SPAN view smoke test | `pwsh -STA -File Tools\Invoke-SpanViewSmokeTest.ps1 -Hostname <host> -PassThru` | Loads the SPAN view off-screen, triggers `Get-SpanInfo`, and emits a snapshot so regressions surface without the full UI. | Capture the returned object (row count, VLAN samples) and reference the log (`Logs/Debug/SpanDiag.log`) in your plan/session notes. |
| Span view binding diagnostics | `pwsh -STA -File Tools\Test-SpanViewBinding.ps1 -EmitDiagnostics -AsJson [-Hostname <host>]` (or `powershell.exe -STA -File Tools\Test-SpanViewBinding.ps1 ...`) | Emits structured diagnostics (exception chain, WPF assembly status, spanView/global state) for Span harness failures. | Store the JSON output (and any redirected log) under `Logs/UIHarness/` and reference it in the plan/session update. |
| Desktop UI harness (Span/Search/Alerts) | `pwsh -STA -File Tools\Invoke-DesktopUIHarness.ps1 [-SpanHostname <host>] [-SearchAlertsSiteFilter <sites>] [-SearchAlertsHostnames <array>]` | Runs the desktop-required UI harnesses in sequence and writes logs + a summary JSON under `Logs/UIHarness/`. Use this after UI changes or when AllChecks reports a RequiresDesktop span harness. | Record `Logs/UIHarness/UIHarnessSummary-<timestamp>.json` plus the per-harness logs in the plan/task update. |
| Freshness telemetry summary | `pwsh -NoLogo -File Tools\Analyze-FreshnessTelemetry.ps1 -Path Logs\IngestionMetrics\<date>.json -OutputPath Logs\Reports\FreshnessTelemetrySummary-<date>.json` | Summarizes cache provider/status signals per site for the freshness label (Plan H); handles newline JSON. | Reference the summary path in Plan H/task updates and include in UI bundles when showing freshness coverage. |
| Plan H readiness check | `pwsh -NoLogo -File Tools\Test-PlanHReadiness.ps1 -BundlePath Logs\TelemetryBundles\<bundle>` | Verifies bundle contains UserAction coverage (all required actions) + freshness summary; auto-discovers paths from manifest. | Note Ready/Failures in session log; gate Plan H updates on success. Use `-VerifyPlanHReadiness` on `Tools\Publish-TelemetryBundle.ps1` to enforce automatically. |
| Plan H readiness viewer | `pwsh -NoLogo -File Tools\Show-PlanHReadiness.ps1 -BundlePath Logs\TelemetryBundles\<bundle>` | Prints Ready/paths from `PlanHReadiness*.json` (auto-discovers latest if not provided). | Use when summarizing bundle evidence in session logs or plans. |
| Plan H status (latest) | `pwsh -NoLogo -File Tools\Check-PlanHStatus.ps1 [-FailOnNotReady]` | Runs readiness on the latest bundle (or supplied path); optional failure for CI. | Use in CI or pre-release to ensure latest bundle is Plan H ready. |
| Plan H checks + report | `pwsh -NoLogo -File Tools\Invoke-PlanHChecks.ps1 [-BundlePath Logs\TelemetryBundles\<bundle>] [-FailOnNotReady]` | Runs readiness on latest/specified bundle and writes a markdown report (PlanHReport-latest.md). | Attach the report to plan/task updates; use `-FailOnNotReady` in CI. |
| Doc-sync checklist | `pwsh -NoLogo -File Tools\Test-DocSyncChecklist.ps1 -TaskId <id> -SessionLogPath docs\agents\sessions\<date>_session-XXXX.md -RequireSessionLog [-RequireBacklogEntry] [-PlanPath docs\plans\PlanG_ReleaseGovernance.md] [-OutputPath Logs\Reports\DocSyncChecklist-<timestamp>.json]` or `pwsh -NoLogo -File Tools\Invoke-AllChecks.ps1 -DocSyncTaskId <id> -DocSyncSessionLogPath docs\agents\sessions\<date>_session-XXXX.md -RequireDocSyncChecklist [-DocSyncOutputPath Logs\Reports\DocSyncChecklist-<timestamp>.json]` | Validates plan/task board/backlog updates plus session log references for the supplied TaskBoard ID; emits a JSON summary for bundle evidence. | Record the checklist JSON path in plan/task updates and copy it into `Logs\TelemetryBundles\<bundle>\DocSync\DocSyncChecklist.json`. |
| TaskBoard integrity guard | `pwsh -NoLogo -File Tools\Test-TaskBoardIntegrity.ps1 [-TaskBoardCsvPath docs\taskboard\TaskBoard.csv] [-MinimumRowCount 10] [-MaxDeletedRows 20] [-AllowLargeTaskBoardEdits] [-OutputPath Logs\Reports\TaskBoardIntegrity-<timestamp>.json]` | Parses the TaskBoard CSV, enforces required columns + unique non-empty IDs, and blocks large deletions unless `-AllowLargeTaskBoardEdits` is set. The doc-sync checklist now runs this guard automatically. | Record the integrity JSON path in the session log and doc-sync evidence; recover with `git checkout -- docs/taskboard/TaskBoard.csv` or `git restore docs/taskboard/TaskBoard.csv` if you hit an unexpected deletion guard. |
| Routing log viewer (offline) | `pwsh -NoLogo -File Tools\Show-RoutingLogSummary.ps1 -Path <summary.json> [-UseLatest] [-Format Console|Markdown|Csv] [-OutputPath <file>]` | Offline-only summary renderer for routing validation runs, routing discovery pipelines, or RoutingDiff outputs. Use `-UseLatest` with a summary directory containing `*-latest.json`. | Attach rendered markdown/CSV to session logs when reviewing routing evidence. |
| Routing log index (offline) | `pwsh -NoLogo -File Tools\Build-RoutingLogIndex.ps1 -RootPath Logs\Reports -OutputPath Logs\Reports\RoutingLogIndex\RoutingLogIndex-<timestamp>.json -Recurse -UseLatestPointers -UpdateLatest` | Offline-only indexer for routing validation/pipeline/evidence summaries plus RoutingDiff outputs. Produces a deterministic index JSON + latest pointer for rapid browsing. | Record the index JSON + latest pointer in Plan A/task updates when curating offline routing evidence. |
| Routing log explorer (offline) | `pwsh -NoLogo -File Tools\Invoke-RoutingLogExplorer.ps1 -IndexPath Logs\Reports\RoutingLogIndex\RoutingLogIndex-latest.json -ListOnly [-Type RoutingValidationRun|RoutingDiscoveryPipeline|RoutingRealDeviceEvidence|RoutingDiff|Unknown] [-Status Pass|Fail] [-Site <site> -Hostname <host> -Vendor <vendor> -Vrf <vrf>] [-Latest] [-Select <index> -Format Console|Markdown -OutputPath <file>] [-ExportBundle [-BundleZipPath Logs\Reports\RoutingBundles\RoutingBundle-Explorer-<timestamp>.zip]]` | Offline-only explorer to list/filter/select routing summaries from the index. `-Select` is 0-based; Markdown output requires `-OutputPath`. `-Latest` auto-selects the newest entry after filters; `-ExportBundle` packages the selected summary. | Attach explorer markdown (or the selected summary output) to Plan A/task updates when reviewing offline routing evidence. |
| Routing log explorer compare (offline) | `pwsh -NoLogo -File Tools\Invoke-RoutingLogExplorer.ps1 -IndexPath Logs\Reports\RoutingLogIndex\RoutingLogIndex-latest.json -Select 0 -CompareWithPrevious [-CompareScope SameType|AnyType] [-DiffOutputPath Logs\Reports\RoutingDiff\RoutingDiff-<timestamp>.json -DiffMarkdownPath Logs\Reports\RoutingDiff\RoutingDiff-<timestamp>.md -DiffUpdateLatest] [-ExportDiffBundle [-DiffBundleZipPath Logs\Reports\RoutingBundles\RoutingBundle-Diff-<timestamp>.zip]]` *or* `pwsh -NoLogo -File Tools\Invoke-RoutingLogExplorer.ps1 -IndexPath Logs\Reports\RoutingLogIndex\RoutingLogIndex-latest.json -Hostname <host> -CompareLatestTwo [-CompareScope SameType|AnyType] [-DiffOutputPath Logs\Reports\RoutingDiff\RoutingDiff-<timestamp>.json -DiffMarkdownPath Logs\Reports\RoutingDiff\RoutingDiff-<timestamp>.md -DiffUpdateLatest] [-ExportDiffBundle [-DiffBundleZipPath Logs\Reports\RoutingBundles\RoutingBundle-Diff-<timestamp>.zip]]` | Offline-only compare mode to diff the selected summary against the previous entry for the same target and emit routing diff outputs. `-CompareLatestTwo` auto-selects the newest entry and finds the prior match; `-ExportDiffBundle` packages the diff output. | Attach diff JSON/markdown to Plan A/task updates when using explorer compare mode. |
| Routing snapshot diff (offline) | `pwsh -NoLogo -File Tools\Compare-RouteHealthSnapshots.ps1 -OldSnapshotPath <old.json> -NewSnapshotPath <new.json> -OutputPath Logs\Reports\RoutingDiff\RoutingDiff-<timestamp>.json [-OldRouteRecordsPath <old> -NewRouteRecordsPath <new> -MarkdownPath Logs\Reports\RoutingDiff\RoutingDiff-<timestamp>.md -UpdateLatest]` | Offline-only diff for RouteHealthSnapshot outputs (optionally enriched with RouteRecords) to produce change reports. | Attach diff JSON/markdown to Plan A/task updates when comparing offline routing runs. |
| Routing offline demo (offline) | `pwsh -NoProfile -File Tools\Invoke-RoutingOfflineDemo.ps1 -UpdateLatest -PassThru` | Deterministic offline demo using repo fixtures; emits Diff/Bundles/Review/Outputs under `Logs\Reports\RoutingOfflineDemo\Run-<timestamp>\`. | Attach the demo summary JSON + explorer markdown path when capturing offline routing evidence. |
| Routing bundle export (offline) | `pwsh -NoLogo -File Tools\Export-RoutingOfflineBundle.ps1 -SummaryPath <summary-or-diff>.json -OutputZipPath Logs\Reports\RoutingBundles\RoutingBundle-<timestamp>.zip [-AllowMissingArtifacts] [-UpdateLatest]` | Offline-only zip bundler for routing summaries/diffs with root path enforcement and a manifest of included files. | Attach the bundle zip + export summary JSON to Plan A/task updates when sharing offline routing evidence. |
| Routing bundle validation (offline) | `pwsh -NoLogo -File Tools\Test-RoutingOfflineBundle.ps1 -BundleZipPath Logs\Reports\RoutingBundles\RoutingBundle-<timestamp>.zip -OutputPath Logs\Reports\RoutingBundles\RoutingBundleValidation-<timestamp>.json [-AllowExtraFiles] [-UpdateLatest]` | Offline-only validator for routing bundles; checks manifest presence, path safety, and SHA256/byte counts (extras fail unless allowed). | Attach the validation JSON + log path when distributing offline routing bundles. |
| Routing bundle expand (offline) | `pwsh -NoLogo -File Tools\Expand-RoutingOfflineBundle.ps1 -BundleZipPath Logs\Reports\RoutingBundles\RoutingBundle-<timestamp>.zip -OutputRoot Logs\Reports\RoutingBundles\Expanded\Bundle-<timestamp> [-Overwrite] [-SkipValidation] [-AllowExtraFiles] [-UpdateLatest]` | Offline-only extractor for routing bundles; validates via `Tools\Test-RoutingOfflineBundle.ps1` unless `-SkipValidation` is set, enforces path traversal safety, and writes an extraction summary JSON with optional latest pointer. | Attach the expansion summary JSON (and validation JSON path) to Plan A/task updates when reviewing offline bundles. |
| Routing bundle review (offline) | `pwsh -NoLogo -File Tools\Invoke-RoutingBundleReview.ps1 -BundleZipPath Logs\Reports\RoutingBundles\RoutingBundle-<timestamp>.zip -WorkspaceRoot Logs\Reports\RoutingBundles\Review\BundleReview-<timestamp> [-Overwrite] [-SkipValidation] [-AllowExtraFiles] [-SkipIndex] [-SkipRender] [-RunExplorer] [-RenderFormat Console|Markdown] [-RenderOutputPath <file>] [-UpdateLatest]` | Offline-only orchestrator that validates, expands, locates the primary summary, and optionally builds an index + renders a summary report (RoutingDiff rendering supported). OutputsRoot includes workspace-latest pointers (`RoutingLogIndex-latest.json`, `RoutingBundlePrimarySummary-latest.md`, `RoutingLogExplorer-latest.md`) and the review summary emits an ExplorerCommand when an index is built. | Attach the review summary JSON + output artifacts when reviewing offline bundles end-to-end. |
| Session wrap | `docs/CODEX_SESSION_CHECKLIST.md` + CLI summary | Use at the end of every run to ensure plan/backlog/task board/session log updates are complete. | CLI summary references plan/backlog IDs + telemetry artifacts. |

## Validation checklist
1. **Commands executed** - capture the exact command (with parameters) per task.
2. **Telemetry saved** - drop JSON/CSV outputs under `Logs/` (already ignored) and reference them in docs.
3. **Docs updated** - edit the relevant plan file, task board entry, and backlog row.
4. **Session logged** - add/update `docs/agents/sessions/<date>_session-XXXX.md`.
5. **Headless smoke run for new features/functions** - run the relevant headless harness (for example `Tools/Invoke-SearchAlertsSmokeTest.ps1`) and record the PassThru summary in the session log.

## Environment setup
- PowerShell 5.x (already available in the repo's target environment).
- Optional online dev mode requires `STATETRACE_AGENT_ALLOW_NET=1` and `STATETRACE_AGENT_ALLOW_INSTALL=1`, plus logging via `Tools/NetworkGuard.psm1::Invoke-AllowedDownload`.

## Offline guardrails (ST-K-004)
`Tools\Invoke-AllChecks.ps1` includes an **offline preflight** that fails fast when online mode is active:
- Asserts `STATETRACE_AGENT_ALLOW_NET` and `STATETRACE_AGENT_ALLOW_INSTALL` are unset (or `0`)
- If set, logs the reason to `Logs\Verification\OfflinePreflightFail-<timestamp>.json` and exits with reset instructions
- To reset: `pwsh Tools\Reset-OnlineModeFlags.ps1 -Reason "<task>"`
- To bypass (when online mode is intentional): `pwsh Tools\Invoke-AllChecks.ps1 -SkipOfflinePreflight`

This ensures CI/harness runs remain offline-first by default; online mode requires explicit acknowledgment.

## Troubleshooting
- If `Invoke-StateTracePipeline.ps1` fails due to history corruption, clear `Data/IngestionHistory/*.json` (back them up first) and rerun.
- For Access contention, rerun with reduced concurrency overrides (`-ThreadCeilingOverride 1 -MaxWorkersPerSiteOverride 1 -MaxConsecutiveSiteLaunchesOverride 4`) and log the difference in Plan B.

## TelemetryModule naming
- Use `Save-StTelemetryBuffer` to flush buffered telemetry; legacy `Flush-StTelemetryBuffer` remains available as an alias for compatibility but should not be used in new scripts.

## Provider probe status
- `Get-CachedDbConnection` (Modules/DeviceLogParserModule.psm1) probes ACE/Jet providers via `ADODB.Connection` and reports `Available`, `MissingProvider`, or `ProbeFailed` when selecting a provider.
- Probe cleanup errors are logged at Verbose only (search verification logs when `-VerboseParsing` is enabled).

## Scheduler vs PortBatchReady comparison
- `SchedulerVsPortDiversity-*.json` records `PortBatchUsedSynthesizedEvents`, `ComparisonMode`, `InputsAligned`, and `MismatchClassification`.
- When `PortBatchUsedSynthesizedEvents` is true, mismatch output is informational and should be logged as a synthesized comparison (not a fairness regression).

Keep this runbook short and scriptable—extend the table rather than writing prose when you add new tasks.

## Concurrency override mapping
| Override | When to use | Metrics to capture |
|----------|-------------|--------------------|
| `-ThreadCeilingOverride` / `MaxRunspaceCeiling` | Cap total runspaces for Access contention or CPU saturation investigations. | `ParseDuration` p95/max, `DatabaseWriteLatency` p95/max, `ParserSchedulerLaunch` max streak, queue delay summary. |
| `-MaxWorkersPerSiteOverride` / `MaxWorkersPerSite` | Reduce per-site parallelism to isolate site-level contention. | `ParseDuration`, `DatabaseWriteLatency`, `InterfaceSyncTiming` p95, `PortBatchReady` throughput. |
| `-MaxActiveSitesOverride` / `MaxActiveSites` | Limit cross-site concurrency to compare site fairness. | `ParserSchedulerLaunch` max streak, `PortBatchSiteDiversity` max streak, queue delay summary. |
| `-MaxConsecutiveSiteLaunchesOverride` | Test scheduler fairness limits. | `ParserSchedulerLaunch` max streak, `SchedulerVsPortDiversity` comparison. |
| `-JobsPerThreadOverride` / `JobsPerThread` | Adjust job batching pressure per runspace. | `ParseDuration`, `DatabaseWriteLatency`, `InterfaceSyncTiming` p95. |
| `-MinRunspacesOverride` / `MinRunspaceCount` | Raise the floor on concurrency for low-host runs. | `ParseDuration`, `DatabaseWriteLatency`, resolved concurrency profile snapshot. |



## Shared interface helpers
- InterfaceCommon (Modules/InterfaceCommon.psm1) exports Get-StringPropertyValue, Set-PortRowDefaults (Hostname/IsSelected defaults), Get-PortSortFallbackKey.
- Consumers: InterfaceModule, DeviceRepositoryModule, CompareViewModule, DeviceInsightsModule, ViewStateService, FilterStateModule, ParserPersistenceModule.
- Prefer these helpers over duplicating PSObject property checks or port sort fallback literals.


