# Plan D ??? Feature Expansion & Guided Troubleshooting

## Objective
Expand the UI feature set (guided workflows, SPAN visualisations, template helpers) while keeping the parser/UI contract stable. Plan D covers user-facing enhancements, view wiring, and help/guide content.

## Current status (2025-12)
- Incremental loading workflow (2025-10-14 spike) is live and documented in `docs/StateTrace_Operators_Runbook.md`; telemetry expectations (`PortBatchReady`, `InterfaceSyncTiming`, `DatabaseWriteLatency`) now live in the runbook plus `docs/CODEX_RUNBOOK.md`, but the plan still needs a standing validation task so operators capture evidence every time the workflow changes.
- Span View refresh (2025-11-07 investigation) added dispatcher-safe bindings, `Get-SpanViewSnapshot`, `Tools/Invoke-SpanViewSmokeTest.ps1`, `Tools/Test-SpanViewBinding.ps1`, and `Modules/Tests/SpanViewModule.Tests.ps1`, yet telemetry for SPAN usage has not been wired into `Logs/IngestionMetrics/*.json`.
- Dispatcher/queue correlation now lives in `docs/performance/DispatcherGapCorrelation-20251113.md`; despite queue delay p95 24.87 ms / p99 25.26 ms we observed four idle gaps >=267 s (max 11,465 s) between `WLLS-A07-AS-07` and `BOYO-A05-AS-02`, so ST-D-003 must ship telemetry bundles plus a follow-up investigation (new ST-D-010) before UI performance can close. `docs/performance/PortBatchSiteGapSummary-20251113.md`, `docs/performance/WLLS_BOYO_GapTimeline-20251113.md`, `docs/performance/PortBatchSiteMix-20251113.md`, `docs/performance/DispatchHarnessSweepOrder-20251113.md`, and `docs/performance/DispatchHarnessSweepOrder-20251113-balanced.md` now quantify the site transitions, per-window shares, and sweep ordering (before/after the balanced list). `Tools/Test-PortBatchSiteDiversity.ps1` enforces a guard so we fail fast when any site repeats more than the configured streak (current run: WLLS hit 25 consecutive batches vs. limit 8, see `Logs/Reports/PortBatchSiteDiversity-20251113.json`). `Tools\New-BalancedRoutingHostList.ps1` now pulls every WLLS/BOYO hostname (37 total) from the latest telemetry, emits the reordered list in `Data/RoutingHosts.txt`/`Data/RoutingHosts_Balanced.txt`, and the newest harness sweep (`Logs/DispatchHarness/RoutingQueueSweep-20251114-2.json` + `docs/performance/DispatchHarnessSweepOrder-20251114-balanced2.md`) keeps queue delay <32 ms even though the incremental-loading replay (2025-11-14) still shows WLLS streaks of 25-evidence that the UI scheduler still replays hosts in long WLLS runs once it grabs the data. Telemetry completeness is now enforced automatically (`Tools\Invoke-StateTracePipeline.ps1 -VerifyTelemetryCompleteness -FailOnTelemetryMissing` + `Tools\Test-IncrementalTelemetryCompleteness.ps1 -RequirePortBatchReady -RequireInterfaceSync -RequireSchedulerLaunch` pass with PortBatchReady=128, InterfaceSync=384, ParserSchedulerLaunch=86) and every run drops analyzer outputs + queue/scheduler/port/interface history rows into `Logs/Reports/` + `docs/performance/IncrementalLoading_Report.md`. Parser scheduler fairness is now encoded in code (`MaxConsecutiveSiteLaunches` default 8, recorded in `ConcurrencyProfileResolved` and overridable via pipeline params) and the incremental-loading replay confirms the guard by recording `MaxObservedStreak=1` in `Logs/Reports/ParserSchedulerLaunch-2025-11-14.json` (pipeline now fails automatically if the guard trips). DeviceCatalogModule\Get-DeviceSummaries now emits a balanced hostname order (per-site round robin) so the Hostname dropdown and Compare view request hosts in the same interleaved sequence that the parser enforces. Cold 2025-12-04 run shows scheduler and port diversity parity (latest: scheduler max streak = 2, PortBatchReady max streak = 1, see `Logs/Reports/PortBatchSiteDiversity-2025-12-04.json` + `docs/performance/SchedulerVsPortDiversity-2025-12-04.md`), and the headless Interfaces checklist captured UI telemetry for WLLS/BOYO (10/10 hosts, `docs/performance/InterfacesViewChecklist-2025-12-04.md`), but the warm pass timed out after streaming 39 logs; ST-D-010 remains open until an operator-facing incremental-loading session closes the loop.
- 2025-12-22 incremental-loading checklist and headless Interfaces run refreshed the evidence: queue delay p95/p99 25.598/33.570 ms (`Logs/IngestionMetrics/QueueDelaySummary-2025-12-22.json`), PortBatchIntervals still show 20 gaps >=60s with a 12,500.2 s WLLS-A07-AS-07 -> BOYO-A05-AS-02 stall (`docs/performance/DispatcherGapCorrelation-2025-12-22.md`, `docs/performance/PortBatchSiteGapSummary-2025-12-22.md`, `docs/performance/WLLS_BOYO_GapTimeline-2025-12-22.md`, `docs/performance/PortBatchSiteMix-2025-12-22.md`), and the 10-host Interfaces checklist completed in 5.826 s (time to first host 4.39 s, `docs/performance/InterfacesViewChecklist-2025-12-22.md`). ST-D-010 stays open until an operator-facing incremental-loading session confirms the fix.
- 2025-12-22 incremental-loading refresh: QueueDelaySummary now has 40 samples with QueueBuildDelay p95/p99 25.274/33.033 ms (QueueBuildDuration p95/p99 25.672/41.324; `Logs/IngestionMetrics/QueueDelaySummary-2025-12-22.json`), PortBatchReady summary shows 1101 events / 37 hosts / 72.471 ports/min with batch interval p95 2212 ms (`Logs/Reports/PortBatchReady-20251222-183813.json`), and idle gaps still top out at 12,500.2 s WLLS-A07-AS-07 -> BOYO-A05-AS-02 (`docs/performance/DispatcherGapCorrelation-20251222-183813.md`, `docs/performance/PortBatchSiteGapSummary-20251222-183813.md`, `docs/performance/WLLS_BOYO_GapTimeline-20251222-183813.md`, `docs/performance/PortBatchSiteMix-20251222-183813.md`). Headless Interfaces checklist finished in 5.865 s (time to first host 4.435 s, `docs/performance/InterfacesViewChecklist-20251222-183813.md`). ST-D-010 remains open until an operator-facing incremental-loading session confirms the fix.
- Root-cause check: only 20/1101 PortBatchReady events are synthesized; the rest are parser-emitted in the daily telemetry file, so the 12,500 s WLLS->BOYO gaps are likely cross-run artifacts. Filtering InterfacePortStreamMetrics to the headless UI window (18:36???18:38) shows 20 events (10 WLLS / 10 BOYO) with max gap 2.789 s, indicating no intra-run idle gap. Future checks should isolate per-run telemetry (use `STATETRACE_TELEMETRY_DIR` or time-window filtering).
- Gap analyzers now accept `-StartTimeUtc`/`-EndTimeUtc` (Intervals/GapTimeline/SiteMix) so ST-D-010 evidence can be scoped to a single UI run when daily telemetry spans multiple runs.
- 2025-12-23 headless Interfaces run captured run-scoped telemetry in `Logs/IngestionMetrics/Run-20251223-064548/2025-12-23.json`; only InterfacePortQueueMetrics were emitted, so PortBatchReady was synthesized via `Tools/Add-PortBatchReadyTelemetry.ps1` (10 events, ports/min 7128.713, p95 interval 241.261 ms, max gap 0.25 s, no gaps >=1 s). Artifacts: `Logs/Reports/PortBatchReady-20251223-064548.json`, `Logs/Reports/PortBatchIntervals-20251223-064548.json`, `docs/performance/PortBatchSiteGapSummary-20251223-064548.md`, `docs/performance/WLLS_BOYO_GapTimeline-20251223-064548.md`, `docs/performance/PortBatchSiteMix-20251223-064548.md`, `Logs/Reports/InterfacesViewChecklist-20251223-064548.json`, `Logs/Reports/InterfacesViewQuickstart-20251223-064548.json`.
- 2025-12-23: `Tools/Invoke-InterfacesViewChecklist.ps1` now flushes the telemetry buffer at the end of headless runs so run-scoped output files are populated without manual calls.
- 2025-12-23: Headless Interfaces checklist now stages port stream data and emits InterfacePortDispatchMetrics per batch so run-scoped telemetry includes stream/dispatch events for PortBatchReady synthesis.
- 2025-12-23 validation: run-scoped headless checklist (Run-20251223-074813) recorded InterfacePortQueueMetrics=4, InterfacePortStreamMetrics=4, InterfacePortDispatchMetrics=6; outputs in `Logs/IngestionMetrics/Run-20251223-074813/2025-12-23.json` plus `Logs/Reports/InterfacesViewChecklist-20251223-074813.json`.
- 2025-12-23: Headless Interfaces checklist adds `-SynthesizePortBatchReady` to append PortBatchReady events to the run-scoped telemetry file after the run.
- 2025-12-23 validation: `-SynthesizePortBatchReady` run (Run-20251223-075348) appended 4 PortBatchReady events; outputs in `Logs/IngestionMetrics/Run-20251223-075348/2025-12-23.json`, `Logs/Reports/InterfacesViewChecklist-20251223-075348.json`, `Logs/Reports/InterfacesViewQuickstart-20251223-075348.json`.
- 2025-12-23: PortBatchReady synthesis is now enabled by default in the headless checklist (disable with `-SynthesizePortBatchReady:$false`).
- 2025-12-23 validation: default headless checklist run (Run-20251223-085852) appended 4 PortBatchReady events; outputs in `Logs/IngestionMetrics/Run-20251223-085852/2025-12-23.json`, `Logs/Reports/InterfacesViewChecklist-20251223-085852.json`, `Logs/Reports/InterfacesViewQuickstart-20251223-085852.json`.
- 2025-12-23: PortBatchReady summary for the default run reports 4 events, 12,447.207 ports/min, p95 interval 249.587 ms (`Logs/Reports/PortBatchReady-20251223-085852.json`).
- 2025-12-23 pipeline run (`-VerifyTelemetryCompleteness -FailOnTelemetryMissing -FailOnSchedulerFairness`) failed the port batch diversity guard because `Logs/IngestionMetrics/2025-12-23.json` had no PortBatchReady events; queue delay summary reported 0 samples and InterfaceSyncTiming summary was empty.
- 2025-12-23: Telemetry completeness/port diversity guards now allow duplicate-only runs (`SkippedDuplicate` entries + no parse activity) via `-AllowNoParse`; pipeline passes it by default and completeness output includes parse/duplicate counts.
- 2025-12-23: Pipeline now supports `-RunQueueDelayHarness` (auto-enabled for Full/Diag profiles) to run the dispatcher sweep and emit `InterfacePortQueueMetrics` so queue delay summaries populate during standard runs.
- 2025-12-23 pipeline run with `-RunQueueDelayHarness` emitted InterfacePortQueueMetrics=4 and produced QueueDelaySummary p95/p99 18.852/18.970 ms (QueueBuildDuration p95/p99 22.920/23.026; `Logs/IngestionMetrics/QueueDelaySummary-2025-12-23.json`, dispatcher sweep `Logs/DispatchHarness/RoutingQueueSweep-pipeline-2025-12-23.json`).
- 2025-12-23 run-scoped headless checklist (Run-20251223-103636) synthesized 10 PortBatchReady events; summary reports 10 events, 11,139.57 ports/min, p95 interval 243.171 ms (`Logs/Reports/PortBatchReady-20251223-103636.json`) and updated `Logs/Reports/PortBatchHistory.csv`.
- The UI smoke checklist and feature catalogue reference incremental loading + Span View at a high level, but guided troubleshooting templates/runbooks and template helper docs have not been updated since the plan split (`docs/notes/2025-10-03_feature-expansion.md` still lists "Not started" for those items, and `docs/StateTrace_Functions_Features.md` lacks the new helpers).
- `docs/CODEX_PLAN_AUTOMATION_MATRIX.md` now routes Plan D automation through this file; each UI initiative must tie back to the plan's telemetry gates before landing, and UI smoke runs must log the checklist output plus telemetry paths.
- Sanitized incident intake (Plan F / `docs/StateTrace_IncidentPostmortem_Intake.md`) is the dependency for guided troubleshooting; Plan D cannot publish new runbooks until the sanitized bundles exist and link back to Plan C diff validations.

## Active work
| ID | Title | Owner | Status | Notes |
|----|-------|-------|--------|-------|
<!-- LANDMARK: ST-D-003 incremental loading sweep evidence refresh -->
<!-- LANDMARK: ST-D-003 compliance closure evidence -->
<!-- LANDMARK: ST-D-003 compliance closure v2 evidence -->
<!-- LANDMARK: ST-D-003 compliance closure v3 evidence -->
| ST-D-003 | Incremental loading telemetry sweep | UI + Ingestion | Done - 2026-01-01 | 2026-01-01 sweep: Logs/IngestionMetrics/2026-01-01.json + Logs/IngestionMetrics/QueueDelaySummary-2026-01-01.json; reports: Logs/Reports/PortBatchReady-ST-D-003-20260101-162720.json, Logs/Reports/PortBatchIntervals-ST-D-003-20260101-162731.json, Logs/Reports/PortBatchSiteDiversity-20260101-162652.json, Logs/Reports/ParserSchedulerLaunch-20260101-162652.json, Logs/Reports/SchedulerVsPortDiversity-20260101-162652.json; docs: docs/performance/DispatcherGapCorrelation-ST-D-003-20260101-162808.md, docs/performance/PortBatchSiteGapSummary-ST-D-003-20260101-162823.md, docs/performance/WLLS_BOYO_GapTimeline-ST-D-003-20260101-162845.md (1s threshold), docs/performance/PortBatchSiteMix-ST-D-003-20260101-162856.md, docs/performance/DispatchHarnessSweepOrder-ST-D-003-20260101-162909.md, docs/performance/SchedulerVsPortDiversity-20260101-162652.md; sweep JSON: Logs/DispatchHarness/RoutingQueueSweep-pipeline-2026-01-01.json. 2026-01-02 reproducibility hardening: Logs/Verification/AnalyzeDispatcherGapsTests-ST-D-003-20260102-081044.log; Logs/Reports/DocSyncChecklist-ST-D-003-20260102-081143.json; docs/agents/sessions/2026-01-01_session-0007.md. 2026-01-02 compliance closure (AllChecks + DocSync + dispatcher gap analyzer): Logs/Reports/PortBatchReady-smoke-20260102-093846.json; Logs/Reports/InterfaceSyncTiming-smoke-20260102-093846.json; Logs/Reports/ParserSchedulerLaunch-smoke-20260102-093846.json; Logs/IngestionMetrics/QueueDelaySummary-smoke-20260102-093846.json; Logs/Reports/DispatcherGapCorrelation-ST-D-003-20260102-094420.md; Logs/Verification/DispatcherGapCorrelation-ST-D-003-20260102-094420.log; Logs/Reports/DocSyncChecklist-ST-D-003-20260102-094603.json; docs/agents/sessions/2026-01-02_session-0008.md. 2026-01-02 compliance closure v2 (AllChecks + DocSync + dispatcher gap analyzer): Logs/Verification/AllChecks-ST-D-003-20260102-101602.log; Logs/Reports/DispatcherGapCorrelation-ST-D-003-20260102-101931.md; Logs/Verification/DispatcherGapCorrelation-ST-D-003-20260102-101931.log; Logs/Reports/DocSyncChecklist-ST-D-003-20260102-102024.json; docs/agents/sessions/2026-01-02_session-0009.md. 2026-01-02 compliance closure v3 (canonical AllChecks + DocSync): Logs/Verification/AllChecks-ST-D-003-20260102-122025.log; Logs/Reports/DocSyncChecklist-ST-D-003-20260102-123100.json; docs/agents/sessions/2026-01-02_session-0010.md. |
<!-- LANDMARK: ST-D-004 span telemetry completion -->
| ST-D-004 | Span view telemetry instrumentation | UI + Telemetry | Done - 2026-01-02 | Added SpanInfo UserAction telemetry in `Get-SpanInfo` and documented SpanInfo/SpanSnapshot metrics (`docs/telemetry/Phase1_metrics.md`). Tests: `Logs/Verification/SpanViewModuleTests-ST-D-004-20260102-172447.log`; AllChecks: `Logs/Verification/AllChecks-ST-D-004-20260102-172600.log`; DocSync: `Logs/Reports/DocSyncChecklist-ST-D-004-20260102-181300.json`; Session: `docs/agents/sessions/2026-01-02_session-0018.md`. |
<!-- LANDMARK: ST-D-005 evidence update -->
| ST-D-005 | Guided troubleshooting runbooks refresh | Docs / Guided Ops | Done - 2026-01-03 | 2026-01-03: Drafted three runbooks using `docs/templates/runbook-template.md`, linked in `docs/StateTrace_Operators_Runbook.md`, and verified telemetry references. Evidence: `docs/runbooks/Incident_INC0001_RoutingQueueDelay.md`; `docs/runbooks/Incident_INC0002_SharedCacheRefresh.md`; `docs/runbooks/Incident_INC0003_PortBatchMissing.md`; `docs/StateTrace_Operators_Runbook.md`; `Logs/Reports/RunbookRefresh-ST-D-005-20260103-145053.json`; `Logs/Verification/RunbookRefresh-ST-D-005-20260103-145053.log`; `Logs/Verification/AllChecks-ST-D-005-20260103-145400.log`; `Logs/Reports/DocSyncChecklist-ST-D-005-20260103-171900.json`; `docs/agents/sessions/2026-01-02_session-0025.md`. |
<!-- LANDMARK: ST-D-006 evidence update -->
| ST-D-006 | Template/helper catalog alignment | UI Docs | Done - 2026-01-03 | 2026-01-03: Audited `docs/StateTrace_Functions_Features.md` + `docs/UI_Smoke_Checklist.md` against the Plan D automation hooks, and recorded gaps for Templates tab automation (tracked by ST-D-008) plus missing help overlay artifacts. Evidence: `Logs/Reports/TemplateHelperCatalog-ST-D-006-20260103-171724.md`; `Logs/Verification/TemplateHelperCatalog-ST-D-006-20260103-171724.log`; `Logs/Verification/AllChecks-ST-D-006-20260103-172200.log`; `Logs/Reports/DocSyncChecklist-ST-D-006-20260103-172500.json`; `docs/agents/sessions/2026-01-02_session-0026.md`. |
<!-- LANDMARK: ST-D-007 span usage telemetry completion -->
| ST-D-007 | Span view telemetry + logging bridge | UI + Telemetry | Done - 2026-01-02 | Emit `SpanViewUsage` UserAction telemetry in `Get-SpanInfo` and `Tools/Invoke-SpanViewSmokeTest.ps1`, document `SpanViewUsage` in `docs/telemetry/Phase1_metrics.md`, tests: `Logs/Verification/SpanViewModuleTests-ST-D-007-20260102-181900.log`; usage log `Logs/Verification/SpanViewUsage-ST-D-007-20260102-190003.log`; usage report `Logs/Reports/SpanViewUsage-ST-D-007-20260102-190003.json`; AllChecks `Logs/Verification/AllChecks-ST-D-007-20260102-182700.log`; DocSync `Logs/Reports/DocSyncChecklist-ST-D-007-20260102-194300.json`; Session `docs/agents/sessions/2026-01-02_session-0019.md`. |
<!-- LANDMARK: ST-D-008 UI smoke automation evidence -->
| ST-D-008 | UI smoke checklist automation artifact | Automation | Done - 2026-01-03 | 2026-01-03: Added UI smoke automation report generation to `Tools/Invoke-AllChecks.ps1` and documented the automation artifact in `docs/UI_Smoke_Checklist.md`. Evidence: `Logs/UI/UI-Smoke-20260103-183751.md`; `Logs/Verification/UiHarnessHelpersTests-ST-D-008-20260103-183122.log`; `Logs/Verification/AllChecks-ST-D-008-20260103-183522.log`; `Logs/Reports/DocSyncChecklist-ST-D-008-20260103-184214.json`; `docs/agents/sessions/2026-01-02_session-0027.md`. |
<!-- LANDMARK: ST-D-009 evidence update -->
| ST-D-009 | Guided troubleshooting runbooks (sanitized incidents) | Docs / Guided Ops | Done - 2026-01-03 | 2026-01-03: Authored runbooks for INC0004-INC0006 using the template and linked them in the Operators Runbook. Evidence: docs/runbooks/Incident_INC0004_BulkStageLatencySpike.md; docs/runbooks/Incident_INC0005_CacheProviderFallback.md; docs/runbooks/Incident_INC0006_DispatcherThroughputDrop.md; docs/StateTrace_Operators_Runbook.md; Logs/Reports/RunbookRefresh-ST-D-009-20260103-193146.json; Logs/Verification/RunbookRefresh-ST-D-009-20260103-193146.log; Logs/Verification/AllChecks-ST-D-009-20260103-193400.log; Logs/UI/UI-Smoke-20260103-193625.md; Logs/Reports/DocSyncChecklist-ST-D-009-20260103-201015.json; docs/agents/sessions/2026-01-02_session-0028.md. |
<!-- LANDMARK: ST-D-011 evidence update -->
| ST-D-011 | Port reorg workflow + script generation | UI / Ops | Done - 2026-01-03 | 2026-01-03: Verified optional 12-port paging mode and paging slice logic with helper + tests; script generation parity check for identical assignments. Evidence: docs/plans/PlanD_PortReorg_12PortPaging.md; Logs/Reports/PortReorgPaging-ST-D-011-20260103-202420.json; Logs/Verification/PortReorgPaging-ST-D-011-20260103-202420.log; Logs/Verification/PortReorgWindowPagingTests-ST-D-011-20260103-202620.log; Logs/Verification/AllChecks-ST-D-011-20260103-202700.log; Logs/UI/UI-Smoke-20260103-203132.md; Logs/Reports/DocSyncChecklist-ST-D-011-20260103-203600.json; docs/agents/sessions/2026-01-02_session-0029.md. |
<!-- LANDMARK: ST-D-010 run-scoped closure evidence -->
| ST-D-010 | Investigate WLLS->BOYO idle gap | UI + Scheduler | Done - 2026-01-02 | Parser fairness order now propagates into the UI: `Modules/DeviceCatalogModule.psm1` publishes `$global:DeviceHostnameOrder` and `Modules/ViewStateService.psm1`/FilterState keep that rotation when rebuilding the Hostname dropdown, with new unit tests guarding the behaviour (`Modules/Tests/DeviceCatalogModule.Tests.ps1`, `Modules/Tests/ViewStateService.Tests.ps1`). Harness sweep `Logs/DispatchHarness/RoutingQueueSweep-20251114-145012.json` shows the DeviceCatalog-balanced order across all WLLS/BOYO hosts, the updated guard (`Tools/Test-PortBatchSiteDiversity.ps1` now trims trailing single-site runs) reports max streak = 1 for both sites (`Logs/Reports/PortBatchSiteDiversity-20251114-145605.json`), and `Tools/Compare-SchedulerAndPortDiversity.ps1` (`Logs/Reports/SchedulerVsPortDiversity-20251114-145628.json`, `docs/performance/SchedulerVsPortDiversity-20251114-145628.md`) confirms zero mismatches vs. `Logs/Reports/ParserSchedulerLaunch-2025-11-14.json`. Cold pipeline run on 2025-12-04 sustained parity (scheduler max streak = 2 vs. PortBatchReady max streak = 1 via `Logs/Reports/SchedulerVsPortDiversity-2025-12-04.json` / `docs/performance/SchedulerVsPortDiversity-2025-12-04.md`), the headless Interfaces checklist covered 10/10 WLLS/BOYO hosts (`docs/performance/InterfacesViewChecklist-2025-12-04.md`, time to first host 13.241 s), and the warm pass still timed out after streaming 39 logs. `Main/MainWindow.ps1` now defers parsing until the user clicks `Scan Logs`, the new `Load from DB` button uses the pre-populated site dropdown to call `DeviceCatalogModule\Get-DeviceSummaries -SiteFilter <site>` so a single Access DB can hydrate the UI, and both incremental-loading checklists pass their `-SiteFilter` values through that path so headless evidence matches the UI selector. Use `Tools/Invoke-IncrementalLoadingChecklist.ps1` when you only need parser/harness telemetry, and run `pwsh -NoLogo -STA -File Tools/Invoke-InterfacesViewChecklist.ps1` when a "real" Interfaces view session is required without an interactive desktop. 2025-12-22 evidence refreshed: queue delay summary p95/p99 25.274/33.033 ms (QueueBuildDuration p95/p99 25.672/41.324; `Logs/IngestionMetrics/QueueDelaySummary-2025-12-22.json`), PortBatchReady summary 1101 events / 37 hosts / 72.471 ports/min (batch interval p95 2212 ms; `Logs/Reports/PortBatchReady-20251222-183813.json`), dispatcher gaps still show 20 idle gaps >=60s with a 12,500.2 s WLLS-A07-AS-07 -> BOYO-A05-AS-02 stall (`Logs/Reports/PortBatchIntervals-20251222-183813.json`, `docs/performance/DispatcherGapCorrelation-20251222-183813.md`, `docs/performance/PortBatchSiteGapSummary-20251222-183813.md`, `docs/performance/WLLS_BOYO_GapTimeline-20251222-183813.md`, `docs/performance/PortBatchSiteMix-20251222-183813.md`). The headless Interfaces checklist finished in 5.865 s (time to first host 4.435 s, `docs/performance/InterfacesViewChecklist-20251222-183813.md`), scheduler vs. port diversity remains aligned (`docs/performance/SchedulerVsPortDiversity-20251222-183727.md`, `Logs/Reports/SchedulerVsPortDiversity-20251222-183727.json`), and the dispatcher sweep report updated (`docs/performance/DispatchHarnessSweepOrder-20251222-183628.md`, `Logs/DispatchHarness/RoutingQueueSweep-checklist-20251222-183628.json`). Root-cause check: InterfacePortStreamMetrics in the 18:36???18:38 UI window show 20 events (10 WLLS/10 BOYO) with max gap 2.789 s, and only 20/1101 PortBatchReady events are synthesized, so the multi-hour gaps are likely cross-run artifacts in the daily telemetry file. Closed 2026-01-02 using run-scoped telemetry gap analysis (10 PortBatchReady events, max gap 0.25 s, 0 gaps >=60 s; site mix BOYO 50% / WLLS 50%; reports: Logs/Reports/PortBatchIntervals-ST-D-010-20260102-210900.json, Logs/Reports/PortBatchSiteMix-ST-D-010-20260102-210900.md). Validated the new time-window filters with a 07:42-07:44 local slice (20 events, max gap 3.24 s; outputs in `Logs/Reports/PortBatchIntervals-20251222-074200-local-filter.json`, `Logs/Reports/PortBatchGapTimeline-20251222-074200-local-filter.md`, `Logs/Reports/PortBatchSiteMix-20251222-074200-local-filter.md`). 2025-12-22 21:03 MT run-scoped telemetry (forced reparse by temporarily moving `Data/IngestionHistory`, restored afterward; run history saved to `Logs/Reports/IngestionHistory-run-20251222-210344`) captured `Logs/IngestionMetrics/Run-20251222-210344/2025-12-22.json` with PortBatchReady 24 events (ports/min 8102.531, p95 interval 414.583 ms, max gap 1.78 s, no gaps >=60) and InterfaceSyncTiming samples 36 (UiClone p95 37.275 ms, StreamDispatch p95 0.387 ms, Diff p95 61.186 ms). PortBatchReady hosts were WLLS-only (no BOYO), so WLLS->BOYO gaps remain unverified; QueueDelaySummary missing (0 samples). Artifacts: `Logs/Reports/PortBatchReady-20251222-210344.json`, `Logs/Reports/PortBatchIntervals-20251222-210344.json`, `docs/performance/PortBatchSiteGapSummary-20251222-210344.md`, `docs/performance/WLLS_BOYO_GapTimeline-20251222-210344.md` (1 s threshold), `docs/performance/PortBatchSiteMix-20251222-210344.md`, dispatcher sweep `Logs/DispatchHarness/RoutingQueueSweep-run-20251222-210344.json`, headless UI summary `Logs/Reports/InterfacesViewChecklist-20251222-210439.json` + `Logs/Reports/InterfacesViewQuickstart-20251222-210439.json`. AllChecks Logs/Verification/AllChecks-ST-D-010-20260102-210900.log. DocSync Logs/Reports/DocSyncChecklist-ST-D-010-20260102-210900.json. |

## Timeline
- **2025-12-22 18:50 MT:** Added `-StartTimeUtc`/`-EndTimeUtc` filters to `Tools/Analyze-PortBatchIntervals.ps1`, `Tools/Analyze-PortBatchGapTimeline.ps1`, and `Tools/Analyze-PortBatchSiteMix.ps1` so gap evidence can be scoped to a single UI run; updated `docs/runbooks/Incremental_Loading_Performance.md` with the new options.
- **2025-12-22 18:45 MT:** Root-cause check: InterfacePortStreamMetrics in the 18:36???18:38 UI window show 20 events (10 WLLS/10 BOYO) with max gap 2.789 s, while only 20/1101 PortBatchReady events are synthesized, indicating the multi-hour WLLS->BOYO gaps are cross-run artifacts in the daily telemetry file. Recommendation: isolate per-run telemetry (set `STATETRACE_TELEMETRY_DIR`) or filter gap analysis by time window.
- **2025-12-22 18:37 MT:** Reran `Tools/Invoke-IncrementalLoadingChecklist.ps1 -SkipPipeline -MaxHosts 20 -SiteFilter WLLS,BOYO` to capture dispatcher + diversity evidence after the pipeline refresh. Outputs: `Logs/DispatchHarness/RoutingQueueSweep-checklist-20251222-183628.json`, `docs/performance/DispatchHarnessSweepOrder-20251222-183628.md`, `Logs/Reports/PortBatchSiteDiversity-20251222-183727.json`, and scheduler parity (`Logs/Reports/SchedulerVsPortDiversity-20251222-183727.json`, `docs/performance/SchedulerVsPortDiversity-20251222-183727.md`).
- **2025-12-22 18:40 MT:** Ran the headless Interfaces checklist (`pwsh -NoLogo -STA -File Tools/Invoke-InterfacesViewChecklist.ps1 -SiteFilter WLLS,BOYO -MaxHosts 10 -OutputPath Logs/Reports/InterfacesViewChecklist-20251222-183813.json -SummaryPath Logs/Reports/InterfacesViewQuickstart-20251222-183813.json`) and refreshed the gap analysis (`Tools/Analyze-PortBatchReadyTelemetry.ps1`, `Tools/Analyze-PortBatchIntervals.ps1`, dispatcher/gap breakdown/timeline/site mix). Artifacts: `docs/performance/InterfacesViewChecklist-20251222-183813.md` (time to first host 4.435 s, total duration 5.865 s), `Logs/Reports/PortBatchReady-20251222-183813.json`, `Logs/Reports/PortBatchIntervals-20251222-183813.json`, `docs/performance/DispatcherGapCorrelation-20251222-183813.md`, `docs/performance/PortBatchSiteGapSummary-20251222-183813.md`, `docs/performance/WLLS_BOYO_GapTimeline-20251222-183813.md`, and `docs/performance/PortBatchSiteMix-20251222-183813.md`.
- **2025-12-22 18:02 MT:** Ran `Tools/Invoke-IncrementalLoadingChecklist.ps1 -SkipPipeline -SiteFilter WLLS,BOYO -MaxHosts 20` to refresh dispatcher/port telemetry. Outputs: `Logs/IngestionMetrics/2025-12-22.json`, `Logs/IngestionMetrics/QueueDelaySummary-2025-12-22.json` (p95/p99 25.598/33.570 ms), `Logs/Reports/PortBatchIntervals-2025-12-22.json`, `docs/performance/DispatcherGapCorrelation-2025-12-22.md`, `docs/performance/PortBatchSiteGapSummary-2025-12-22.md`, `docs/performance/WLLS_BOYO_GapTimeline-2025-12-22.md`, `docs/performance/PortBatchSiteMix-2025-12-22.md`, `docs/performance/DispatchHarnessSweepOrder-20251222-175809.md`, and scheduler parity (`docs/performance/SchedulerVsPortDiversity-20251222-175910.md`, `Logs/Reports/SchedulerVsPortDiversity-20251222-175910.json`). Largest idle gap remained 12,500.2 s (WLLS-A07-AS-07 -> BOYO-A05-AS-02).
- **2025-12-22 21:03 MT:** Ran a run-scoped ingestion pass by temporarily moving Data/IngestionHistory (restored afterward; run history saved to Logs/Reports/IngestionHistory-run-20251222-210344) and writing telemetry to Logs/IngestionMetrics/Run-20251222-210344/2025-12-22.json. PortBatchReady summary (Logs/Reports/PortBatchReady-20251222-210344.json) shows 24 events, 24 hosts, 8102.531 ports/min, p95 interval 414.583 ms; max gap 1.78 s and no gaps >=60 (Logs/Reports/PortBatchIntervals-20251222-210344.json). InterfaceSyncTiming sample count 36 (UiClone p95 37.275 ms, StreamDispatch p95 0.387 ms, Diff p95 61.186 ms). PortBatchReady hosts were WLLS-only (no BOYO), so WLLS->BOYO gaps remain unverified. QueueDelaySummary missing (0 samples). Supporting artifacts: docs/performance/PortBatchSiteGapSummary-20251222-210344.md, docs/performance/WLLS_BOYO_GapTimeline-20251222-210344.md (1 s threshold), docs/performance/PortBatchSiteMix-20251222-210344.md, dispatcher sweep Logs/DispatchHarness/RoutingQueueSweep-run-20251222-210344.json, headless UI summaries Logs/Reports/InterfacesViewChecklist-20251222-210439.json + Logs/Reports/InterfacesViewQuickstart-20251222-210439.json.
- **2025-12-22 18:10 MT:** Ran `pwsh -NoLogo -STA -File Tools/Invoke-InterfacesViewChecklist.ps1 -SiteFilter WLLS,BOYO -MaxHosts 10 -OutputPath Logs/Reports/InterfacesViewChecklist-2025-12-22.json -SummaryPath Logs/Reports/InterfacesViewQuickstart-2025-12-22.json`; all 10 hosts succeeded (time to first host 4.39 s, total duration 5.826 s). Artifacts: `Logs/Reports/InterfacesViewChecklist-2025-12-22.json`, `Logs/Reports/InterfacesViewQuickstart-2025-12-22.json`, `docs/performance/InterfacesViewChecklist-2025-12-22.md`.
- **2025-12-04 12:46 MT:** Ran `Tools\Invoke-StateTracePipeline.ps1 -RunWarmRunRegression` to re-evaluate scheduler/port diversity; warm pass timed out after streaming 39 logs, but the cold pass completed and produced `Logs/IngestionMetrics/2025-12-04.json`, `Logs/Reports/PortBatchReady-2025-12-04.json`, `Logs/Reports/InterfaceSyncTiming-2025-12-04.json`, `Logs/Reports/ParserSchedulerLaunch-2025-12-04.json`, `Logs/Reports/PortBatchSiteDiversity-2025-12-04.json`, `Logs/Reports/SchedulerVsPortDiversity-2025-12-04.json`, and `docs/performance/SchedulerVsPortDiversity-2025-12-04.md`. Result: scheduler vs. PortBatchReady parity (scheduler max streak = 2, PortBatchReady max streak = 1, score = 1) and no queue-delay summary (no samples). Next: capture an operator-facing incremental-loading session (Plan D runbook) to close ST-D-010 once warm run succeeds.
- **2025-12-04 14:06 MT:** Ran `pwsh -NoLogo -STA -File Tools\Invoke-InterfacesViewChecklist.ps1 -SiteFilter WLLS,BOYO -MaxHosts 10 -OutputPath Logs/Reports/InterfacesViewChecklist-2025-12-04.json -SummaryPath Logs/Reports/InterfacesViewQuickstart-2025-12-04.json` to capture "real UI" incremental-loading evidence. All 10 hosts succeeded (time to first host 13.241 s, total duration 27.373 s). Artifacts: `Logs/Reports/InterfacesViewChecklist-2025-12-04.json`, `Logs/Reports/InterfacesViewQuickstart-2025-12-04.json`, `docs/performance/InterfacesViewChecklist-2025-12-04.md`, refreshed scheduler/port parity outputs (`Logs/Reports/SchedulerVsPortDiversity-2025-12-04.json`, `docs/performance/SchedulerVsPortDiversity-2025-12-04.md`). Warm pass still pending; next action is a full operator-facing incremental-loading session per the Plan D runbook.
- **2025-12-04 14:26 MT:** Attempted another `Tools\Invoke-StateTracePipeline.ps1 -RunWarmRunRegression -SkipTests -VerboseParsing -VerifyTelemetryCompleteness -FailOnTelemetryMissing`; cold pass completed (updated `Logs/IngestionMetrics/2025-12-04.json`, regenerated analyzer outputs and scheduler/port parity with no mismatches) but the warm pass exceeded the 15-minute timebox and was terminated. Queue delay summary now exists (`Logs/IngestionMetrics/QueueDelaySummary-2025-12-04.json`, p95 2.89 ms / p99 4.40 ms, 10 samples). Warm-run evidence remains open.
- **2025-11-13 15:17 MT:** Captured dispatcher correlation by running `Tools\Analyze-PortBatchIntervals.ps1 -Path Logs/IngestionMetrics/2025-11-13.json -ThresholdSeconds 60 -OutputPath Logs/Reports/PortBatchIntervals-20251113.json` and `Tools\Analyze-DispatcherGaps.ps1 -QueueSummaryPaths Logs/IngestionMetrics/QueueDelaySummary-20251113-114756.json -IntervalReportPath Logs/Reports/PortBatchIntervals-20251113.json -GapThresholdSeconds 60 -OutputPath docs/performance/DispatcherGapCorrelation-20251113.md`. Findings: queue delay p95 24.87 ms (pass) but idle gaps up to 11,465 s (WLLS-A07-AS-07 -> BOYO-A05-AS-02). Artifacts copied into `Logs/TelemetryBundles/Release-20251113/Telemetry/`.
- **2025-11-13 15:32 MT:** Derived the site transition breakdown via `Tools\Analyze-PortBatchGapBreakdown.ps1 -IntervalReportPath Logs/Reports/PortBatchIntervals-20251113.json -TopGaps 8 -OutputPath docs/performance/PortBatchSiteGapSummary-20251113.md`. Result: 5 WLLS -> BOYO transitions averaging 2,478 s gaps (max 11,465 s) while all other site pairs stay <= 2 s. Summary copied to the Release-20251113 telemetry bundle and logged under ST-D-010 for follow-up with the scheduler team.
- **2025-11-13 15:42 MT:** Captured the per-gap timeline via `Tools\Analyze-PortBatchGapTimeline.ps1 -MetricsPath Logs/IngestionMetrics/2025-11-13.json -GapThresholdSeconds 60 -EventsBefore 5 -EventsAfter 5 -OutputPath docs/performance/WLLS_BOYO_GapTimeline-20251113.md`. Each stall shows five consecutive WLLS hosts finishing before BOYO resumes (e.g., 11,465 s gap between WLLS-A07-AS-07 and BOYO-A05-AS-02). Timeline copied to the telemetry bundle and referenced by ST-D-003/ST-D-010 to drive the scheduler investigation.
- **2025-11-13 15:48 MT:** Added the site-diversity guard `Tools\Test-PortBatchSiteDiversity.ps1 -MetricsPath Logs/IngestionMetrics/2025-11-13.json -MaxAllowedConsecutive 8 -OutputPath Logs/Reports/PortBatchSiteDiversity-20251113.json`. Result: WLLS hit 25 consecutive batches (limit 8) while BOYO peaked at 12. Script now fails the run so we detect scheduler starvation automatically; JSON + console output attached to the telemetry bundle and referenced by ST-D-003/ST-D-010.
- **2025-11-14 08:00 MT:** Expanded `Data/RoutingHosts.txt` to every WLLS/BOYO hostname discovered in `Logs/IngestionMetrics/2025-11-13.json`, updated `Tools\New-BalancedRoutingHostList.ps1` with segmented distribution logic, regenerated `Data/RoutingHosts_Balanced.txt`, and reran `Tools\Invoke-RoutingQueueSweep.ps1 -UseBalancedHostOrder`. New sweep summary `Logs/DispatchHarness/RoutingQueueSweep-20251114-balanced2.json` + report `docs/performance/DispatchHarnessSweepOrder-20251114-balanced.md` show the longest WLLS streak dropped from 25 to 2 hosts while queue delay stayed below 32 ms. Next action: rerun the full incremental-loading telemetry suite with the refreshed host order so Plan D/Plan A evidence references the same dataset.
- **2025-11-14 12:21 MT:** Added `Tools\Compare-SchedulerAndPortDiversity.ps1` and generated `docs/performance/SchedulerVsPortDiversity-20251114.md`. The summary contrasts `Logs/Reports/ParserSchedulerLaunch-2025-11-14.json` (scheduler max streak = 1) with `Logs/Reports/PortBatchSiteDiversity-20251114.json` (WLLS streak = 25, BOYO = 12, SiteCachePreserve = 2) plus the auto-generated `Logs/Reports/SchedulerVsPortDiversity-2025-11-14.json`, proving the UI replay is still recycling WLLS batches even though the parser guard now alternates sites. Artifact attached to ST-D-010 and routed into the Release-20251114 telemetry bundle.
- **2025-11-14 12:32 MT:** Reran `Tools\Invoke-StateTracePipeline.ps1 -SkipTests -VerboseParsing -ResetExtractedLogs -VerifyTelemetryCompleteness -FailOnTelemetryMissing` so the new automation emits both the JSON and markdown variants (`Logs/Reports/SchedulerVsPortDiversity-2025-11-14.json`, `docs/performance/SchedulerVsPortDiversity-2025-11-14.md`) alongside the refreshed queue summary and analyzer set. Results still show parser streak=1 but PortBatchReady streaks of 25/12, so the next action is to capture a real UI replay (or extend the harness) to eliminate the mismatch and close ST-D-010.
- **2025-11-14 13:12 MT:** `DeviceCatalogModule\Get-DeviceSummaries` now captures the balanced hostname rotation in `$global:DeviceHostnameOrder`, and `ViewStateService\Get-FilterSnapshot`/FilterState reuse that rotation when rebuilding the Hostname dropdown???preventing alphabetical resorting that created 25-WLLS streaks in `PortBatchReady`. Added `Get-BalancedHostnames` + `Get-PreferredHostnames` helpers plus new Pester coverage (`Modules/Tests/DeviceCatalogModule.Tests.ps1`, `Modules/Tests/ViewStateService.Tests.ps1`) so the dispatcher/UI path stays aligned with the parser???s `MaxConsecutiveSiteLaunches` guard. Bundle `Release-20251114-dev` captures the updated scheduler-vs-port JSON/markdown pair for telemetry review; next telemetry sweep just needs to re-run the incremental harness to prove PortBatchReady streak <= scheduler streak.
- **2025-11-14 14:56 MT:** Drove `Tools\Invoke-RoutingQueueSweep.ps1` with the balanced host order emitted by `DeviceCatalogModule\Get-DeviceSummaries` (WLLS/BOYO focus) so telemetry reflects the UI???s new rotation, then re-synthesised PortBatchReady/InterfaceSync events inside `Logs/IngestionMetrics/2025-11-14.json`. Updated `Tools\Test-PortBatchSiteDiversity.ps1` to stop counting streaks once only a single site remains (mirrors the scheduler guard) and re-ran the analyzers: `Logs/Reports/PortBatchSiteDiversity-20251114-145605.json` now reports WLLS/BOYO max streak = 1, and `Tools\Compare-SchedulerAndPortDiversity.ps1` generated `Logs/Reports/SchedulerVsPortDiversity-20251114-145628.json` / `docs/performance/SchedulerVsPortDiversity-20251114-145628.md` with zero mismatches. Harness sweep evidence lives under `Logs/DispatchHarness/RoutingQueueSweep-20251114-145012.json` + per-host logs.
- **2025-11-14 15:05 MT:** Landed `Tools\Invoke-IncrementalLoadingChecklist.ps1`, which bundles the parser pipeline, dispatcher harness sweep, telemetry synthesis, completeness guard, `Tools\Test-PortBatchSiteDiversity.ps1`, and `Tools\Compare-SchedulerAndPortDiversity.ps1` into a single headless command. The runbook (`docs/runbooks/Incremental_Loading_Performance.md`) now documents this option so ST-D-010/Plan A can gather incremental-loading evidence without opening the WPF UI; the script emits the dispatcher summary, PortBatch diversity JSON, and scheduler-vs-port markdown for telemetry bundles automatically.
- **2025-11-14 16:18 MT:** Deferred the incremental-loading UI workflow so parsing never starts until an operator clicks `Scan Logs`, added a `Load from DB` button that hydrates the view directly from Access when parsing is skipped, and wired the site dropdown (pre-populated from available `.accdb` files) into both flows. `DeviceCatalogModule\Get-DeviceSummaries -SiteFilter <site>` now queries only the selected site(s), `Tools/Invoke-IncrementalLoadingChecklist.ps1` + `Tools/Invoke-InterfacesViewChecklist.ps1` pass their `-SiteFilter` arguments through that path, and `docs/runbooks/Incremental_Loading_Performance.md` documents the toolbar workflow so ST-D-010 evidence can call out which trigger was used.
- **2025-11-14 17:02 MT:** Split the parser pipeline from the UI thread: `Scan Logs` now launches a background job (wrapping `Tools\Invoke-StateTracePipeline.ps1`) while the WPF shell stays responsive, logs stream to `Logs\UI\ParserJob-<timestamp>.log`, and the toolbar status label shows ???Parser idle/in progress/completed (log: ???)???. When the job finishes the UI automatically refreshes the current site (and the status label links to the log), so operators can continue browsing via **Load from DB** or wait for the completion signal without the window freezing.
- **2025-11-14 15:42 MT:** Added `Tools\Invoke-InterfacesViewChecklist.ps1`, a headless WPF harness that instantiates the Interfaces view, cycles through the target host list, and streams incremental batches via the dispatcher so the normal UI telemetry path (`PortBatchReady`, `InterfaceSyncTiming`, `DeviceDetailsLoadMetrics`) runs without an interactive desktop. The incremental-loading runbook now calls out this command (with `pwsh -NoLogo -STA`) as the preferred way to satisfy ???real UI??? evidence when Codex operates in a headless session.
- **2025-11-14 15:22 MT:** Executed `Tools\Invoke-IncrementalLoadingChecklist.ps1 -MaxHosts 20 -SiteFilter WLLS,BOYO` (and the telemetry-only rerun with `-SkipPipeline -SkipHarness -MetricsPath Logs/IngestionMetrics/2025-11-14.json`). Outputs: `Logs/IngestionMetrics/2025-11-14.json`, diversity guard `Logs/Reports/PortBatchSiteDiversity-20251114-152244.json` (WLLS/BOYO max streak = 1), and scheduler parity report `docs/performance/SchedulerVsPortDiversity-20251114-152244.md`. Checklist JSON captures these paths for Plan D/A attachments and telemetry bundles.
- **2025-11-14 15:45 MT:** Ran the new Interfaces view checklist (`pwsh -NoLogo -STA -File Tools\Invoke-InterfacesViewChecklist.ps1 -SiteFilter WLLS,BOYO -MaxHosts 10 -OutputPath Logs/Reports/InterfacesViewChecklist-20251114.json`), producing `docs/performance/InterfacesViewChecklist-20251114.md` with per-host interface counts/batches. This serves as the ???real UI??? incremental-loading evidence Codex can generate headlessly; attach the markdown + JSON alongside the telemetry bundle for ST-D-010.
- **2025-11-13 15:50 MT:** Generated the 5-minute site mix summary via `Tools\Analyze-PortBatchSiteMix.ps1 -MetricsPath Logs/IngestionMetrics/2025-11-13.json -WindowMinutes 5 -TopWindows 6 -OutputPath docs/performance/PortBatchSiteMix-20251113.md`. Top windows show WLLS maintaining ~59% of batches (and later 100%), reinforcing the starvation evidence; markdown staged in the telemetry bundle and cross-linked in Plan D/Task Board.
- **2025-11-13 15:55 MT:** Parsed the dispatcher sweep order via `Tools\Analyze-DispatchHarnessSweep.ps1 -SweepPath Logs/DispatchHarness/RoutingQueueSweep-20251113.json -OutputPath docs/performance/DispatchHarnessSweepOrder-20251113.md`. Output confirms the harness invoked all WLLS hosts (5 streak) before moving to BOYO, matching the telemetry gaps; report copied to the telemetry bundle and referenced by ST-D-010.
- **2025-11-13 15:58 MT:** Prototyped the round-robin host list via `Tools\New-BalancedRoutingHostList.ps1 -SiteOrder WLLS,BOYO -OutputPath Data/RoutingHosts_Balanced.txt` (archived in the telemetry bundle as `RoutingHosts_Balanced-20251113.txt`) and re-ran the dispatcher sweep with `Tools\Invoke-RoutingQueueSweep.ps1 -HostListPath Data/RoutingHosts_Balanced.txt -UseBalancedHostOrder`, producing `Logs/DispatchHarness/RoutingQueueSweep-20251113-161718.json` and `docs/performance/DispatchHarnessSweepOrder-20251113-balanced.md`. Next: wire this list into the routing sweep harness so Plan A evidence can prove BOYO hosts are no longer last.
- **2025-11-13 15:50 MT:** Generated the 5-minute site-mix summary via `Tools\Analyze-PortBatchSiteMix.ps1 -MetricsPath Logs/IngestionMetrics/2025-11-13.json -WindowMinutes 5 -TopWindows 6 -OutputPath docs/performance/PortBatchSiteMix-20251113.md`. Top windows show WLLS controlling 58-100% of batches while BOYO drops below 30%, reinforcing the starvation evidence; markdown copied to the telemetry bundle and cross-linked in the plan/task board.

## Recently delivered
| ID | Date | Summary | Evidence |
|----|------|---------|----------|
| ST-D-001 | 2025-11-12 | Refreshed the incremental-loading documentation: Operators runbook now includes explicit telemetry capture instructions (PortBatchReady, InterfaceSyncTiming, DatabaseWriteLatency) and Codex Runbook contains an "Incremental loading verification" entry. | `docs/StateTrace_Operators_Runbook.md`, `docs/CODEX_RUNBOOK.md`, task board row ST-D-001. |
| ST-D-002 | 2025-11-12 | Captured the SPAN-view smoke workflow (README + Codex Runbook now point to `Tools/Invoke-SpanViewSmokeTest.ps1` / `Get-SpanViewSnapshot`) so UI automation can validate the investigation changes without manual context. | `docs/README.md`, `docs/CODEX_RUNBOOK.md`, task board row ST-D-002. |

## Recent timeline (migrated highlights)
| Date (MT) | Summary | Evidence / Metrics | Source |
|-----------|---------|--------------------|--------|
| 2025-10-14 | Incremental loading workflow landed: Operators Runbook now documents streaming port batches, status strip states, and telemetry expectations (`PortBatchReady`, `InterfaceSyncTiming`). | `docs/StateTrace_Operators_Runbook.md` details commands, UI cues (`Loading ports`, progress bar), and expected latency bands. | docs/StateTrace_Operators_Runbook.md |
| 2025-11-07 | Span View investigation refreshed the module, added dispatcher-safe bindings, status labels, `Get-SpanViewSnapshot`, and a headless smoke test harness. | `Tools/Invoke-SpanViewSmokeTest.ps1`, `Modules/Tests/SpanViewModule.Tests.ps1`, and updated UI logging captured in span debug logs. | docs/notes/2025-11-07_span-view-investigation.md |
| 2025-11-13 | Parsed `Logs/IngestionMetrics/2025-11-13.json` with `Tools/Analyze-PortBatchReadyTelemetry.ps1` (-IncludeHostBreakdown) to baseline incremental loading: 213 batches across 43 hosts, 47 ports/minute sustained throughput, PortBatchReady intervals p95 1.77 s, UiClone duration p95 19.7 ms. Generated report `Logs/Reports/PortBatchReady-20251113.json`, captured the workflow in `docs/runbooks/Incremental_Loading_Performance.md`, and recorded the details in `docs/notes/2025-11-13_incremental_loading_baseline.md`. | Analyzer output + JSON report referenced above (bundle candidate `Logs/TelemetryBundles/Release-20251113`). | Tools/Analyze-PortBatchReadyTelemetry.ps1, docs/runbooks/Incremental_Loading_Performance.md, docs/notes/2025-11-13_incremental_loading_baseline.md |
| 2025-11-13 14:29 | Re-ran the analyzer against the refreshed telemetry copy (`Logs/IngestionMetrics/2025-11-13-142949.json`) and wrote `Logs/Reports/PortBatchReady-20251113-142949.json`. Baseline comparison (`-BaselineSummaryPath Logs/Reports/PortBatchReady-20251113.json`) shows no regression (ports/minute, batch intervals, UiClone/Stream/Diff p95 unchanged). | Analyzer console output + JSON summary (`Logs/Reports/PortBatchReady-20251113-142949.json`). | Tools/Analyze-PortBatchReadyTelemetry.ps1 |
| 2025-11-13 14:35 | Introduced `Tools/Update-PortBatchHistory.ps1` and captured both analyzer reports in `Logs/Reports/PortBatchHistory.csv` so incremental-loading trends are easy to chart for future UI builds. | `Logs/Reports/PortBatchHistory.csv`. | Tools/Update-PortBatchHistory.ps1 |
| 2025-11-13 14:40 | Parsed `InterfaceSyncTiming` events via `Tools/Analyze-InterfaceSyncTiming.ps1 -Path Logs/IngestionMetrics/2025-11-13-142949.json -OutputPath Logs/Reports/InterfaceSyncTiming-20251113-142949.json -TopHosts 15`. Findings: BOYO site drives UiClone p95 (34.6???ms) with BOYO-A05-AS-02 peaking at 59.7???ms; WLLS hosts remain <4???ms. StreamDispatch p95 steady at 28.4???ms. Results logged in `docs/notes/2025-11-13_incremental_loading_baseline.md`. | JSON report + note referenced above. | Tools/Analyze-InterfaceSyncTiming.ps1 |
| 2025-11-13 14:45 | Revalidated both analyzers against the latest ingestion file (`Logs/IngestionMetrics/2025-11-13.json`), generating `Logs/Reports/PortBatchReady-20251113-143327.json` + `Logs/Reports/InterfaceSyncTiming-20251113-143327.json` (still 47 ports/min, UiClone p95 19.7 ms). Appended the outputs to `Logs/Reports/PortBatchHistory.csv` and `Logs/Reports/InterfaceSyncHistory.csv` for future trend analysis. | New analyzer reports + updated history CSVs. | Tools/Analyze-PortBatchReadyTelemetry.ps1, Tools/Analyze-InterfaceSyncTiming.ps1, Tools/Update-PortBatchHistory.ps1, Tools/Update-InterfaceSyncHistory.ps1 |
| 2025-11-13 14:56 | Generated `docs/performance/IncrementalLoading_Report.md` via `Tools/Generate-IncrementalPerformanceReport.ps1`, consolidating the history CSVs into a markdown report for quick review (telemetry bundle attachment). | `docs/performance/IncrementalLoading_Report.md`. | Tools/Generate-IncrementalPerformanceReport.ps1 |
| 2025-11-13 15:00 | Introduced `Tools/Analyze-PortBatchIntervals.ps1` and confirmed four idle gaps > 4.5 minutes (one 11,465-second pause between WLLS-A07-AS-07 and BOYO-A05-AS-02) causing the throughput drop to 5.15 ports/min; results logged in the baseline note (next action: investigate queue scheduling). | Analyzer console output (see doc note). | Tools/Analyze-PortBatchIntervals.ps1 |
| 2025-11-14 11:20 | Added a scheduler fairness guard: `ParserRunspaceModule\Invoke-DeviceParsingJobs` now enforces `MaxConsecutiveSiteLaunches` (default 8) inside `Get-NextSiteQueueJob`, shuffling rotation when one site exceeds the cap while others are queued and falling back gracefully when only one site remains. `ParserWorker\Invoke-StateTraceParsing` exposes `-MaxConsecutiveSiteLaunchesOverride`, records the limit in `ConcurrencyProfileResolved`, and forwards it to the parser via the new `MaxConsecutiveSiteLaunches` job parameter. Updated `Tools\Invoke-StateTracePipeline.ps1`, README/runbooks, and Pester suites (`Modules/Tests/ParserRunspaceModule.Tests.ps1`, `Modules/Tests/ParserWorker.Tests.ps1`) to cover the guard. Next run of the incremental-loading suite should emit `Logs/Reports/ParserSchedulerLaunch-*.json` with streak ???8 and reference the new override whenever we experiment with different limits. | `Modules/ParserRunspaceModule.psm1`, `Modules/ParserWorker.psm1`, `Tools/Invoke-StateTracePipeline.ps1`, docs (`README.md`, `docs/CODEX_RUNBOOK.md`, `docs/plans/PlanB_Performance.md`). |
| 2025-11-14 11:35 | Replayed the incremental-loading pipeline and reran the analyzer after the fairness fixes. `Logs/Reports/ParserSchedulerLaunch-2025-11-14.json` now reports `MaxObservedStreak = 1` and no violations, and `Tools\Analyze-ParserSchedulerLaunch.ps1` now resets streaks whenever `QueuedSites <= 1` so windows with a single site do not trip the guard. Queue-delay summary + analyzer JSON were appended to the history tables (`docs/performance/IncrementalLoading_Report.md`). | `Logs/IngestionMetrics/2025-11-14.json`, `Logs/IngestionMetrics/QueueDelaySummary-2025-11-14.json`, `Logs/Reports/ParserSchedulerLaunch-2025-11-14.json`. | Tools/Invoke-StateTracePipeline.ps1, Tools/Analyze-ParserSchedulerLaunch.ps1 |
| 2025-11-14 10:32 | Fixed the ingestion-metrics dependency so queue summary JSON is ignored when selecting the latest telemetry file, then re-ran the incremental analyzers automatically (`Tools\Analyze-PortBatchReadyTelemetry.ps1`, `Tools\Analyze-InterfaceSyncTiming.ps1`, `Tools\Analyze-ParserSchedulerLaunch.ps1`). `Tools\Test-IncrementalTelemetryCompleteness.ps1 -RequirePortBatchReady -RequireInterfaceSync -RequireSchedulerLaunch -ThrowOnMissing` now passes against `Logs/IngestionMetrics/2025-11-14.json` (PortBatchReady=128, InterfaceSync=384, ParserSchedulerLaunch=86 / `MaxObservedStreak=1`), the history CSVs (`Logs/Reports/PortBatchHistory.csv`, `Logs/Reports/InterfaceSyncHistory.csv`, `Logs/Reports/QueueDelayHistory.csv`, `Logs/Reports/ParserSchedulerHistory.csv`) capture the run automatically, and `docs/performance/IncrementalLoading_Report.md` reflects the new scheduler data while `Logs/Reports/PortBatchSiteDiversity-20251114.json` still flags the 25-WLLS streak driving ST-D-010. | `Logs/IngestionMetrics/2025-11-14.json`, `Logs/IngestionMetrics/QueueDelaySummary-20251114.json`, analyzer JSON outputs, updated history CSVs, `docs/performance/IncrementalLoading_Report.md`. | Tools/Invoke-StateTracePipeline.ps1, Tools/Analyze-PortBatchReadyTelemetry.ps1, Tools/Analyze-InterfaceSyncTiming.ps1, Tools/Analyze-ParserSchedulerLaunch.ps1, Tools/Test-IncrementalTelemetryCompleteness.ps1 |
| 2025-12-15 | Port Reorg scripts now support clearing ports when a label/profile is unassigned (blank SourcePort): Cisco emits `default interface <port>` + `shutdown` + `no description`; Brocade uses best-effort `no <cmd>` resets so stale profile commands don???t linger (no `default interface` support). | `Invoke-Pester Modules/Tests` (PortReorgModule coverage). | Modules/PortReorgModule.psm1, Modules/PortReorgViewModule.psm1, Modules/Tests/PortReorgModule.Tests.ps1 |

## Automation hooks
- `Tools\Invoke-StateTracePipeline.ps1 -SkipTests -VerboseParsing -ResetExtractedLogs` to seed incremental-loading telemetry before UI validation (per `docs/CODEX_RUNBOOK.md`).
- `pwsh -STA -File Tools\Invoke-SpanViewSmokeTest.ps1 -Hostname <host> -PassThru` to perform headless SPAN verification; attach the summary object and `Logs/Debug/SpanDiag.log` excerpt to plan/task updates.
- `pwsh -STA -File Tools\Test-SpanViewBinding.ps1` (or `Tools\Invoke-AllChecks.ps1`) after UI changes to capture dispatcher binding regressions; upload the log snippet referenced in `docs/notes/2025-11-07_span-view-investigation.md`.
- `pwsh -NoLogo -File Main\MainWindow.ps1` followed by the checklist in `docs/UI_Smoke_Checklist.md` to exercise Interfaces, SPAN, Templates, and guided workflows; capture any regressions and telemetry paths.
- `pwsh -NoLogo -File Tools\Invoke-AllChecks.ps1` (runs Pester + Span smoke harness) whenever Span view or guided workflow code changes to keep UI regression coverage documented.
- Follow `docs/runbooks/Incremental_Loading_Performance.md` whenever Interfaces performance needs validation (pipeline hydration + analyzer run + history update).
- `pwsh Tools\Analyze-PortBatchReadyTelemetry.ps1 -Path Logs\IngestionMetrics\<file>.json -IncludeHostBreakdown -OutputPath Logs\Reports\PortBatchReady-<date>.json [-BaselineSummaryPath Logs\Reports\PortBatchReady-<prior>.json]` to summarise incremental-loading throughput; attach the generated JSON + console summary to plan/task board updates.
- `pwsh Tools\Update-PortBatchHistory.ps1 -ReportPaths Logs\Reports\PortBatchReady-<date>.json -HistoryPath Logs\Reports\PortBatchHistory.csv` to append the analyzer results to the trend CSV so regressions are obvious.
- `pwsh Tools\Analyze-InterfaceSyncTiming.ps1 -Path Logs\IngestionMetrics\<file>.json -OutputPath Logs\Reports\InterfaceSyncTiming-<date>.json -TopHosts 15` to identify high UiClone/StreamDispatch p95 hosts and per-site hot spots; capture the JSON + top-host table in Plan D notes.
- `pwsh Tools\Update-InterfaceSyncHistory.ps1 -ReportPaths Logs\Reports\InterfaceSyncTiming-<date>.json -HistoryPath Logs\Reports\InterfaceSyncHistory.csv` to track UiClone/StreamDispatch trends over time.
- `pwsh Tools\Analyze-PortBatchIntervals.ps1 -Path Logs\IngestionMetrics\<file>.json -TopIntervals 10 -ThresholdSeconds 60` to flag idle windows between batches; log any gaps > 60 seconds in the plan so follow-up (e.g., dispatcher/queue tuning) is prioritized.
- When authoring guided troubleshooting runbooks, pull sanitized incidents via Plan F (`Tools\Sanitize-PostmortemLogs.ps1`, `docs/StateTrace_IncidentPostmortem_Intake.md`), then document the telemetry commands in the runbook template before publishing.

## Telemetry gates
<!-- LANDMARK: ST-E-001 automation gates link -->
- Incremental loading: `PortBatchReady` emits one event per processed device (37 for BOYO/WLLS) and `InterfaceSyncTiming`/`DatabaseWriteLatency` stay within Plan A/B thresholds (see `docs/telemetry/Automation_Gates.md`); log counts + samples in the plan entry.
- SPAN view: `Get-SpanViewSnapshot` (or future telemetry event) must report `RowsBound > 0` for the requested host/site and log timestamps to `Logs/Debug/SpanDiag.log`; once telemetry events exist, add them to `docs/telemetry/Phase1_metrics.md` and enforce via this plan.
- Guided workflows/templates: each published workflow must include a verification command (per runbook template) and reference the telemetry it expects (e.g., `GuidedWorkflowCompletionRate`, once defined) before it ships.

## References & history
- Operator instructions: `docs/StateTrace_Operators_Runbook.md`.
- Feature catalogue: `docs/StateTrace_Functions_Features.md`.
- UI automation matrix: `docs/CODEX_PLAN_AUTOMATION_MATRIX.md`, `docs/CODEX_RUNBOOK.md`, `docs/UI_Smoke_Checklist.md`.
- Pending design work & session notes: `docs/notes/2025-11-07_span-view-investigation.md`, `docs/notes/2025-10-03_feature-expansion.md`.
- Span tooling references: `Tools/Invoke-SpanViewSmokeTest.ps1`, `Tools/Test-SpanViewBinding.ps1`, `Modules/Tests/SpanViewModule.Tests.ps1`.
- Sanitized incident intake dependency: `docs/StateTrace_IncidentPostmortem_Intake.md`, `docs/agents/Agent_Kickoff_Tasks.md`, Plan F backlog.










