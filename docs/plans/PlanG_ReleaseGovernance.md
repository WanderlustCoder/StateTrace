# Plan G - Release & Governance

<!-- LANDMARK: ST-E-001 telemetry gates link -->
Telemetry gates: [docs/telemetry/Automation_Gates.md](../telemetry/Automation_Gates.md).

## Objective
Maintain a predictable release cadence, ensure warm-run verification passes before packaging, and document rollout decisions (approvals, risk assessments, governance) so every build is auditable.

## Current status (2025-11)
- Release guide (`docs/Release.md`) plus the Codex documentation controls (`docs/CODEX_DOC_SYNC_PLAYBOOK.md`, `docs/CODEX_PLAN_AUTOMATION_MATRIX.md`, `docs/CODEX_SESSION_CHECKLIST.md`) describe the governance loop, but the release checklist still lacks explicit shared-cache snapshot and verification evidence requirements.
- Governance artifacts live in `docs/RiskRegister.md`, `docs/StateTrace_Quarterly_Roadmap.md`, and `docs/StateTrace_TaskBoard.md`; Plan G must keep those aligned by mirroring TaskBoard IDs inside the roadmap and referencing the same IDs when publishing release notes.
- Warm-run verification is part of the standard harness (`Tools/Invoke-StateTracePipeline.ps1 -RunWarmRunRegression`, `Tools/Invoke-StateTraceVerification.ps1`, `Tools/Invoke-StateTraceScheduledVerification.ps1`), yet we do not consistently archive the resulting telemetry (cold vs warm JSON, verification summaries, shared-cache summaries) in a release evidence bundle.
- Shared cache analyzers (`Tools/Analyze-SharedCacheStoreState.ps1`, `Tools/Analyze-SiteCacheProviderReasons.ps1`) and rollups feed governance calls, but Plan G still needs a standing task that captures their output for every release candidate.
- Plan E???s telemetry bundles and Plan B???s analyzer outputs are prerequisites for sign-off; Plan G must enforce that every candidate build references `Logs/TelemetryBundles/<date>/` (created via `Tools\Publish-TelemetryBundle.ps1`) before approvals.

## Active work
| ID | Title | Owner | Status | Notes |
|----|-------|-------|--------|-------|
| ST-G-001 | Update release checklist with shared cache snapshot policy | Release | Done - 2025-12-22 | Added shared cache snapshot verification steps to `docs/Release.md` (summary JSON path + guard command referencing `SharedCacheSnapshot-latest-summary.json`). |
| ST-G-002 | Link roadmap milestones to task board IDs | PMO | Done - 2025-12-22 | Added Task Board IDs to `docs/StateTrace_Quarterly_Roadmap.md` and created milestone cards (ST-A-007/ST-B-010/ST-C-001) in the Task Board/CSV. |
| ST-G-009 | Schedule verification runs | Release / Ops | Done - 2025-12-22 | `Tools/Invoke-StateTraceScheduledVerification.ps1` now emits `Logs/Verification/VerificationSummary-<timestamp>.json` (plus `VerificationSummary-latest.json`) and records warm-run/shared-cache/queue evaluations alongside the transcript. |
| ST-G-010 | Schedule verification task | Release / Ops | Done - 2025-12-22 | Added `Tools/Schedule-VerificationTask.ps1` plus `docs/runbooks/Schedule_Verification.md`; registered `StateTraceVerification` at 03:00 with `-IncludeTests`. |
| ST-G-004 | Governance evidence bundle | Release | Backlog | Define `Logs/ReleaseEvidence/<version>/` containing cold vs warm telemetry, verification summaries, shared-cache summaries, doc-sync checklist outputs, and risk reviews per `docs/CODEX_DOC_SYNC_PLAYBOOK.md`. |
| ST-G-005 | Release readiness dashboard | PMO | Done - 2026-01-04 | Created `Tools/Show-ReleaseReadiness.ps1` to consolidate release readiness metrics: warm-run improvement/cache-hit ratio (thresholds: >=60%/>=99%), shared cache coverage (sites>=2, hosts>=37, rows>=1200), verification status, and telemetry bundle readiness. Displays color-coded thresholds, overall status (Ready/Partial/Not Ready), and actionable recommendations. Usage: `pwsh Tools\Show-ReleaseReadiness.ps1 [-TelemetryBundlePath <path>] [-OutputPath <json>] [-PassThru]`. |
| ST-G-006 | Doc-sync enforcement hook | Docs / Release | Done - 2025-12-22 | Added `Tools/Test-DocSyncChecklist.ps1` to validate plan/task board/backlog/session log updates and emit JSON summaries; `Tools/Invoke-AllChecks.ps1` now supports `-RequireDocSyncChecklist` with an auto-output path. Updated runbook/playbook/checklist to reference the new guard. |
| ST-G-007 | Telemetry bundle integration | Release + Telemetry | Done - 2026-01-01 | 2025-12-23: Release-2025-12-23 readiness recorded (Telemetry README SHA256 `E35558FDF7E72E3DBD966A17B362258C994357D82312B1A71AF425F794080E9B`, Routing README SHA256 `471C2D5AB91599EC1385F718029CD93D965684C5AF933B1E798889306C265982`, summary `Logs/TelemetryBundles/Release-2025-12-23/VerificationSummary.json`). 2026-01-01: Release-2025-12-23 readiness re-verified (Telemetry README SHA256 `E35558FDF7E72E3DBD966A17B362258C994357D82312B1A71AF425F794080E9B`, Routing README SHA256 `471C2D5AB91599EC1385F718029CD93D965684C5AF933B1E798889306C265982`, summary `Logs/TelemetryBundles/Release-2025-12-23/VerificationSummary-ST-G-007-20260101-080021.json`, log `Logs/Verification/TelemetryBundleReadiness-ST-G-007-20260101-080021.log`). AllChecks: `Logs/Verification/AllChecks-ST-G-007-20260101-080300.log`. DocSync: `Logs/Reports/DocSyncChecklist-ST-G-007-20260101-081200.json`. 2026-01-01: Sample bundle readiness verified (`Data/Samples/TelemetryBundles/Sample-ReleaseBundle`), summary `Logs/Reports/TelemetryBundleReadiness-ST-G-007-20260101-101621.json`, log `Logs/Verification/TelemetryBundleReadiness-ST-G-007-20260101-101621.log`, tests `Logs/Verification/TelemetryBundleReadinessTests-ST-G-007-20260101-094000.log`. AllChecks: `Logs/Verification/AllChecks-ST-G-007-20260101-101900.log`. DocSync: `Logs/Reports/DocSyncChecklist-ST-G-007-20260101-103200.json`.  <br> 2026-01-01: RC summary template telemetry bundle fields recorded; sample bundle readiness verified (`Data/Samples/TelemetryBundles/Sample-ReleaseBundle`), release summary `Logs/Reports/ReleaseCandidateSummary-ST-G-007-20260101-121122.md`, log `Logs/Verification/ReleaseCandidateSummary-ST-G-007-20260101-121122.log`, readiness summary `Logs/Reports/TelemetryBundleReadiness-ST-G-007-20260101-121133.json`, log `Logs/Verification/TelemetryBundleReadiness-ST-G-007-20260101-121133.log`. AllChecks: `Logs/Verification/AllChecks-ST-G-007-20260101-121200.log`. DocSync: `Logs/Reports/DocSyncChecklist-ST-G-007-20260101-122400.json`. <!-- LANDMARK: PlanG ST-G-007 evidence update --> |
| ST-I-010 | Bundle hygiene guardrails | Release / Telemetry | Done - 2025-12-26 | Removed stray `PlanH/Release-2025-12-26` bundle and added output-root guardrails (require `Logs/TelemetryBundles/` unless `-AllowCustomOutputRoot`); readiness re-check `Logs/TelemetryBundles/Release-2025-12-26/VerificationSummary-20251226-133656.json`. |
| ST-I-011 | TaskBoard integrity guard | Docs / Governance | Done - 2025-12-26 | Added TaskBoard integrity guard with structural + deletion checks; doc-sync now runs the guard and records JSON outputs. Evidence: Logs/Verification/AllChecks-ST-I-011-20251226-142359.log; Logs/Reports/TaskBoardIntegrity-ST-I-011-20251226-142338.json; Logs/Reports/DocSyncChecklist-ST-I-011-20251226-142808.json. |     
| ST-I-015 | Publish synthetic smoke evidence bundle + runbook canonicalization | Release / Telemetry | Done - 2025-12-27 | Published Release-2025-12-27 telemetry bundle with synthetic 5.1 smoke evidence; readiness summary at Logs/TelemetryBundles/Release-2025-12-27/VerificationSummary.json. Evidence: Logs/TelemetryBundles/Release-2025-12-27/Telemetry; Logs/Verification/PublishBundle-ST-I-015-20251227-091800.log; Logs/Reports/DocSyncChecklist-ST-I-015-20251227-091500.json. |
| ST-G-011 | Bundle README risk register references | PMO / Release | Done - 2025-12-27 | Added `-RiskRegisterEntries` passthrough so telemetry bundle READMEs list relevant risk register entries; runbook updated to mention the parameter for release candidates. |
| ST-G-008 | Risk register linkage | PMO | Done - 2026-01-01 | Added release candidate summary template + release guide checklist for Risk Register references and mitigations/owners. Evidence: Logs/Reports/ReleaseCandidateSummary-ST-G-008-20260101-073736.md; Logs/Verification/ReleaseCandidateSummary-ST-G-008-20260101-073736.log; Logs/Verification/AllChecks-ST-G-008-20260101-073742.log; Logs/Reports/DocSyncChecklist-ST-G-008-20260101-074023.json. |

## Near-term execution detail

### ST-G-007 ??? Telemetry bundle enforcement
- **Checklist updates:** Amend `docs/Release.md` to add a gated step titled "Telemetry Bundle Verification" that requires the current bundle folder (e.g., `Logs\TelemetryBundles\2025-11-13.1\`) plus README hash, warm/cold telemetry IDs, shared-cache analyzer filenames, diff-hotspot CSV, doc-sync checklist artifact, and routing evidence. Link this step back to TaskBoard rows ST-E-007/ST-E-009 so ownership is traceable.
- **Routing evidence:** Every routing bundle must now include `Logs\IngestionMetrics\QueueDelaySummary-<timestamp>.json` (plus dispatcher harness outputs) so the queue-delay gate proof is immutable; `Tools\Publish-TelemetryBundle.ps1 -AreaName Routing` auto-discovers the summary file. Follow `docs/runbooks/Telemetry_Bundle_Verification.md` for the exact payload list.
- **Automated guard:** Run `pwsh Tools\Test-TelemetryBundleReadiness.ps1 -BundlePath Logs\TelemetryBundles\<bundle> -Area Telemetry,Routing -IncludeReadmeHash -SummaryPath Logs\TelemetryBundles\<bundle>\VerificationSummary.json` (or `Tools\Invoke-AllChecks.ps1 -TelemetryBundlePath Logs\TelemetryBundles\<bundle> -RequireTelemetryBundleReady`) to scan the candidate bundle for required files, emit README hashes, and block releases when artifacts are missing. Integrate the script output with `Tools\Invoke-StateTraceVerification.ps1 -ReleaseReadiness` once CI hooks are wired up; track command usage inside this plan and `docs/CODEX_PLAN_AUTOMATION_MATRIX.md`.
- **Bundle manifest:** Require each bundle README to list command lines, timestamps, TaskBoard IDs (ST-A-006, ST-E-003/7/8/9, ST-G-007), and hashes for every analyzer/CSV/log. Store the README hash (and link to `VerificationSummary.json`) in `docs/Release.md` and surface it on the release checklist so approvers can compare it against the filesystem copy.
- **Doc-sync proof:** Require every release bundle README to embed the doc-sync checklist output (per `docs/CODEX_DOC_SYNC_PLAYBOOK.md`) and store the generated JSON under `Logs\TelemetryBundles\<bundle>\DocSync\`. Releases without this artifact must halt until the checklist is rerun.
- **Cross-plan linkage:** Mirror the bundle path inside Plan A (ST-A-006) and Plan E (ST-E-003/7/9) timelines whenever routing or telemetry evidence is produced so auditors see a single breadcrumb trail. Update `docs/StateTrace_TaskBoard.md` and `docs/CODEX_BACKLOG.md` entries to cite the same bundle ID the release checklist expects, and reference the bundle again in `docs/PlanIndex.md` so future agents know which evidence set closes the loop.
- **Evidence trail:** Append a "Telemetry bundle produced?" column to `docs/StateTrace_TaskBoard.md` release rows; entries should include the bundle path + README hash. Also capture bundle metadata (hashes, manifest path, verification timestamp) in `docs/Release.md` change history and `docs/CODEX_PLAN_AUTOMATION_MATRIX.md` (Plan G row) to satisfy governance reviews.
- **Audit helper:** `Tools\Show-TelemetryBundleSummary.ps1 -BundlePath Logs\TelemetryBundles\<bundle>` prints the README hashes + requirement table that were stored in `VerificationSummary.json`; attach this output (or link to the JSON) to release records for quick review.

## Recent timeline (migrated highlights)
| Date (MT) | Summary | Evidence / Metrics | Source |
|-----------|---------|--------------------|--------|
<!-- LANDMARK: PlanG ST-B-008 telemetry bundle readiness evidence -->
| 2026-01-01 | Published a Plan B telemetry bundle for release evidence continuity (ST-B-008). | `Logs/TelemetryBundles/Release-20260101-ST-B-008-20260101-145226`; `Logs/Verification/PublishTelemetryBundle-ST-B-008-20260101-145226.log`; `Logs/TelemetryBundles/Release-20260101-ST-B-008-20260101-145226/VerificationSummary-ST-B-008-20260101-145236.json`; `Logs/Verification/TelemetryBundleReadiness-ST-B-008-20260101-145236.log`; `Logs/Verification/AllChecks-ST-B-008-20260101-152014.log`; `Logs/Reports/DocSyncChecklist-ST-B-008-20260101-152350.json`. | Tools/Publish-TelemetryBundle.ps1 |
| 2025-12-23 13:35 | Published Release-2025-12-23 Telemetry + Routing bundles and recorded readiness hashes for ST-G-007. | Telemetry README SHA256 `E35558FDF7E72E3DBD966A17B362258C994357D82312B1A71AF425F794080E9B`; Routing README SHA256 `471C2D5AB91599EC1385F718029CD93D965684C5AF933B1E798889306C265982`; `Logs/TelemetryBundles/Release-2025-12-23/VerificationSummary.json`. | Tools/Publish-TelemetryBundle.ps1, Tools/Test-TelemetryBundleReadiness.ps1 |
| 2025-12-23 | Scheduled verification now forwards telemetry bundle readiness inputs (TelemetryBundlePath/Areas + VerifyTelemetryBundleReadiness) into the verification harness; runbook updated to pass bundle checks via -AdditionalArguments. | `Tools/Invoke-StateTraceScheduledVerification.ps1`, `docs/runbooks/Schedule_Verification.md`. | `Tools/Invoke-StateTraceScheduledVerification.ps1` |
| 2025-12-22 11:30 | Scheduled verification now emits `VerificationSummary-<timestamp>.json` (plus latest) with warm-run/shared-cache/queue evaluations and transcript path. | `Logs/Verification/VerificationSummary-*.json`, `Tools/Invoke-StateTraceScheduledVerification.ps1`. | `Tools/Invoke-StateTraceScheduledVerification.ps1` |
| 2025-12-22 10:57 | Added the scheduled verification task helper + runbook so nightly runs can be registered (optionally including tests) and summaries are captured consistently. | `Tools/Schedule-VerificationTask.ps1`, `docs/runbooks/Schedule_Verification.md`. | `docs/CODEX_RUNBOOK.md` |
| 2025-12-22 11:37 | Registered `StateTraceVerification` scheduled task to run daily at 03:00 with `-IncludeTests`; next run 2025-12-23 03:00. | Task Scheduler entry + `Tools/Schedule-VerificationTask.ps1` output. | `docs/runbooks/Schedule_Verification.md` |
| 2025-12-22 10:45 | Linked Q4 roadmap milestones to Task Board IDs and added milestone cards (ST-A-007/ST-B-010/ST-C-001). | Roadmap table updated plus Task Board/CSV entries. | `docs/StateTrace_Quarterly_Roadmap.md`, `docs/StateTrace_TaskBoard.md` |
| 2025-12-22 10:13 | Added shared cache snapshot verification steps to the release checklist (summary JSON + guard command). | `docs/Release.md` update referencing `SharedCacheSnapshot-latest-summary.json` and `Tools\Test-SharedCacheSnapshot.ps1`. | `docs/Release.md` |
| 2025-12-22 09:46 | Added doc-sync checklist tool + AllChecks hook for release gating; emits JSON summaries for bundles. | `Tools/Test-DocSyncChecklist.ps1`, `Tools/Invoke-AllChecks.ps1`, `Modules/Tests/DocSyncChecklist.Tests.ps1`. | `docs/CODEX_DOC_SYNC_PLAYBOOK.md`, `docs/CODEX_RUNBOOK.md`, `docs/CODEX_SESSION_CHECKLIST.md`. |
| 2025-11-13 12:33 | Published `Logs/TelemetryBundles/Release-20251113/` (Telemetry + Routing areas) and captured the readiness output from `Tools\Test-TelemetryBundleReadiness.ps1 -BundlePath Logs/TelemetryBundles/Release-20251113 -Area Telemetry,Routing -IncludeReadmeHash -SummaryPath Logs/TelemetryBundles/Release-20251113/VerificationSummary.json` (Telemetry README SHA256 `402834EC33AC2A75B15EBBDFE6E5AAACF449CD82942AAB6CF97A79CE1CAAF09B`, Routing SHA256 `CD6B04DE8F34A0DCAC64FCF79C6380C91167FE7BEE8796DF14234B29703610F6`) to unblock ST-G-007. | Telemetry bundle manifests/README hashes, readiness table, `VerificationSummary.json`, doc-sync logs `docs/agents/sessions/2025-11-13_session-0008.md` and `_0009.md`. | Tools/Publish-TelemetryBundle.ps1, Tools\Test-TelemetryBundleReadiness.ps1, Tools\Invoke-AllChecks.ps1 |
| 2025-11-12 13:45 | Authored the Codex Documentation Sync Playbook so every handoff follows the same plan/task board/backlog update procedure. | `docs/CODEX_DOC_SYNC_PLAYBOOK.md` plus README/Instruction Stack/Operations Guide references; logged as task ST-G-004. | docs/CODEX_DOC_SYNC_PLAYBOOK.md |
| 2025-11-12 13:10 | Published the Codex Plan Automation Matrix to map each plan to its scripts, telemetry, and documentation hooks so governance checks can be executed autonomously. | `docs/CODEX_PLAN_AUTOMATION_MATRIX.md` plus README/operations guide cross-links; task board card ST-G-003 documents the update. | docs/CODEX_PLAN_AUTOMATION_MATRIX.md, docs/README.md |
| 2025-10-23 15:56 | Introduced `Tools/Invoke-WarmRunRegression.ps1` plus the `-RunWarmRunRegression` switch in `Tools/Invoke-StateTracePipeline.ps1`, making cold+warm deltas part of the standard release harness. | Console summary reported cold avg 361.7 ms vs warm 137.6 ms (61.95% improvement); helper exports `WarmRunTelemetry-*.json`. | docs/StateTrace_Consolidated_Plans.md (2025-10-23 entries) |
| 2025-10-23 17:49 | Created `Tools/Invoke-StateTraceVerification.ps1` to wrap pipeline + warm regression with assertions, producing timestamped telemetry for governance reviews. | Script splats parameters, archives telemetry, and becomes the entry point for scheduled verification jobs. | docs/StateTrace_Consolidated_Plans.md (2025-10-23 17:49 entry) |
| 2025-11-06 09:15 | Verification harness now imports `Test-WarmRunRegressionSummary`, enforcing cache-hit and improvement thresholds (>=25% improvement, >=99% cache hits) for CI and scheduled releases. | `Tools/Invoke-StateTraceVerification.ps1` + `Tools/Invoke-StateTraceScheduledVerification.ps1` updated; coverage in `Modules/Tests/VerificationModule.Tests.ps1`. | docs/StateTrace_Consolidated_Plans.md (2025-11-06 entry) |
| 2025-11-06 09:52 | `Tools/Invoke-StateTracePipeline.ps1` automatically restores/exports shared cache snapshots so release runs ship with repeatable cache state (`SharedCacheSnapshot-latest*.clixml`). | Cold pass after change shows WLLS hosts hydrating from cache (`SiteCacheFetchDurationMs = 0`). | docs/StateTrace_Consolidated_Plans.md (2025-11-06 entry) |
| 2025-11-13 | Telemetry bundle + doc-sync dependency documented: release candidates must cite `Logs/TelemetryBundles/<version>/` and attach doc-sync checklist outputs before approvals. | Plan E ST-E-007/ST-E-008 entries, TaskBoard links, `docs/CODEX_DOC_SYNC_PLAYBOOK.md`. | docs/plans/PlanE_Telemetry.md, docs/StateTrace_TaskBoard.md |

## Automation hooks
- `Tools\Invoke-StateTracePipeline.ps1 -RunWarmRunRegression -ShowSharedCacheSummary [-SharedCacheSnapshotPath Logs\SharedCacheSnapshot\SharedCacheSnapshot-latest.clixml]` before tagging any build; archive the cold and warm telemetry JSON files under `Logs/ReleaseEvidence/<version>/`.
- `Tools\Invoke-StateTraceVerification.ps1 -SharedCacheMinimumSiteCount 2 -SharedCacheRequiredSites BOYO,WLLS -EmitWarmRunTelemetry` to enforce gates and produce `VerificationSummary-*.json` for the evidence bundle.
- `Tools\Invoke-StateTraceScheduledVerification.ps1 -Daily -WarmRun -OutputDirectory Logs\Verification` so governance has fresh telemetry even outside manual release windows.
- `Tools\Invoke-SharedCacheWarmup.ps1 -ShowSharedCacheSummary -RequiredSites BOYO,WLLS` prior to packaging; attach the summary output.
- `Tools\Analyze-SharedCacheStoreState.ps1 -Path Logs\IngestionMetrics\<file>.json -IncludeSiteBreakdown` and `Tools\Analyze-SiteCacheProviderReasons.ps1 -IncludeHostBreakdown` after each candidate to document shared-cache health alongside the release record.
- `Tools\Invoke-DailyMetricRollup.ps1` / `Tools\Rollup-IngestionMetrics.ps1` + `Tools\Publish-TelemetryBundle.ps1`: gather the latest rollup CSV, analyzer output, warm-run summaries, and doc-sync checklist reports into `Logs/TelemetryBundles/<date>/` and reference the folder inside the release checklist.
- Apply `docs/CODEX_DOC_SYNC_PLAYBOOK.md` before approvals (plan entry, task board, backlog + session log updates) and record the checklist output in the telemetry bundle README.

## Telemetry gates
- Warm vs cold regression improvement >= 60 percent with `WarmProviderCounts.Cache` covering every processed host; copy the improvement line into the release notes.
- Shared cache snapshot summary (`SharedCacheSnapshot-*-summary.json`) shows minimum site count 2, host count 37, row count >= 1200 before release artifacts are signed.
- `Logs/Verification/VerificationSummary-*.json` (or CLI output) shows `Tools\Invoke-StateTraceVerification.ps1` passed with zero skipped assertions; failures block release until resolved.
- Release checklist (`docs/Release.md`) completed and linked to the TaskBoard along with the doc-sync checklist output (per `docs/CODEX_DOC_SYNC_PLAYBOOK.md`).
- Risk register entry updated if the release introduces new mitigations or residual risk; link the row number in the release announcement.
- Telemetry bundle check: `Logs/TelemetryBundles/<version>/` exists and includes rollup CSV, shared-cache analyzer output, warm-run telemetry summary, diff hotspot CSV, and doc-sync checklist artifact before sign-off.
- Doc-sync evidence recorded: bundle README lists plan/backlog/task-board/session-log links per `docs/CODEX_DOC_SYNC_PLAYBOOK.md`.

## References & history
- Release guide and checklist: `docs/Release.md`.
- Governance + roadmap: `docs/StateTrace_Quarterly_Roadmap.md`, `docs/RiskRegister.md`, `docs/StateTrace_TaskBoard.md`, `docs/taskboard/TaskBoard.csv`.
- Automation + doc sync guides: `docs/CODEX_PLAN_AUTOMATION_MATRIX.md`, `docs/CODEX_DOC_SYNC_PLAYBOOK.md`, `docs/CODEX_SESSION_CHECKLIST.md`, `docs/CODEX_RUNBOOK.md`.
- Historical decisions: `docs/StateTrace_Consolidated_Plans.md` (Plan G sections).




