{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.invalid/statetrace/telemetrybundle_manifest.schema.json",
  "title": "StateTrace Telemetry Bundle Manifest",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "BundleName",
    "AreaName",
    "CreatedAt",
    "Hostname",
    "BundlePath",
    "Artifacts"
  ],
  "properties": {
    "BundleName": {
      "type": "string"
    },
    "AreaName": {
      "type": "string"
    },
    "CreatedAt": {
      "type": "string",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(?:\\.[0-9]+)?(?:Z|[+-][0-9]{2}:[0-9]{2})$"
    },
    "Hostname": {
      "type": "string"
    },
    "OutputRoot": {
      "type": "string"
    },
    "BundlePath": {
      "type": "string"
    },
    "PlanReferences": {
      "type": ["array", "null"],
      "items": {
        "type": "string"
      }
    },
    "TaskBoardIds": {
      "type": ["array", "null"],
      "items": {
        "type": "string"
      }
    },
    "Notes": {
      "type": ["string", "null"]
    },
    "Artifacts": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "Category",
          "TargetFile",
          "SourcePath",
          "Hash",
          "SizeBytes"
        ],
        "properties": {
          "Category": {
            "type": "string"
          },
          "TargetFile": {
            "type": "string"
          },
          "SourcePath": {
            "type": "string"
          },
          "Hash": {
            "type": "string",
            "pattern": "^[A-Fa-f0-9]{64}$"
          },
          "SizeBytes": {
            "type": "integer",
            "minimum": 0
          }
        }
      }
    }
  }
}
